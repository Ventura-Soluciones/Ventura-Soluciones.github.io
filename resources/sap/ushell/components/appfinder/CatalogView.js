// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/BusyIndicator","sap/m/library","sap/m/List","sap/m/IllustratedMessage","sap/m/Page","sap/m/PageAccessibleLandmarkInfo","sap/m/SplitApp","sap/m/StandardListItem","sap/ui/core/Element","sap/ui/core/EventBus","sap/ui/core/mvc/View","sap/ui/core/library","sap/ui/Device","sap/ui/performance/Measurement","sap/ushell/components/appfinder/VisualizationOrganizerHelper","sap/ushell/ui/appfinder/AppBoxInternal","sap/ushell/ui/appfinder/PinButton","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/launchpad/CatalogEntryContainer","sap/ushell/ui/launchpad/CatalogsContainer","sap/ushell/ui/launchpad/Tile","sap/ushell/resources"],function(e,t,a,o,i,s,n,l,r,p,u,g,c,d,h,f,m,C,v,y,b,P){"use strict";var T=t.ListSeparators;var S=t.ListMode;var B=g.AccessibleLandmarkRole;return u.extend("sap.ushell.components.appfinder.CatalogView",{oController:null,oVisualizationOrganizerHelper:h.getInstance(),formatPinButtonTooltip:function(e,t){var a;if(t.path){var o=e?Array.prototype.indexOf.call(e,t.id):-1;a=o!==-1?"removeAssociatedTileFromContextGroup":"addAssociatedTileToContextGroup";return P.i18n.getText(a,[t.title])}a=e&&e.length?"EasyAccessMenu_PinButton_Toggled_Tooltip":"EasyAccessMenu_PinButton_UnToggled_Tooltip";return P.i18n.getText(a)},formatPinButtonSelectState:function(e,t,a,o){if(a){var i=e?Array.prototype.indexOf.call(e,o):-1;return i!==-1}return!!t},createContent:function(t){var u=this;this.oViewData=this.getViewData();this.parentComponent=this.oViewData.parentComponent;var g=this.parentComponent.getModel();this.setModel(g);this.setModel(this.oViewData.subHeaderModel,"subHeaderModel");this.oVisualizationOrganizerHelper.setModel(g);this.oController=t;function h(e){return e!==null&&(e==="1x2"||e==="2x2")||false}var I=new m({icon:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonIcon},type:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonType},selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","/groupContext","id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonTooltip.bind(this)},press:[this.oVisualizationOrganizerHelper.onTilePinButtonClick,this],visible:false});var A=new m({icon:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonIcon},type:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonType},selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","/groupContext","id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonTooltip.bind(this)},press:[this.oVisualizationOrganizerHelper.onTilePinButtonClick,this],visible:false});this.oAppBoxesTemplate=new f({title:"{title}",icon:"{icon}",subtitle:"{subtitle}",url:"{url}",navigationMode:"{navigationMode}",pinButton:A,contentProviderLabel:"{contentProviderLabel}",press:[t.onAppBoxPressed,t]});this.oVisualizationOrganizerHelper.shouldPinButtonBeVisible().then(function(e){A.setVisible(e);I.setVisible(e)});A.addCustomData(new C({key:"tabindex",value:"-1",writeToDom:true}));A.addStyleClass("sapUshellPinButton");I.addCustomData(new C({key:"tabindex",value:"-1",writeToDom:true}));I.addStyleClass("sapUshellPinButton");this.oTileTemplate=new b({tileViews:{path:"content",factory:function(e,t){return t.getObject()}},long:{path:"size",formatter:h},tileCatalogId:"{id}",tileCatalogIdStable:"{tileCatalogIdStable}",pinButton:I,press:[t.catalogTilePress,t],afterRendering:t.onTileAfterRendering});this.oCatalogSelect=new a("catalogSelect",{visible:"{/enableCatalogSelection}",rememberSelections:true,showSeparators:T.None,mode:S.SingleSelectMaster,items:{path:"/masterCatalogs",template:new l({type:"Active",title:"{title}"})},showNoData:false,itemPress:[t._handleCatalogListItemPress,t],selectionChange:[t._handleCatalogListItemPress,t]});this.getCatalogSelect=function(){return this.oCatalogSelect};var w=this.oCatalogSelect.onAfterRendering;if(c.system.desktop){sap.ui.require(["sap/ushell/components/ComponentKeysHandler","sap/ushell/renderer/AccessKeysHandler"],function(e,t){e.getInstance().then(function(e){this.oCatalogSelect.addEventDelegate({onsaptabnext:function(a){try{a.preventDefault();t.setIsFocusHandledByAnotherHandler(true);e.setFocusOnCatalogTile()}catch(e){}},onsapskipforward:function(a){try{a.preventDefault();t.setIsFocusHandledByAnotherHandler(true);e.setFocusOnCatalogTile()}catch(e){}},onsapskipback:function(a){try{a.preventDefault();t.setIsFocusHandledByAnotherHandler(true);var o=r.getElementById("openCloseButtonAppFinderSubheader");if(o.getVisible()){o.focus()}else{e.appFinderFocusMenuButtons(a)}}catch(e){}}})}.bind(this))}.bind(this))}if(g.getProperty("/enableHelp")){this.oCatalogSelect.addStyleClass("help-id-catalogCategorySelect")}this.setCategoryFilterSelection=function(e,t){var a=u.getCatalogSelect();var o=a.getItems();var i=e;var s=0;if(!i||i===""){i=P.i18n.getText("all")}o.forEach(function(e,t){if(e.getTitle()===i){s=t;a.setSelectedItem(e)}});if(o.length!==0&&t){o[s].focus()}};this.oCatalogSelect.onAfterRendering=function(){var e=u.oController.categoryFilter||P.i18n.getText("all");u.setCategoryFilterSelection(e);if(w){w.apply(this,arguments)}if(!this.getSelectedItem()){this.setSelectedItem(this.getItems()[0])}setTimeout(function(){var e=r.getElementById("appFinderSegmentedButtons");if(e){e.focus()}},0)};var M=this.oCatalogSelect._onAfterRenderingPopover;this.oCatalogSelect._onAfterRenderingPopover=function(){if(this._oPopover){this._oPopover.setFollowOf(false)}if(M){M.apply(this,arguments)}};var D=p.getInstance();var x;var H=function(){this.splitApp.toMaster("catalogSelect","show");if(!c.system.phone){x=this._calculateDetailPageId();if(x!==this.splitApp.getCurrentDetailPage().getId()){this.splitApp.toDetail(x)}}}.bind(this);D.subscribe("launchpad","catalogContentLoaded",function(){setTimeout(H,500)},this);D.subscribe("launchpad","afterCatalogSegment",H,this);var z=new v({header:"{title}",customTilesContainer:{path:"customTiles",template:this.oTileTemplate,templateShareable:true},appBoxesContainer:{path:"appBoxes",template:this.oAppBoxesTemplate,templateShareable:true}});this.oIllustratedMessage=new o({visible:true,title:P.i18n.getText("EasyAccessMenu_NoAppsToDisplayMessagePage_Text"),description:" "}).addEventDelegate({onAfterRendering:function(){var e=this.oIllustratedMessage.getDomRef();if(e){var t=e.getElementsByClassName("sapMTitle");if(t.length){t[0].setAttribute("tabindex","0")}}}.bind(this),onBeforeRendering:function(){var e=this.oIllustratedMessage.getDomRef();if(e){var t=e.getElementsByClassName("sapMTitle");if(t.length){t[0].removeAttribute("tabindex")}}}.bind(this)});this.oCatalogsContainer=new y("catalogTiles",{categoryFilter:"{/categoryFilter}",catalogs:{path:"/catalogs",templateShareable:true,template:z},busy:true}).addStyleClass("sapUiTinyMarginTop");this.oCatalogsContainer.addStyleClass("sapUshellCatalogTileContainer");this.oCatalogsContainer.addEventDelegate({onsaptabprevious:function(e){var t=r.getElementById("openCloseButtonAppFinderSubheader");var a=e.srcControl.getDomRef();if(t.getVisible()&&!t.getPressed()&&!a.classList.contains("sapUshellPinButton")){e.preventDefault();var o=r.getElementById("appFinderSearch");o.focus()}},onsapskipback:function(e){var t=r.getElementById("openCloseButtonAppFinderSubheader");if(t.getVisible()&&!t.getPressed()){e.preventDefault();t.focus()}}});this.oCatalogsContainer.onAfterRendering=function(){var e=r.getElementById("catalogTilesDetailedPage");if(!this.getBusy()){e.setBusy(false);d.end("FLP:AppFinderLoadingStartToEnd")}else{e.setBusy(true)}document.getElementById("catalogTilesDetailedPage-cont").addEventListener("scroll",function(){var e=r.getElementById("catalogTilesDetailedPage");var t=e.getScrollDelegate();var a=t.getScrollTop();var o=t.getMaxScrollTop();if(o-a<=30+3*u.oController.PagingManager.getTileHeight()&&u.oController.bIsInProcess===false){u.oController.bIsInProcess=true;u.oController.allocateNextPage();setTimeout(function(){u.oController.bIsInProcess=false},0)}})};var V=new i("catalogTilesDetailedPage",{showHeader:false,showFooter:false,showNavButton:false,content:[this.oCatalogsContainer.addStyleClass("sapUshellCatalogPage")],landmarkInfo:new s({contentLabel:P.i18n.getText("appFinderCatalogTitle"),contentRole:B.None,rootRole:B.None})});var F=new i("catalogMessagePage",{showHeader:false,showFooter:false,showNavButton:false,content:[this.oIllustratedMessage]});var E=new e("catalogSelectBusyIndicator",{size:"1rem"});this.splitApp=new n("catalogViewMasterDetail",{masterPages:[E,this.oCatalogSelect],detailPages:[V,F],mode:"{= ${/isPhoneWidth} ? 'HideMode' : 'ShowHideMode'}"});return this.splitApp},_calculateDetailPageId:function(){var e=this.getModel("subHeaderModel");var t=e.getProperty("/search/searchMode");var a=e.getProperty("/tag/tagMode");var o=!!this.getModel().getProperty("/catalogsNoDataText");var i;if(t||a){i=this.getController().bSearchResults?"catalogTilesDetailedPage":"catalogMessagePage"}else if(o){i="catalogMessagePage"}else{i="catalogTilesDetailedPage"}return i},getControllerName:function(){return"sap.ushell.components.appfinder.Catalog"}})});
//# sourceMappingURL=CatalogView.js.map