// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/i18n/Localization","sap/base/util/isEmptyObject","sap/m/Button","sap/m/library","sap/ui/core/IconPool","sap/ui/core/UIComponent","sap/ui/Device","sap/ui/thirdparty/jquery","sap/ushell/resources","sap/ushell/Container"],function(e,s,t,a,n,o,r,i,jQuery,l,g){"use strict";var u;var m=n.ButtonType;return r.extend("sap.ushell.components.shell.UserImage.Component",{metadata:{version:"1.136.1",library:"sap.ushell.components.shell.UserImage",dependencies:{libs:{"sap.m":{},"sap.ui.layout":{lazy:true}}}},createContent:function(){var e;u=g.getRendererInternal("fiori2")._oShellView;e=(u.getViewData()?u.getViewData().config:{})||{};this.loadUserImage();var s=g.getUser();if(e.enableUserImgConsent===true&&s.getImageConsent()===undefined){this._showUserConsentPopup()}},_showUserConsentPopup:function(){var e=this;var t=s.getRTL()?"Right":"Left";var n,o,r,g;var u=new a("yesButton",{text:l.i18n.getText("DisplayImg"),type:m.Emphasized,press:function(){e.updateUserImage(true);n.close()}});var p=new a("noButton",{text:l.i18n.getText("DontDisplayImg"),press:function(){e.updateUserImage(false);n.close()}});sap.ui.require(["sap/ui/layout/form/VerticalLayout","sap/m/Dialog","sap/m/Text","sap/m/Link","sap/m/FlexBox"],function(e,s,a,m,d){n=new s("userConsentDialog",{title:l.i18n.getText("userImageConsentDialogTitle"),modal:true,stretch:i.system.phone,buttons:[u,p],afterClose:function(){n.destroy()}}).addStyleClass("sapUshellUserConsentDialog").addStyleClass("sapContrastPlus");var c=new a({text:l.i18n.getText("userImageConsentDialogTermsOfUse")}).addStyleClass("sapUshellUserConsentDialogTerms");var C=new a({text:l.i18n.getText("userImageConsentText"),textAlign:t}).addStyleClass("sapUshellUserConsentDialogText");var f=new m({text:l.i18n.getText("userImageConsentDialogShowTermsOfUse"),textAlign:t,press:function(){var e=g.getVisible();if(e){g.setVisible(false);f.setText(l.i18n.getText("userImageConsentDialogShowTermsOfUse"))}else{f.setText(l.i18n.getText("userImageConsentDialogHideTermsOfUse"));g.setVisible(true)}}}).addAriaLabelledBy(C);o=new d({alignItems:"Center",direction:"Row",items:[C]}).addStyleClass("sapUshellUserConsentDialogBox");r=new d({alignItems:"Center",direction:"Row",items:[f]}).addStyleClass("sapUshellUserConsentDialogBox").addStyleClass("sapUshellUserConsentDialogLink");g=new d({alignItems:"Center",direction:"Row",items:[c]}).addStyleClass("ushellUserImgConsentTermsOfUseFlexBox");g.setVisible(false);var I=new e("userConsentDialogLayout",{content:[o,r,g]});n.addContent(I);n.open()})},loadUserImage:function(){var e=g.getUser(),s=e.getImage();if(s){this._setUserImage(s)}e.attachOnSetImage(this._setUserImage.bind(this))},_setUserImage:function(s){var a=typeof s==="string"?s:s.mParameters;if(a&&typeof a==="string"||!t(a)){jQuery.ajax({url:a,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},success:function(){u.getModel().setProperty("/userImage/personPlaceHolder",a);u.getModel().setProperty("/userImage/account",a)},error:function(){e.error("Could not load user image from: "+a,"","sap.ushell.renderer.Shell.view");g.getUser().setImage("")}})}else{u.getModel().setProperty("/userImage/personPlaceHolder",null);u.getModel().setProperty("/userImage/account",o.getIconURI("account"))}},updateUserImage:function(e){var s=g.getUser(),t;g.getServiceAsync("UserInfo").then(function(a){if(e!==undefined){s.setImageConsent(e);t=a.updateUserPreferences(s);t.done(function(){s.resetChangedProperty("isImageConsent")})}})}})});
//# sourceMappingURL=Component.js.map