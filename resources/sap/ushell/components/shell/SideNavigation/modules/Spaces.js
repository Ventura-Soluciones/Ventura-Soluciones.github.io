// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/ObjectPath","sap/tnt/NavigationListGroup","sap/tnt/NavigationListItem","sap/ui/core/CustomData","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/thirdparty/hasher","sap/ushell/Config","sap/ushell/Container","sap/ushell/components/shell/SideNavigation/modules/NavigationHelper","sap/ushell/utils/UrlParsing"],function(e,t,i,a,s,n,o,r,c,l,p,d,u){"use strict";class m{#e;#t;#i;#a;#s;#n;#o;constructor(e){this.#e=e;this.#a=this.#e.getConfigValue("spaces.defaultIcon");this.#s=new d;const i=l.last("/core/menu/personalization/enabled");const c=l.last("/core/spaces/myHome/myHomeSpaceId");const p=[new s("type",n.NE,"separator")];if(i){p.push(new s("pinned",n.EQ,true))}if(c){p.push(new s("id",n.NE,c))}this.#n=new r({});this.#n.attachPropertyChange(()=>{this.#e.updateSelectedKey()});this.#i=new t({text:"{i18n>SideNavigation.Item.Spaces.Title}",enabled:"{viewConfiguration>/enableSideNavigation}",customData:[new a({key:"help-id",value:"MenuEntry-My-Spaces",writeToDom:true})],items:{path:"spaces>/",factory:this._spacesModelItemFactory.bind(this),filters:new s({filters:p,and:true}),sorter:i?new o({path:"pinnedSortOrder"}):null}});this.#i.setModel(this.#n,"navigationListItemModel");this.#t=new Promise(e=>{this.#o=this.#r(e)})}async getRootItem(){return this.#t}async#r(e){const t=await p.getServiceAsync("Menu");const i=await t.getMenuModel();this.#i.setModel(i,"spaces");e(this.#i);return i}async findSelectedKey(t){const i=c.getHash();const a=u.parseShellHash(i);const s=e.get("params.spaceId.0",a);const n=e.get("params.pageId.0",a);const o=e.get("params.sap-ui-app-id-hint.0",a);t=t||await this.getRootItem();if(a.semanticObject==="Shell"&&a.action==="home"){return t.getItems()[0]?.getKey()}const r=this.#c(t.getItems(),s,n,o);return r?.getKey()}#c(e,t,i,a){for(let s=0;s<e.length;s++){const n=e[s];const o=n.getItems();const r=this.#c(o,t,i,a);if(r&&!n.getExpanded()){return n}else if(r){return r}const c=this.#l(n.getBindingContext("spaces").getObject(),t,i,a);if(c){return n}}}#l(t,i,a,s){const n=e.get("target.parameters",t)||[];const o=n.some(function(e){return e.name==="spaceId"&&e.value===i});const r=n.some(function(e){return e.name==="pageId"&&e.value===a});const c=n.some(function(e){return e.name==="sap-ui-app-id-hint"&&e.value===s});const l=!a&&!s;return o&&(r||c||l)}_spacesModelItemFactory(e,t){const s=t.getProperty("menuEntries");const n=t.getProperty("uid");this.#n.setProperty(`/${n}`,false);return new i(e,{key:"{spaces>uid}",text:"{spaces>title}",enabled:"{viewConfiguration>/enableSideNavigation}",selectable:this.#e.getConfigValue("spaces.selectable")||!s||s.length===0,expanded:`{navigationListItemModel>/${n}}`,customData:[new a({key:"help-id",value:"{= 'MenuEntry-' + ${spaces>help-id}}",writeToDom:"{= !!${spaces>help-id}}"})],icon:{path:"spaces>icon",formatter:e=>e||this.#a},select:this._onSideNavigationItemSelection.bind(this),items:{path:"spaces>menuEntries",template:new i({key:"{spaces>uid}",text:"{spaces>title}",enabled:"{viewConfiguration>/enableSideNavigation}",expanded:false,customData:[new a({key:"help-id",value:"{= 'MenuEntry-' + ${spaces>help-id}}",writeToDom:"{= !!${spaces>help-id}}"})],select:this._onSideNavigationItemSelection.bind(this),icon:"{spaces>icon}"})}})}_onSideNavigationItemSelection(e){this.#e.updateSelectedKey();const t=e.getParameter("item").getBindingContext("spaces").getProperty();this.#e.closeSideNavigation();this.#s.navigate(t)}}return m},false);
//# sourceMappingURL=Spaces.js.map