// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/ObjectPath","sap/ui/core/EventBus","sap/ui/core/mvc/Controller","sap/ui/Device","sap/ushell/Container","sap/ushell/EventHub","sap/ushell/Config","sap/base/Log"],function(e,t,i,n,o,a,s,r){"use strict";const c="NONE";return i.extend("sap.ushell.components.shell.SideNavigation.controller.SideNavigation",{_aDoables:[],onInit:function(){this._handleSideNavigationContentDensity();const e=s.on("/core/sideNavigation/navigationListProvider").do(e=>{this.pNavigationListProvider=this._initNavigationListProvider("/core/sideNavigation/navigationListProvider");this._selectIndexAfterRouteChange()});const i=s.on("/core/sideNavigation/fixedNavigationListProvider").do(e=>{this._initNavigationListProvider("/core/sideNavigation/fixedNavigationListProvider","fixedItem")});this._aDoables.push(e);this._aDoables.push(i);this.oContainerRouter=o.getRendererInternal().getRouter();this.oContainerRouter.getRoute("home").attachMatched(this._selectIndexAfterRouteChange,this);this.oContainerRouter.getRoute("openFLPPage").attachMatched(this._selectIndexAfterRouteChange,this);this.oContainerRouter.getRoute("openWorkPage").attachMatched(this._selectIndexAfterRouteChange,this);this.oEnableMenuBarNavigationListener=a.on("enableMenuBarNavigation").do(e=>this.onEnableSideNavigation(e));t.getInstance().subscribe("sap.ushell","appOpened",this._selectIndexAfterRouteChange,this)},_handleSideNavigationContentDensity:async function(){const e=this.byId("sideNavigation");let t;if(!n.system.desktop&&!n.system.combi){t=false}if(t===undefined){const e=await o.getServiceAsync("UserInfo");const i=e.getUser?.()?.getContentDensity();if(i==="compact"){t=true}else if(i==="cozy"){t=false}else{t=!n.support.touch}}if(t){e.addStyleClass("sapUiSizeCompact")}else{e.addStyleClass("sapUiSizeCozy")}},_initNavigationListProvider:function(t,i){return new Promise(n=>{const o=this.byId("sideNavigation");const a=this.byId("navContainer");const r=s.last(`${t}/modulePath`);const c=this.getOwnerComponent();if(r){const d={getConfigValue:i=>{let n;try{n=JSON.parse(s.last(`${t}/configuration`))}catch(e){n={}}return e.get(i,n)},getNavContainerFacade:()=>({add:e=>a.addPage(e),to:e=>a.to(e),toRoot:()=>a.to(o)}),updateSelectedKey:()=>this._selectIndexAfterRouteChange(),openSideNavigation:()=>c.popoverOpen(),closeSideNavigation:()=>c.popoverClose(),expandSideNavigation:()=>c.toggleSideNavigationExpansion(true),collapseSideNavigation:()=>c.toggleSideNavigationExpansion(false)};sap.ui.require([r],async e=>{const t=new e(d);const a=await t.getRootItem();if(i==="fixedItem"){o.setFixedItem(a)}else{o.setItem(a)}n(t)})}})},onEnableSideNavigation:function(e){this.getView().getModel("viewConfiguration").setProperty("/enableSideNavigation",e)},_selectIndexAfterRouteChange:async function(){const e=this.getOwnerComponent().getModel("viewConfiguration");const t=await this.pNavigationListProvider;const i=await t.findSelectedKey();setTimeout(()=>{if(i){e.setProperty("/selectedKey",i)}else{e.setProperty("/selectedKey",c);this.byId("sideNavigation").setSelectedItem(null)}},0)},onExit:function(){this.oEnableMenuBarNavigationListener.off();t.getInstance().unsubscribe("sap.ushell","appOpened",this._selectIndexAfterRouteChange,this);this._aDoables.forEach(function(e){e.off()});this._aDoables=[];const e=o.getRendererInternal().getRouter();if(!e){return}function i(t){const i=e.getRoute(t);if(i){i.detachMatched(this._selectIndexAfterRouteChange,this)}}try{i.call(this,"home");i.call(this,"openFLPPage");i.call(this,"openWorkPage")}catch(e){r.error("Error detaching route matched event listeners",e)}}})});
//# sourceMappingURL=SideNavigation.controller.js.map