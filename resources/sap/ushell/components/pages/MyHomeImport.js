//Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/i18n/Localization","sap/ushell/EventHub","sap/ushell/Config","sap/ushell/utils/HttpClient","sap/base/util/ObjectPath","sap/ushell/Container"],function(e,t,r,a,s,i){"use strict";var n={};var o="/UI2/Fiori2LaunchpadHome";n.getData=function(){if(!this.oPageSetPromise){this.oPageSetPromise=new Promise(function(t,r){var n="PageSets('%2FUI2%2FFiori2LaunchpadHome')"+"?$expand=Pages/PageChipInstances/ChipInstanceBags/ChipInstanceProperties,"+"Pages/PageChipInstances/Chip"+"&$format=json";var o={"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0","Accept-Language":e.getLanguage()||"",Accept:"application/json, text/plain"};var c=i.getUser().getLanguage();if(c){o["sap-language"]=c}var u=i.getLogonSystem();var l=u&&u.getClient();if(l){o["sap-client"]=l}var d=window["sap-ushell-config"].services&&window["sap-ushell-config"].services.PageBuilding||{};var p=(s.get("config.services.pageBuilding.baseUrl",d.adapter)||"").replace(/\/?$/,"/");var g=new a(p,{headers:o});g.get(n).then(function(e){t(this.parseData.bind(this)(e))}.bind(this)).catch(r)}.bind(this))}return this.oPageSetPromise};n.isImportEnabled=function(){return i.getServiceAsync("UserInfo").then(function(e){var t=e.getUser();var r=t.getImportBookmarksFlag();switch(r){case"done":case"dismissed":case"not_required":return false;case null:return this.getData().then(function(r){var a=!!r.length;var s=a?"pending":"not_required";t.setImportBookmarksFlag(s);e.updateUserPreferences();t.resetChangedProperty("importBookmarks");return a});default:return true}}.bind(this))};n.parseData=function(e){try{var t=JSON.parse(e.responseText);if(t&&t.d){t=t.d}var a=t.configuration&&JSON.parse(t.configuration)||{};var s=a.hiddenGroups||[];var i=t.Pages.results.filter(function(e){var t=e.scope==="PERSONALIZATION";var r=e.PageChipInstances.results.length>0;var a=s.indexOf(e.id)===-1;return t&&r&&a});var n=a.order||[];i.sort(function(e,t){if(n.indexOf(e.id)>n.indexOf(t.id)){return 1}if(n.indexOf(e.id)<n.indexOf(t.id)){return-1}return 0});var c=[];var u;var l=[];i.forEach(function(e){var t;if(e.layout){t=JSON.parse(e.layout)}var r={id:e.id,title:e.title,isLocked:e.isPersLocked==="X",isDefault:e.id===o,tileOrder:t&&t.order||[],linkOrder:t&&t.linkOrder||[],chips:e.PageChipInstances.results};if(r.isLocked){c.push(r)}else if(r.isDefault){u=r}else{l.push(r)}});if(!r.last("/core/home/disableSortedLockedGroups")){c.sort(function(e,t){return e.title.toLowerCase()<t.title.toLowerCase()?-1:1})}if(u){c=c.concat(u)}return c.concat(l)}catch(e){return null}};n.setImportEnabled=function(e){t.emit("importBookmarksFlag",!!e);i.getServiceAsync("UserInfo").then(function(t){var r=t.getUser();var a=e?null:"dismissed";r.setImportBookmarksFlag(a);t.updateUserPreferences();r.resetChangedProperty("importBookmarks")})};return n});
//# sourceMappingURL=MyHomeImport.js.map