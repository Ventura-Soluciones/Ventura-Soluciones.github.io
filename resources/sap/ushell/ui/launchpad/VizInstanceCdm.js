// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/Deferred","sap/ushell/ui/launchpad/VizInstance","sap/m/library","sap/ui/core/Component","sap/base/util/ObjectPath","sap/base/util/deepExtend","sap/ui/core/ComponentContainer","sap/ushell/UI5ComponentType","sap/ushell/ui/launchpad/VizInstanceRenderer","sap/ushell/Container"],function(t,e,o,i,n,r,a,s,p,u){"use strict";var h=o.LoadState;var l=e.extend("sap.ushell.ui.launchpad.VizInstanceCdm",{metadata:{library:"sap.ushell"},renderer:p});l.prototype.init=function(){e.prototype.init.apply(this,arguments);this._oLoadDeferred=new t};l.prototype.load=function(t){var e;if(t===true){e=this._loadCustomVizType()}else{e=this._loadStandardVizType()}e.then(function(t){this._oComponent=t;var e=new a({component:t});t.setParent(this);this.setContent(e);if(this.getSizeBehavior()){this.setTileSizeBehavior(this.getSizeBehavior())}this._setComponentTileVisible(this.getActive());this.setTileEditable(this.getEditable());this._oLoadDeferred.resolve(t)}.bind(this)).catch(function(t){this.setState(h.Failed);this._oLoadDeferred.reject(t)}.bind(this));return this._oLoadDeferred.promise};l.prototype.loaded=function(){return this._oLoadDeferred.promise};l.prototype._loadStandardVizType=function(){var t=this._getComponentConfiguration();return i.create(t)};l.prototype._loadCustomVizType=function(){var t=this._getCustomComponentConfiguration();var e={};var o=[];return u.getServiceAsync("Ui5ComponentLoader").then(function(i){return i.createComponent(t,e,o,s.Visualization)}).then(function(t){if(t&&t.componentHandle&&t.componentHandle.getInstance){return t.componentHandle.getInstance()}throw new Error("Create component failed: no instance found in the component handle.")})};l.prototype._getComponentConfiguration=function(){var t=this.getInstantiationData().vizType;var e=this.getVizConfig();var o=n.get(["sap.platform.runtime","componentProperties"],t);o=r({},this._getComponentProperties(),o);var i={name:t["sap.ui5"].componentName,componentData:{properties:o},url:n.get(["sap.platform.runtime","componentProperties","url"],t),manifest:n.get(["sap.platform.runtime","componentProperties","manifest"],t),asyncHints:n.get(["sap.platform.runtime","componentProperties","asyncHints"],t)};var a=n.get(["sap.platform.runtime","includeManifest"],t);var s=n.get(["sap.platform.runtime","includeManifest"],e);if(a||s){i.manifest=r({},t,e)}if(typeof i.manifest==="object"){o.manifest=i.manifest}return i};l.prototype._getCustomComponentConfiguration=function(){var t=this._getComponentConfiguration();var e={loadCoreExt:true,loadDefaultDependencies:false,componentData:t.componentData,url:t.url,applicationConfiguration:{},reservedParameters:{},applicationDependencies:t,ui5ComponentName:t.name};return e};l.prototype._getComponentProperties=function(){return{title:this.getTitle(),subtitle:this.getSubtitle(),icon:this.getIcon(),info:this.getInfo(),indicatorDataSource:this.getIndicatorDataSource(),dataSource:this.getDataSource(),contentProviderId:this.getContentProviderId(),contentProviderLabel:this.getContentProviderLabel(),targetURL:this.getTargetURL(),displayFormat:this.getDisplayFormat(),numberUnit:this.getNumberUnit(),preview:this.getPreview()}};l.prototype._setComponentTileVisible=function(t){if(this._oComponent&&typeof this._oComponent.tileSetVisible==="function"){this._oComponent.tileSetVisible(t)}};l.prototype.setActive=function(t,e){this._setComponentTileVisible(t);if(e){this.refresh()}return this.setProperty("active",t,false)};l.prototype.setTileEditable=function(t){if(this._oComponent&&typeof this._oComponent.tileSetEditMode==="function"){this._oComponent.tileSetEditMode(t)}return this};l.prototype.setTileSizeBehavior=function(t){if(this._oComponent&&typeof this._oComponent.tileSetSizeBehavior==="function"){this._oComponent.tileSetSizeBehavior(t)}e.prototype.setTileSizeBehavior.apply(this,arguments);return this};l.prototype.setPreview=function(t){var o=!!this.getProperty("preview")&&!t;if(this._oComponent&&typeof this._oComponent.tileSetPreview==="function"){this._oComponent.tileSetPreview(t)}if(o){this.refresh()}e.prototype.setPreview.apply(this,arguments);return this};l.prototype.refresh=function(){if(this._oComponent&&typeof this._oComponent.tileRefresh==="function"){this._oComponent.tileRefresh()}};return l});
//# sourceMappingURL=VizInstanceCdm.js.map