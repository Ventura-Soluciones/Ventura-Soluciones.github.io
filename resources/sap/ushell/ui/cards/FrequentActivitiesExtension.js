// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/integration/Extension","sap/ushell/utils/UrlParsing","sap/ushell/utils/AppType","sap/ushell/library","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/Container"],function(e,t,i,n,r,s,a,o){"use strict";var c=n.AppType;function u(e,t){if(t===c.SEARCH){return'"'+e+'"'}return e}function p(e){if(e===c.SEARCH){return a.i18n.getText("recentActivitiesSearchDescription")}return i.getDisplayName(e)}return e.extend("sap.ushell.ui.cards.FrequentActivitiesExtension",{init:function(){e.prototype.init.apply(this,arguments);this.oUserRecentsPromise=o.getServiceAsync("UserRecents");this.oCrossAppNavPromise=o.getServiceAsync("CrossApplicationNavigation")},exit:function(){e.prototype.exit.apply(this,arguments);s.on("newUserRecentsItem").off();s.on("userRecentsCleared").off()},onCardReady:function(){s.on("newUserRecentsItem").do(function(){this.getCard().refreshData()}.bind(this));s.on("userRecentsCleared").do(function(){this.getCard().refreshData()}.bind(this))},getData:function(){if(this._sortedData){return Promise.resolve(this._resolvedData)}return this.oUserRecentsPromise.then(function(e){return e.getFrequentActivity()}).then(this._getActivitiesAsCardItems.bind(this)).then(this._checkEnabled.bind(this))},_getActivitiesAsCardItems:function(e){var i=[];for(var n=0;n<e.length;n++){if(e[n].url&&e[n].url!==""){var r=t.parseShellHash(e[n].url);var s={Name:u(e[n].title,e[n].appType),Description:p(e[n].appType),Icon:e[n].icon||"sap-icon://product",Url:e[n].url};if(r){s.Intent={SemanticObject:r.semanticObject,Action:r.action,Parameters:r.params,AppSpecificRoute:r.appSpecificRoute}}else{s.Url=e[n].url}i.push(s)}}return i},_checkEnabled:function(e){var t=e.map(function(e){return this._isActionEnabled(e).then(function(t){e.Enabled=t;return e})}.bind(this));return Promise.all(t)},_isActionEnabled:function(e){var i=t.parseShellHash(e.Url);if(!i){return Promise.resolve(true)}var n=i.params;var r={target:{semanticObject:i.semanticObject,action:i.action},params:n};return this.oCrossAppNavPromise.then(function(e){return new Promise(function(t){e.isNavigationSupported([r]).done(function(e){t(e[0].supported)}).fail(function(){t(false)})})})}})});
//# sourceMappingURL=FrequentActivitiesExtension.js.map