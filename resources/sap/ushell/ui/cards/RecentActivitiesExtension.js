// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/integration/Extension","sap/ushell/utils/UrlParsing","sap/ushell/utils/AppType","sap/ushell/library","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/Container"],function(e,t,n,i,s,r,a,o){"use strict";var c=i.AppType;function u(e,t){if(t===c.SEARCH){return'"'+e+'"'}return e}function p(e){if(e===c.SEARCH){return a.i18n.getText("recentActivitiesSearchDescription")}return n.getDisplayName(e)}return e.extend("sap.ushell.ui.cards.RecentActivitiesExtension",{init:function(){e.prototype.init.apply(this,arguments);this.oUserRecentsPromise=o.getServiceAsync("UserRecents");this.oCrossAppNavPromise=o.getServiceAsync("CrossApplicationNavigation")},exit:function(){e.prototype.exit.apply(this,arguments);r.on("newUserRecentsItem").off();r.on("userRecentsCleared").off()},onCardReady:function(){r.on("newUserRecentsItem").do(function(){this.getCard().refreshData()}.bind(this));r.on("userRecentsCleared").do(function(){this.getCard().refreshData()}.bind(this))},getData:function(){return this.oUserRecentsPromise.then(function(e){return e.getRecentActivity()}).then(this._getActivitiesAsCardItems.bind(this)).then(this._checkEnabled.bind(this))},_getActivitiesAsCardItems:function(e){var n=[];for(var i=0;i<e.length;i++){if(e[i].url&&e[i].url!==""){var s=t.parseShellHash(e[i].url);var r={Name:u(e[i].title,e[i].appType),Description:p(e[i].appType),Icon:e[i].icon||"sap-icon://product",Url:e[i].url};if(s){r.Intent={SemanticObject:s.semanticObject,Action:s.action,Parameters:s.params,AppSpecificRoute:s.appSpecificRoute}}else{r.Url=e[i].url}n.push(r)}}return n},_checkEnabled:function(e){var t=e.map(function(e){return this._isActionEnabled(e).then(function(t){e.Enabled=t;return e})}.bind(this));return Promise.all(t)},_isActionEnabled:function(e){var n=t.parseShellHash(e.Url);if(!n){return Promise.resolve(true)}var i=n.params;var s={target:{semanticObject:n.semanticObject,action:n.action},params:i};return this.oCrossAppNavPromise.then(function(e){return new Promise(function(t){e.isNavigationSupported([s]).done(function(e){t(e[0].supported)}).fail(function(){t(false)})})})}})});
//# sourceMappingURL=RecentActivitiesExtension.js.map