//Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ushell/library","sap/ushell/Config","sap/ushell/Container","sap/ushell/resources","sap/ushell/utils","sap/ushell/utils/WindowUtils","sap/ushell/utils/AppType","sap/ushell/EventHub"],function(e,t,i,s,n,c,o,l,a,r,u,p){"use strict";const g=n.AppType;const h={oModel:new s({recentActivities:[],frequentActivities:[]}),oQuickAccessDialog:null,_createQuickAccessDialog:async function(i){const s=await t.load({name:"sap.ushell.ui.QuickAccess",type:"XML",controller:this});s.setModel(this.oModel);s.attachAfterClose(this._onAfterClose.bind(this,i));e.getElementById("mainShell").addDependent(s);this.oQuickAccessDialog=s;return s},_onAfterClose:function(t){this.oQuickAccessDialog.destroy();if(i.system.desktop){const i=e.getElementById(t);if(i){i.focus()}else{sap.ui.require(["sap/ushell/components/ComponentKeysHandler"],e=>{e.getInstance().then(e=>{e.goToLastVisitedTile()})})}}},_updateQuickAccessDialog:async function(e){const t=e.getContent()[0];t.setBusy(true);const i=await o.getServiceAsync("UserRecents");const s=await new Promise(function(e){i.getRecentActivity().then(function(t){e(t.map(function(e){e.timestamp=a.formatDate(e.timestamp);return e}))},function(){e([])})});const n=await new Promise(function(e){i.getFrequentActivity().then(function(t){e(t)},function(){e([])})});this.oModel.setData({recentActivities:s,frequentActivities:n});this._setDialogContentHeight(e,Math.max(s.length,n.length));t.setBusy(false)},_setDialogContentHeight:function(e,t){let i=(t+.5)*4+2.75;if(i<18){i=18}else if(i>42){i=42}e.setContentHeight(i+"rem")},_closeDialog:function(){this.oQuickAccessDialog.close()},_titleFormatter:function(e,t){if(t===g.SEARCH){e='"'+e+'"'}return e},_descriptionFormatter:function(e){if(e===g.SEARCH){return l.i18n.getText("recentActivitiesSearchDescription")}return u.getDisplayName(e)},_itemPress:function(e){const t=e.getParameter("listItem").getBindingContextPath();const i=this.oModel.getProperty(t);p.emit("UITracer.trace",{reason:"LaunchApp",source:"Link",data:{targetUrl:i.url}});if(i.url[0]==="#"){window.hasher.setHash(i.url);this._closeDialog()}else{const e=c.last("/core/shell/enableRecentActivity")&&c.last("/core/shell/enableRecentActivityLogging");if(e){const e={title:i.title,appType:g.URL,url:i.url,appId:i.url};o.getRendererInternal("fiori2").logRecentActivity(e)}r.openURL(i.url,"_blank")}}};return{openQuickAccessDialog:async function(e,t){const i=await h._createQuickAccessDialog(t);const s=i.getContent()[0];h._updateQuickAccessDialog(i);s.setSelectedKey(e);i.setInitialFocus(e);i.open()},_getQuickAccess:function(){return h}}});
//# sourceMappingURL=QuickAccess.js.map