{"version":3,"file":"MessageBrokerEngine.js","names":["sap","ui","define","Log","deepExtend","bEnabled","oAcceptedOrigins","oClientsPerChannel","oConnectedClients","oSubscribedClients","window","location","origin","MessageBrokerEngine","this","setEnabled","bVal","processPostMessage","oPostMessageData","Promise","reject","oMessageData","oMessageDataBody","body","oMessage","sOrigin","oIframe","source","requestId","request_id","sErrorMsg","error","_handlePostMessageRequest","connect","sClientId","sError","length","resolve","disconnect","sChannelKey","aChannelClients","oClientKey","oClient","clientId","splice","channels","_emitEvent","subscribe","aSubscribedChannels","fnMessageCallback","fnClientConnectionCallback","sMessageName","aOtherSubscribedClients","bIsNewClient","oChannel","oFullClientData","subscribedChannels","messageCallback","clientConnectionCallback","iframe","isUI5","channelId","oExistingClient","find","push","oExistingChannel","oSubChannel","oSubscriptionData","Object","values","filter","keys","setTimeout","forEach","oParams","messageName","require","PostMessageManager","oResult","_buildPostMessageObject","_sendPostMessage","unsubscribe","aUnsubscribedChannels","Array","isArray","sChannelIndex","sMessage","warning","publish","sChannelId","sMessageId","aTargetClientIds","data","aTargetClients","oPubClient","oSubClient","sClientKey","sTargetClientId","concat","oTargetClient","_deepCopy","_sendMessage","addAcceptedOrigin","startsWith","endsWith","substring","removeAcceptedOrigin","getAcceptedOrigins","getSubscribedClients","aChannels","oNotifiedClients","_callApi","sEndpoint","aParams","apply","sRequestId","targetClientIds","oApiParams","oPostMessageParams","then","messageBody","status","_noresponse_","catch","_buildPostMessageObjectFallback","PostMessageUtils","sObjectType","sServiceName","oMessageBody","correlationMessageId","oResponse","createPostMessageResponse","oRequest","createPostMessageRequest","isRequest","isSuccess","serviceRequest","oContentWindow","sTargetOrigin","sendRequest","sendResponse","_buildFunctionName","sPrefix","sType","charAt","toUpperCase","oEntity"],"sources":["MessageBrokerEngine-dbg.js"],"mappings":"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","ignoreList":[]}