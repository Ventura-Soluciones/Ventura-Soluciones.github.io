// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/Log","sap/ushell/utils/UrlParsing"],function(e,t,r,a){"use strict";var n={};n.extractGetLinksParameterOptions=function(e){return n.parseGetLinksParameters(e).filter(function(e){return Object.keys(e.options).length>0}).map(function(e){return{name:e.name,options:e.options}})};n.extractGetLinksParameterDefinition=function(e){return n.parseGetLinksParameters(e).reduce(function(e,t){e[t.name]=t.value;return e},{})};n.parseGetLinksParameters=function(e){if(Object.prototype.toString.apply(e)!=="[object Object]"){return[]}var t=JSON.parse(JSON.stringify(e));return Object.keys(t).map(function(e){var r=t[e];var a={};if(Object.prototype.toString.apply(r)==="[object Object]"){r=r.value;delete t[e].value;a=t[e]}return{name:e,value:r,options:a}})};n.safeParseToObject=function(e){try{return JSON.parse(e)}catch(t){r.error("Cannot parse the given string to object",e)}return null};n.createAppStateFromData=function(e){r.error("Deprecated API call of '_CrossApplicationNavigation.utils.createAppStateFromData'. Please use 'createAppStateFromDataAsync' instead",null,"sap.ushell.services._CrossApplicationNavigation.utils");var t=sap.ushell.Container.getService("AppState");var a=t.createEmptyAppState(null);a.setData(e);a.save();return a.getKey()};n.createAppStateFromDataAsync=function(e){return sap.ushell.Container.getServiceAsync("AppState").then(function(t){var r=t.createEmptyAppState(null);r.setData(e);r.save();return r.getKey()})};n.extractParameter=function(i,s){var c;var p=null;if(typeof i==="string"){if(i.indexOf(s+"=")===-1){return{intent:i,data:null}}var o=a.parseShellHash(i);if(!o){return{intent:i,data:null}}p=o.params[s];delete o.params[s];c=a.constructShellHash(o);return{intent:c,data:p}}if(e(i)){var u=t.get("target.shellHash",i);if(typeof u==="string"){var l=n.extractParameter(u,s);i.target.shellHash=l.intent;return{intent:i,data:l.data}}var f=i.params;if(f&&f[s]){const e=f[s];p=typeof e==="string"?[e]:e;delete f[s]}return{intent:i,data:p}}r.error("Invalid input parameter","expected string or object");return{intent:i}};n.addXAppStateFromParameter=function(e,t){var r=n.extractParameter(e,t);var a=r.intent;var i=r.data&&r.data[0];if(!i){return}var s=n.safeParseToObject(i);if(!s){return}var c=n.createAppStateFromData(s);n.injectParameter(a,"sap-xapp-state",c)};n.addXAppStateFromParameterAsync=function(e,t){var r=n.extractParameter(e,t);var a=r.intent;var i=r.data&&r.data[0];if(!i){return Promise.resolve()}var s=n.safeParseToObject(i);if(!s){return Promise.resolve()}return n.createAppStateFromDataAsync(s).then(function(e){n.injectParameter(a,"sap-xapp-state",e)})};n.injectParameter=function(e,r,i){if(typeof e==="string"){var s=a.parseShellHash(e);s.params[r]=i;return a.constructShellHash(s)}if(Object.prototype.toString.apply(e)==="[object Object]"){var c=t.get("target.shellHash",e);if(typeof c==="string"){e.target.shellHash=n.injectParameter(c,r,i);return e}if(!e.params){e.params={}}e.params[r]=i}return e};n._injectParameters=function(e){var t=e.inject;var r=e.injectEmptyString||{};var a=e.type;var i=e.args;function s(e,t){return e||e===""&&t}if(a.isPlainObject(i)){if(i.target&&i.target.shellHash){if(typeof i.target.shellHash==="string"){i.target.shellHash=n._injectParameters({inject:t,injectEmptyString:r,type:e.type,args:i.target.shellHash})}return i}var c=Object.keys(t).reduce(function(e,a){var n=t[a];var i=r[a]===true;if(s(n,i)&&typeof e==="string"){var c=new RegExp("[&]"+a);var p=!c.test(e);if(p){var o=e?"&":"";e+=o+a+"="+n}}else if(s(n,i)&&!e.hasOwnProperty(a)){e[a]=n}return e},i.params||{});if(c&&Object.keys(c).length>0){i.params=c}return i}var p=i;if(p){Object.keys(t).forEach(function(e){var a=t[e];var n=r[e]===true;var i=new RegExp("[?&]"+e);var c=!i.test(p);if(s(a,n)&&c){var o=p.indexOf("?")>-1?"&":"?";p+=o+e+"="+a}})}return p};n.injectStickyParameters=function(e){r.error("Deprecated API call of '_CrossApplicationNavigation.utils.injectStickyParameters'. Please use 'injectStickyParametersAsync' instead",null,"sap.ushell.services._CrossApplicationNavigation.utils");var t=sap.ushell.Container.getService("AppLifeCycle");return n._injectStickyParameters(e,t)};n.injectStickyParametersAsync=function(e){return sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(t){return n._injectStickyParameters(e,t)})};n._injectStickyParameters=function(e,t){if(!t||Object.keys(t).length<=0){return e.args}var r=t.getCurrentApplication();if(!r||Object.keys(r).length<=0){return e.args}var a=e.appLifeCycle;var i=e.technicalParameters;var s=i.getParameters({sticky:true}).reduce(function(e,t){var n=t.name;var s=r.componentInstance;var c=r.applicationType;var p;if(c==="UI5"){p={}}else{p=a.getCurrentApplication().container}var o=i.getParameterValueSync(n,s,p,c);var u=t.stickyName||n;e[u]=o;return e},{});var c={type:e.type,inject:s,args:e.args};return n._injectParameters(c)};return n});
//# sourceMappingURL=utils.js.map