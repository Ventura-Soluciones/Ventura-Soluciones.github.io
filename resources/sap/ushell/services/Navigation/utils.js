// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/Log","sap/ushell/Container","sap/ushell/utils/UrlParsing"],function(e,t,r,a,n){"use strict";var i={};i.extractGetLinksParameterOptions=function(e){return i._parseGetLinksParameters(e).filter(function(e){return Object.keys(e.options).length>0}).map(function(e){return{name:e.name,options:e.options}})};i.extractGetLinksParameterDefinition=function(e){return i._parseGetLinksParameters(e).reduce(function(e,t){e[t.name]=t.value;return e},{})};i._parseGetLinksParameters=function(e){if(Object.prototype.toString.apply(e)!=="[object Object]"){return[]}var t=JSON.parse(JSON.stringify(e));return Object.keys(t).map(function(e){var r=t[e];var a={};if(Object.prototype.toString.apply(r)==="[object Object]"){r=r.value;delete t[e].value;a=t[e]}return{name:e,value:r,options:a}})};i._safeParseToObject=function(e){try{return JSON.parse(e)}catch(t){r.error("Cannot parse the given string to object",e)}return null};i._createAppStateFromData=function(e){return a.getServiceAsync("AppState").then(function(t){var r=t.createEmptyAppState(null);r.setData(e);r.save();return r.getKey()})};i._extractParameter=function(a,s){var c;var p=null;if(typeof a==="string"){if(a.indexOf(s+"=")===-1){return{intent:a,data:null}}var u=n.parseShellHash(a);if(!u){return{intent:a,data:null}}p=u.params[s];delete u.params[s];c=n.constructShellHash(u);return{intent:c,data:p}}if(e(a)){var o=t.get("target.shellHash",a);if(typeof o==="string"){var l=i._extractParameter(o,s);a.target.shellHash=l.intent;return{intent:a,data:l.data}}var f=a.params;if(f&&f[s]){const e=f[s];p=typeof e==="string"?[e]:e;delete f[s]}return{intent:a,data:p}}r.error("Invalid input parameter","expected string or object");return{intent:a}};i.addXAppStateFromParameter=function(e,t){var r=i._extractParameter(e,t);var a=r.intent;var n=r.data&&r.data[0];if(!n){return Promise.resolve()}var s=i._safeParseToObject(n);if(!s){return Promise.resolve()}return i._createAppStateFromData(s).then(function(e){i._injectParameter(a,"sap-xapp-state",e)})};i._injectParameter=function(e,r,a){if(typeof e==="string"){var s=n.parseShellHash(e);s.params[r]=a;return n.constructShellHash(s)}if(Object.prototype.toString.apply(e)==="[object Object]"){var c=t.get("target.shellHash",e);if(typeof c==="string"){e.target.shellHash=i._injectParameter(c,r,a);return e}if(!e.params){e.params={}}e.params[r]=a}return e};i.injectParameters=function(e){var t=e.inject;var r=e.injectEmptyString||{};var a=e.type;var n=e.args;function s(e,t){return e||e===""&&t}if(a.isPlainObject(n)){if(n.target&&n.target.shellHash){if(typeof n.target.shellHash==="string"){n.target.shellHash=i.injectParameters({inject:t,injectEmptyString:r,type:e.type,args:n.target.shellHash})}return n}var c=Object.keys(t).reduce(function(e,a){var n=t[a];var i=r[a]===true;if(s(n,i)&&typeof e==="string"){var c=new RegExp("[&]"+a);var p=!c.test(e);if(p){var u=e?"&":"";e+=u+a+"="+n}}else if(s(n,i)&&!e.hasOwnProperty(a)){e[a]=n}return e},n.params||{});if(c&&Object.keys(c).length>0){n.params=c}return n}var p=n;if(p){Object.keys(t).forEach(function(e){var a=t[e];var n=r[e]===true;var i=new RegExp("[?&]"+e);var c=!i.test(p);if(s(a,n)&&c){var u=p.indexOf("?")>-1?"&":"?";p+=u+e+"="+a}})}return p};i.injectStickyParameters=function(e){return a.getServiceAsync("AppLifeCycle").then(function(t){return i._injectStickyParameters(e,t)})};i._injectStickyParameters=function(e,t){if(!t||Object.keys(t).length<=0){return e.args}var r=t.getCurrentApplication();if(!r||Object.keys(r).length<=0){return e.args}var a=e.appLifeCycle;var n=e.technicalParameters;var s=n.getParameters({sticky:true}).reduce(function(e,t){var i=t.name;var s=r.componentInstance;var c=r.applicationType;var p;if(c==="UI5"){p={}}else{p=a.getCurrentApplication().container}var u=n.getParameterValueSync(i,s,p,c);var o=t.stickyName||i;e[o]=u;return e},{});var c={type:e.type,inject:s,args:e.args};return i.injectParameters(c)};return i});
//# sourceMappingURL=utils.js.map