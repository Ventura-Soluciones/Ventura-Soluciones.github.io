// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Component","sap/ui/core/Element","sap/ui/thirdparty/jquery","sap/ushell/api/RTA","sap/ushell/appRuntime/ui5/plugins/baseRta/AppLifeCycleUtils","sap/ushell/appRuntime/ui5/plugins/baseRta/Renderer"],function(t,e,jQuery,i,n,s){"use strict";let o;function a(){return{sComponentName:"sap.ushell.appRuntime.ui5.plugins.rtaShell",layer:"CUSTOMER",id:"RTA_AppRuntime_Plugin_ActionButton",text:"RTA_BUTTON_TEXT",icon:"sap-icon://wrench",visible:false}}function u(t){i.setShellHeaderVisibility(t,false)}function l(){return new Promise(function(t,e){u(false);o.postMessageToApp("user.postapi.rtaPlugin","startUIAdaptation").done(t).fail(e)})}return t.extend("sap.ushell.appRuntime.ui5.plugins.rtaShell.Component",{metadata:{manifest:"json",library:"sap.ushell"},init:function(){this.mConfig=a();o=this.getComponentData().oPostMessageInterface;this._registerPostMessages()},_registerPostMessages:function(){o.registerPostMessageAPIs({"user.postapi.rtaPlugin":{inCalls:{activatePlugin:{executeServiceCallFn:function(){return o.createPostMessageResult(this._initPlugin())}.bind(this)},showAdaptUI:{executeServiceCallFn:async function(){await this._changeActionButtonVisibility(true);return o.createPostMessageResult()}.bind(this)},switchToolbarVisibility:{executeServiceCallFn:function(t){const e=t.oMessageData.body.visible;u(e);return o.createPostMessageResult()}}},outCalls:{startUIAdaptation:{}}}})},_initPlugin:function(){if(this.bIsInitialized){return(new jQuery.Deferred).resolve()}this.bIsInitialized=true;this.mConfig.i18n=this.getModel("i18n").getResourceBundle();return new jQuery.Deferred(function(t){s.createActionButton(this,l.bind(undefined),this.mConfig.visible).then(function(t){this.oActionButton=t;return n.getAppLifeCycleService()}.bind(this)).then(function(t){t.attachAppLoaded(this._onAppLoaded,this)}.bind(this)).catch(function(t){this.bIsInitialized=false;return Promise.reject(t)}.bind(this)).then(t.resolve,t.reject)}.bind(this)).promise()},_changeActionButtonVisibility:async function(t){if(!this.oActionButton){return}const e=await n.getAppLifeCycleService();if(t&&e.getCurrentApplication().applicationType==="URL"){this.oActionButton.showForAllApps()}else{this.oActionButton.hideForAllApps()}},_onAppLoaded:function(){this._changeActionButtonVisibility(false)},exit:function(){u(false);n.getAppLifeCycleService().then(function(t){t.detachAppLoaded(this._onAppLoaded,this)}.bind(this))}})});
//# sourceMappingURL=Component.js.map