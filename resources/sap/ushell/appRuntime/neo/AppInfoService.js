// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/thirdparty/URI","sap/ui/model/resource/ResourceModel","sap/m/Dialog","sap/m/DialogType","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/ui/core/library"],function(jQuery,e,r,t,a,i,n,s,p){"use strict";const o=p.ValueState;var l=(new e).search(true);var u="/sap/fiori";var c="sap-ui-app-id";var f="/sap/bc";var v=/sv\/.+\/manifest/;var g;function d(e){return f+"/ui2/app_index/ui5_app_info_json?id="+e}function h(r){var t={};var a=r||document.URL;var i=new e(a);var n=i.query(true)["sap-startup-params"];var s=new e("?"+n).query(true);var p;Object.keys(s).forEach(function(e){t[e.toLowerCase()]=s[e]});if(t["sap-app-uri"]&&t["sap-app-name"]){var o=t["sap-app-uri"].replace(/\/$/,"");var l=t["sap-app-name"];g=u+"/"+l+"/";p=u+"/"+l+o}if(p){p=p.replace(".webapp","/webapp")}return p}function m(){if(!this.oErrorMessageDialog){var e=new r({bundleUrl:"/sap/fiori/appruntime/i18n/i18nApp.properties"});this.oErrorMessageDialog=new t({type:a.Message,title:e.getProperty("ERROR_DIALOG_TITLE"),state:o.Error,content:new s({text:e.getProperty("MISSING_PARAMETERS_ERROR")}),contentWidth:"30%",beginButton:new i({type:n.Emphasized,text:e.getProperty("OK_BUTTON"),press:function(){this.oErrorMessageDialog.close();sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(e){e.toExternal({target:{semanticObject:"Shell",action:"home"}})})}.bind(this)})})}return this.oErrorMessageDialog}function y(e,r,t){if(g){var a=sap.ushell.cloudServices.interceptor.FilterManager.getInstance();var i=e.getFilter("sap.ushell.cloudServices.interceptor.filter.DoorWayMappingFilter");if(!a.isRegistered("sap.ushell.cloudServices.interceptor.filter.DoorWayMappingFilter")){a.register("sap.ushell.cloudServices.interceptor.filter.DoorWayMappingFilter")}i.addAppToStack(t,g);r.addAppToStack(t,g)}}function E(e,r){var t=new jQuery.Deferred;e=e||l[c];jQuery.ajax(d(e)).then(function(a){if(a&&!(Object.keys(a).length===0)){a=e in a?a[e]:a;var i=a&&a.asyncHints&&a.asyncHints.libs||[];i.forEach(function(e){if(e&&e.url&&e.url.final){e.url.url=u+e.url.url}});var n=a&&a.asyncHints&&a.asyncHints.components||[];n.forEach(function(e){if(e&&e.url&&e.url.final){e.url.url=u+e.url.url}});if("url"in a){a.url=u+a.url;g=a.url}else{a.url=h(r)}if(!a.url){this.oErrorMessageDialog=m.call(this);this.oErrorMessageDialog.open();return t.reject(new Error("sap-app-uri & sap-app-name parameters were not provided"))}var s;var p=sap.ushell.cloudServices.interceptor.FilterFactory.getInstance();var o=p.getFilter("sap.ushell.cloudServices.interceptor.filter.CacheBusterFilter");if("manifestUrl"in a){if(v.test(a.manifestUrl)){var l=v.exec(a.manifestUrl);var c=l[0].split("/");s=c[1]}}if(s){o.setTimestamp(s)}else{o.setTimestamp()}y(p,o,e);return t.resolve(a)}return t.reject(new Error("AppInfo from AppIndex is empty"))}).fail(function(e){t.reject(e)});return t.promise()}sap.ui.define("appInfoService",[],function(){return{getAppInfo:E}})});
//# sourceMappingURL=AppInfoService.js.map