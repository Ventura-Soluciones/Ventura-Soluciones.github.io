// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/i18n/Localization","sap/base/util/deepExtend","sap/ui/base/EventProvider","sap/ui/core/Core","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/thirdparty/URI","sap/ushell/utils"],function(e,t,n,i,o,r,a,s,h){"use strict";function u(e){if(e===undefined){return undefined}return n({},e)}function m(e){var t;if(e.host&&typeof e.host==="function"&&e.host()){t=e.host();if(typeof e.protocol==="function"&&e.protocol()){t=e.protocol()+"://"+t}return t}return""}function g(e){return e.indexOf("sap_")===0}var c=function(u={}){var l=[];var p;var f;var d;var T;var y=new i;const P={};u.userProfile?.forEach?.(e=>{if(e.id&&e.editState){P[e.id]=e.editState}});let E=u.userProfile?.find?.(e=>e.id==="THEME_SET")?.value||"";this.getEditState=function(e){return P[e]};this.getEmail=function(){return u.email};this.getFirstName=function(){return u.firstName};this.getFullName=function(){return u.fullName};this.getTimeZone=function(){return u.timeZone};this.getLanguageAndRegionSettingsEntry=async()=>{if(u.getLanguageAndRegionSettingsEntry){const e=await u.getLanguageAndRegionSettingsEntry();return e}const[e]=await h.requireAsync(["sap/ushell/components/shell/Settings/userLanguageRegion/UserLanguageRegionEntry"]);return e};this.getInitials=function(){var e=u.fullName||"";var t="";var n=true;for(var i=0,o=e.length;i<o;++i){if(e[i]===" "){n=true}else if(n){n=false;t+=e[i]}}return t};this.getId=function(){return u.id};this.getLanguage=function(){return u.language};this.getLanguageBcp47=function(){return u.languageBcp47};this.getLanguageText=function(){var e=new r(t.getLanguageTag());var n=new a(e);var i=t.getLanguageTag().toString();return n.getLanguageName(i)||this.getLanguage()};this.getLastName=function(){return u.lastName};this.getImage=function(){return u.image};this.getCalendarWeekNumbering=function(){return u.calendarWeekNumbering||"Default"};this.setImage=function(e){u.image=e;y.fireEvent("onSetImage",e)};this.attachOnSetImage=function(e,t){y.attachEvent("onSetImage",e,t)};this.isJamActive=function(){return u.isJamActive===true};this.isLanguagePersonalized=function(){return u.isLanguagePersonalized===true};this.getTheme=function(e){if(e===c.prototype.constants.themeFormat.ORIGINAL_THEME){return T.originalTheme.theme}if(e===c.prototype.constants.themeFormat.THEME_NAME_PLUS_URL){return d.theme+(d.locationPath?"@"+d.locationOrigin+d.locationPath:"")}if(e===c.prototype.constants.themeFormat.NWBC){if(g(d.theme)){return d.theme}return this.getTheme(c.prototype.constants.themeFormat.THEME_NAME_PLUS_URL)}return d.theme};this.getThemeSet=function(){return E};this.getThemeRoot=function(e){if(u.ranges&&u.ranges.theme&&u.ranges.theme[e]&&u.ranges.theme[e].themeRoot){return u.ranges.theme[e].themeRoot}return""};this.setTheme=function(t){if(this.isSetThemePermitted()===false){var n="setTheme not permitted";e.error(n);throw new Error(n)}d=this._amendTheme({theme:t,root:this.getThemeRoot(t)},f);if(t!==T.originalTheme.theme){this.setChangedProperties({propertyName:"theme",name:"THEME"},T.originalTheme.theme,t);T=d}this.applyTheme(t)};this.setThemeSet=function(t){if(this.isSetThemePermitted()===false){const t="setThemeSet is not permitted";e.error(t);throw new Error(t)}if(t!==E){this.setChangedProperties({propertyName:"themeSet",name:"THEME_SET"},E,t);E=t}};this.applyTheme=function(e){var t=this._amendTheme({theme:e,root:this.getThemeRoot(e)},f);d=t;const n=o.applyTheme;if(!n){sap.ui.require("sap/ui/core/Theming").setTheme(t.theme)}else if(t.suppliedRoot){n(t.theme,t.suppliedRoot+"/UI5/")}else if(t.path){n(t.theme,t.path+"/UI5/")}else{n(t.theme)}sap.ui.require(["sap/ushell/appIntegration/PostMessageManager"],function(e){e.sendRequestToAllApplications("sap.ushell.appRuntime.themeChange",{currentThemeId:this.getTheme(c.prototype.constants.themeFormat.NWBC),themeServiceRoute:window.location.protocol+"//"+window.location.host+"/comsapuitheming.runtime/themeroot/v1"},false)}.bind(this))};this.setLanguage=function(e){if(e){this.setChangedProperties({propertyName:"language",name:"LANGUAGE"},u.language,e);u.language=e}};this.getAccessibilityMode=function(){return u.accessibility};this.setAccessibilityMode=function(t){if(this.isSetAccessibilityPermitted()===false){var n="setAccessibilityMode not permitted";e.error(n);throw new Error(n)}u.accessibility=t};this.isAdminUser=function(){return u.isAdminUser===true};this.isSetAccessibilityPermitted=function(){return u.setAccessibilityPermitted};this.isSetThemePermitted=function(){return u.setThemePermitted};this.getContentDensity=function(){return u.contentDensity};this.setContentDensity=function(t){if(this.isSetContentDensityPermitted()===false){var n="setContentDensity not permitted";e.error(n);throw new Error(n)}e.debug("[000] setContentDensity",t,"User");this.setChangedProperties({propertyName:"contentDensity",name:"CONTENT_DENSITY"},u.contentDensity,t);u.contentDensity=t};this.isSetContentDensityPermitted=function(){return u.setContentDensityPermitted};this.getChangedProperties=function(){e.debug("[000] user: getChangedProperties: aChangedProperties",JSON.stringify(l),"User");return n([],l)};this.setChangedProperties=function(t,n,i){e.debug("[000] setChangedProperties",[t.name,n,i],"User");l.push({propertyName:t.propertyName,name:t.name,oldValue:n,newValue:i})};this.resetChangedProperties=function(){e.debug("[000] resetChangedProperties","User");l=[]};this.resetChangedProperty=function(t){e.debug("[000] resetChangedProperty: sPropertyName:",t,"User");l=l.filter(function(e){return!(t===e.propertyName)})};this.getTrackUsageAnalytics=function(){return u.trackUsageAnalytics};this.setTrackUsageAnalytics=function(e){this.setChangedProperties({propertyName:"trackUsageAnalytics",name:"TRACKING_USAGE_ANALYTICS"},u.trackUsageAnalytics,e);u.trackUsageAnalytics=e};this.setImageConsent=function(e){this.setChangedProperties({propertyName:"isImageConsent",name:"ISIMAGECONSENT"},u.isImageConsent,e);u.isImageConsent=e};this.getImageConsent=function(){return u.isImageConsent};this.getImportBookmarksFlag=function(){return u.importBookmarks||null};this.setImportBookmarksFlag=function(e){this.setChangedProperties({propertyName:"importBookmarks",name:"MYHOME_IMPORT_FROM_CLASSIC"},this.getImportBookmarksFlag()||"",e);u.importBookmarks=e};this.getShowMyHome=function(){return u.showMyHome!==false};this.setShowMyHome=function(e){e=!!e;this.setChangedProperties({propertyName:"showMyHome",name:"MYHOME_ENABLEMENT"},u.showMyHome,e);u.showMyHome=e};this.getDetectDarkMode=function(){return u.detectDarkMode!==false};this.setDetectDarkMode=function(e){e=!!e;this.setChangedProperties({propertyName:"detectDarkMode",name:"THEME_DARKMODE_AUTO_DETECTION"},u.detectDarkMode,e);u.detectDarkMode=e};f={locationPathUi5:new s(sap.ui.require.toUrl("")).absoluteTo(document.location).pathname(),locationPathCustom:u.themeRoot||"",locationOrigin:m(new s(document.location))};if(!f.locationPathUi5){e.warning("User: Could not set UI5 location path")}if(!f.locationPathCustom){e.warning("User: Could not set location path for custom themes")}if(!f.locationOrigin){e.warning("User: Could not set front-end server location origin")}p=u.bootTheme||{theme:"",root:""};d=this._amendTheme(p,f);T=d};c.prototype._amendTheme=function(e,t){if(!e||!e.theme||!t){return{originalTheme:{theme:"",root:""},theme:"",suppliedRoot:"",path:"",locationPath:"",locationOrigin:""}}function n(e,t){var n=new s(e);var i=m(n);return{locationOrigin:i||t.locationOrigin,locationPath:i?n.path():e}}var i={originalTheme:u(e)};var o;if(i.originalTheme.theme.indexOf("@")>0){var r=i.originalTheme.theme.split("@",2);i.theme=r[0];i.suppliedRoot=r[1];o=n(r[1],t);i.locationPath=o.locationPath;i.path=i.locationPath;i.locationOrigin=o.locationOrigin;return i}i.theme=i.originalTheme.theme;if(i.originalTheme.root){i.suppliedRoot=i.originalTheme.root;o=n(i.originalTheme.root,t);i.locationPath=o.locationPath;i.path=i.locationPath;i.locationOrigin=o.locationOrigin;return i}i.suppliedRoot="";if(g(i.theme)){i.locationOrigin=t.locationOrigin;i.locationPath=t.locationPathUi5;i.path="";return i}i.locationOrigin=t.locationOrigin;i.locationPath=t.locationPathCustom;i.path=i.locationPath;return i};c.prototype.constants={themeFormat:{ORIGINAL_THEME:"O",THEME_NAME_PLUS_URL:"N+U",NWBC:"NWBC"}};return c},true);
//# sourceMappingURL=User.js.map