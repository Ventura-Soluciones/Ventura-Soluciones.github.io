// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Lib","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ushell/Container"],function(e,t,i,r,n){"use strict";var o=function(e,t,i){};o.prototype.search=function(e){return this._searchWithSearchableContentAndJsSearch(e)};o.prototype._searchWithSearchableContentAndJsSearch=function(e){return Promise.all([this._getNormalizedSearchableContentApps(e),this._loadJsSearchModule()]).then(function(t){var i=t[0];var r=t[1];var n=new r({objects:i,fields:["title","label","contentProviderLabel","description","keywords","fioriAppId"],shouldNormalize:!String.prototype.normalize,algorithm:{id:"contains-ranked",options:[50,49,40,39,5,4,51]}});var o={searchFor:e&&e.searchTerm||"*",top:Number.MAX_SAFE_INTEGER,skip:0};var a=n.search(o);var s=a.results.map(function(e){return e.object});return this._getPaginatedResult(this._applyFiltersAndSorter(s,e.filter,e.sort),e.skip||0,e.top||10)}.bind(this))};o.prototype._getPaginatedResult=function(e,t,i){return{data:e.slice(t,t+i),count:e.length}};o.prototype._getSearchableContent=function(e){var t=e&&{includeAppsWithoutVisualizations:!!e.includeAppsWithoutVisualizations,enableVisualizationPreview:e.enableVisualizationPreview!==false};return n.getServiceAsync("SearchableContent").then(function(e){return e.getApps(t)})};o.prototype._getNormalizedSearchableContentApps=function(e){return this._getSearchableContent(e).then(function(e){return this._normalizeSearchableContentServiceResult(e)}.bind(this))};o.prototype._normalizeSearchableContentServiceResult=function(e){if(!Array.isArray(e)){e=[]}var t=[];var i;var r;var n;var o;let a;e.forEach(function(e){if(e.visualizations&&e.visualizations.length>0){e.visualizations.forEach(function(s){i=s.vizConfig&&s.vizConfig["sap.app"]&&s.vizConfig["sap.app"].title||s.title||e.title;r=s.vizConfig&&s.vizConfig["sap.app"]&&s.vizConfig["sap.app"].subTitle||s.subtitle||e.subtitle;n=s.vizConfig&&s.vizConfig["sap.app"]&&s.vizConfig["sap.app"].description||s.description||e.description;a=s?.vizConfig?.["sap.fiori"]?.registrationIds||[];o=r?i+" - "+r:i;t.push({fioriAppId:a.join(" "),title:i,description:r,longDescription:n||"",keywords:Array.isArray(s.keywords)?s.keywords.join(" "):"",icon:s.icon||"",label:o,contentProviderLabel:s.contentProviderLabel||"",visualization:s,url:s.targetURL,technicalAttributes:Array.isArray(e.technicalAttributes)?e.technicalAttributes.join(" "):""})})}else{i=e.title;r=e.subtitle;o=r?i+" - "+r:i;t.push({title:i,description:r,longDescription:e.description||"",keywords:Array.isArray(e.keywords)?e.keywords.join(" "):"",icon:e.icon||"",label:o,url:e.targetURL,technicalAttributes:Array.isArray(e.technicalAttributes)?e.technicalAttributes.join(" "):""})}});return t};o.prototype._loadJsSearchModule=function(){this._loadJsSearchModulePromise=new Promise(function(t){e.load("sap.esh.search.ui").then(function(){sap.ui.require(["sap/esh/search/ui/appsearch/JsSearch"],function(e){t(e)})})});return this._loadJsSearchModulePromise};o.prototype._createFilters=function(e){var t=null;if(e){if(typeof e==="object"){if(Array.isArray(e.filters)){e.filters=e.filters.map(function(e){return e instanceof i?e:new i(e)})}t=[e instanceof i?e:new i(e)]}}return t};o.prototype._createSorters=function(e){var t=null;if(e){if(typeof e==="object"&&!Array.isArray(e)){e=[e]}if(Array.isArray(e)){t=e.map(function(e){return e instanceof r?e:new r(e)})}}return t};o.prototype._applyFiltersAndSorter=function(e,i,r){if(!i&&!r){return e}var n=this._createFilters(i),o=this._createSorters(r),a=new t;a.setSizeLimit(Number.MAX_SAFE_INTEGER);a.setData(e);return a.bindList("/",null,o,n).getContexts().map(function(e){return e.getObject()})};return o},false);
//# sourceMappingURL=SearchCEPAdapter.js.map