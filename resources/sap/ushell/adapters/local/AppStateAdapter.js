// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/appstate/AppStatePersistencyMethod","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/Container"],function(e,jQuery,t,r){"use strict";var n=function(e,t,r){this._oConfig=r&&r.config};n.prototype._getPersonalizationService=function(){return r.getServiceAsync("PersonalizationV2")};n.prototype.saveAppState=function(e,n,o,i,a,s,c){var u=new jQuery.Deferred;this._getPersonalizationService().then(function(n){n.createEmptyContainer(e,{keyCategory:n.KeyCategory.GENERATED_KEY,writeFrequency:n.WriteFrequency.HIGH,clientStorageAllowed:false}).then(function(e){e.setItemValue("appStateData",o);e.setItemValue("persistencyMethod",s);e.setItemValue("persistencySettings",c);e.setItemValue("createdBy",r&&r.getUser&&r.getUser().getId());e.save().then(function(){u.resolve()}).catch(function(e){u.reject(e);t.error(e)})}).catch(function(e){t.error(e);u.reject(e)})});return u.promise()};n.prototype.loadAppState=function(r){var n=new jQuery.Deferred,o=this;this._getPersonalizationService().then(function(i){i.getContainer(r,{keyCategory:i.KeyCategory.GENERATED_KEY,writeFrequency:i.WriteFrequency.HIGH,clientStorageAllowed:false}).then(function(t){var i=t.getItemValue("appStateData"),a=t.getItemValue("persistencyMethod"),s=t.getItemValue("persistencySettings"),c=t.getItemValue("createdBy");if(a===undefined){n.resolve(r,i)}else if(a===e.PersonalState){if(o.getCurrentUserForTesting()===""||o.getCurrentUserForTesting()===c){n.resolve(r,i,a,s)}else{n.reject("Unauthorized User ID")}}}).catch(function(e){t.error(e);n.reject(e)})});return n.promise()};n.prototype.deleteAppState=function(e){var r=new jQuery.Deferred;this._getPersonalizationService().then(function(n){n.deleteContainer(e).then(function(){r.resolve()}).catch(function(e){t.error(e);r.reject(e)})});return r.promise()};n.prototype.getCurrentUserForTesting=function(){return""};n.prototype.getSupportedPersistencyMethods=function(){return[]};return n},false);
//# sourceMappingURL=AppStateAdapter.js.map