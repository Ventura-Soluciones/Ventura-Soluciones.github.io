// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["./WorkPageService","sap/ushell/Config"],function(e,t){"use strict";const i={NO_DESTINATION_FOUND:"NO_DESTINATION_FOUND",COULD_NOT_RETRIEVE_DESTINATIONS:"COULD_NOT_RETRIEVE_DESTINATIONS",NO_CARD_OR_DESTINATION_NAME:"NO_CARD_OR_DESTINATION_NAME",RESOLVED_URL_EMPTY:"RESOLVED_URL_EMPTY"};class r{#e;#t=new Map;constructor(){const e=new URLSearchParams(window.location.search);this._sSiteId=e.get("siteId")||t.last("/core/site/siteId");this.fetchData()}_getContentProviderDestinationMappings(){if(!this._providerPromise){this._providerPromise=new Promise((e,t)=>{this.fetchData().then(t=>{t.forEach(e=>{const t=new Map;e.logicalDataDestinationMappings.forEach(e=>{t.set(e.logicalDestinationName,e.resolvedUrl)});this.#t.set(e.id,t)});return e(this.#t)}).catch(e=>{t(e)})})}return this._providerPromise}async fetchData(){if(!this._dataPromise){try{this._dataPromise=new Promise(async(t,i)=>{this.#e=await new e;try{const e=await this.#e.loadSiteAndDataDestinationMappings();const s=e?.data?.site?.providers?.nodes;if(s&&Object.keys(s[0]).length){return t(s)}return i(r.ERROR_CODES.COULD_NOT_RETRIEVE_DESTINATIONS)}catch(e){return i(r.ERROR_CODES.COULD_NOT_RETRIEVE_DESTINATIONS)}})}catch(e){throw new Error("DestinationResolver: Failed to Initialize the WorkPageService",e)}}return this._dataPromise}resolveCardDestination(e,t){return new Promise((s,n)=>{if(!e||!t){return n(i.NO_CARD_OR_DESTINATION_NAME)}this._getContentProviderDestinationMappings().then(a=>{const o=a.get(t.getReferenceId())?.get(e);if(o){return s(o)}else if(o===""){return n(i.RESOLVED_URL_EMPTY)}return n(r.ERROR_CODES.NO_DESTINATION_FOUND)}).catch(t=>{if(!this._sSiteId){return s(`${location.origin}/dynamic_dest/${e}`)}return n(t)})})}}r.ERROR_CODES=i;return r},true);
//# sourceMappingURL=DestinationResolver.js.map