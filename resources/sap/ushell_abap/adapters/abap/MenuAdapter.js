// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/util/isPlainObject","sap/ushell/components/pages/controller/PagesAndSpaceId","sap/ushell/Config","sap/ushell/library","sap/ushell/utils"],function(e,t,n,i,r,a){"use strict";var s=r.ContentNodeType;var o=function(){};o.prototype.isMenuEnabled=function(){var e=i.last("/core/menu/enabled");var t=this._getAssignedSpaces().length;return Promise.resolve(e&&t>0)};o.prototype.isSideNavigationEnabled=async function(){if(!i.last("/core/sideNavigation/enabled")){return false}const e=await this.getMenuEntries();return e.length>0};o.prototype.getMenuEntries=function(){return n.getUserMyHomeEnablement().then(function(e){var t=i.last("/core/homeApp/enabled");var n=i.last("/core/spaces/myHome/enabled");var r=i.last("/core/spaces/myHome/myHomeSpaceId");var a=this._getAssignedSpaces();if(t&&n||n&&!e){for(var s=0;s<a.length;s++){if(a[s].id===r){a=a.slice(1);break}}}var o=this._buildMenuEntries(a);return o}.bind(this))};o.prototype.getMenuPersonalization=function(){var e=document.querySelector("meta[name='sap.ushell.menuPersonalization']");if(!e){return null}var t=JSON.parse(e.getAttribute("content"));return t};o.prototype.getContentNodeEntries=function(){var e=this._getAssignedSpaces();this._removeMyHomeForContentNodes(e);var t=this._buildMenuEntries(e);return Promise.resolve(t)};o.prototype.getContentNodes=function(){var e=this._getAssignedSpaces();this._removeMyHomeForContentNodes(e);var t=this._buildContentNodes(e);return Promise.resolve(t)};o.prototype._buildMenuEntries=function(e){var t=e.filter(this._isSpaceNotEmpty.bind(null,"FLP menu")).map(function(e,t){var n={id:e.id,title:e.title||e.id,"help-id":"Space-"+e.id,description:e.description,icon:undefined,type:"IBN",target:{semanticObject:"Launchpad",action:"openFLPPage",parameters:[{name:"spaceId",value:e.id},{name:"pageId",value:e.pages[0].id}],innerAppRoute:undefined},isHomeEntry:t===0&&e.id===i.last("/core/spaces/myHome/myHomeSpaceId"),menuEntries:[]};var r=e.pages.map(function(t){return{id:t.id,title:t.title||t.id,"help-id":"Page-"+t.id,description:t.description,icon:undefined,type:"IBN",target:{semanticObject:"Launchpad",action:"openFLPPage",parameters:[{name:"spaceId",value:e.id},{name:"pageId",value:t.id}],innerAppRoute:undefined},menuEntries:[]}});if(r.length>1){n.menuEntries=r}return n});return t};o.prototype._buildContentNodes=function(e){var t=e.filter(this._isSpaceNotEmpty.bind(null,"content nodes")).map(function(e){return{id:e.id,label:e.title||e.id,type:s.Space,isContainer:false,children:e.pages.map(function(e){return{id:e.id,label:e.title||e.id,type:s.Page,isContainer:true}})}});return t};o.prototype._isSpaceNotEmpty=function(t,n){if(!n.pages||n.pages.length===0){e.warning("FLP space "+n.id+" without page omitted in "+t+".","","sap.ushell_abap.adapters.abap.MenuAdapter");return false}return true};o.prototype._removeMyHomeForContentNodes=function(e){var t=i.last("/core/homeApp/enabled");var n=i.last("/core/spaces/myHome/enabled");var r=i.last("/core/spaces/myHome/userEnabled");var a=i.last("/core/spaces/myHome/myHomeSpaceId");if(t){return}if(n&&!r){if(e[0]&&e[0].id===a){e.shift()}}};o.prototype._getAssignedSpaces=function(){var e=document.querySelector("meta[name='sap.ushell.assignedSpaces']");if(!e){return[]}var n=a.getFormFactor();var i=JSON.parse(e.getAttribute("content"));return i.filter(e=>{if(!t(e.visibility)){return true}return e.visibility[n]}).map(e=>{e.pages=e.pages.filter(e=>{if(!t(e.visibility)){return true}return e.visibility[n]});return e})};return o});
//# sourceMappingURL=MenuAdapter.js.map