/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./library","./Core","sap/ui/core/library","sap/ui/core/Element","./DrawerToolbarRenderer","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/core/ResizeHandler","sap/ui/core/InvisibleText","sap/ui/Device","sap/m/VBox","sap/m/HBox","sap/m/FlexItemData","sap/m/OverflowToolbar","sap/ui/core/Icon","sap/m/OverflowToolbarButton","sap/m/Button","sap/m/Input","sap/m/Text","sap/m/ToolbarSeparator","sap/m/OverflowToolbarToggleButton","sap/m/OverflowToolbarMenuButton","./tools/RectSelectTool","./tools/CrossSectionTool","sap/m/Menu","sap/m/MenuItem","./NavigationMode","./ZoomTo","./getResourceBundle","./ToggleMenuButton","./ToggleMenuItem","./Viewport","./DrawerToolbarButton","sap/ui/base/ManagedObjectObserver","sap/ui/core/Core","./tools/HighlightMeasurementTool","./tools/CalibrateDistanceMeasurementTool","./tools/DeleteMeasurementTool","./tools/DistanceMeasurementTool","./tools/AngleMeasurementTool","./tools/AreaMeasurementTool","./thirdparty/three","sap/m/library"],function(e,t,i,n,s,o,a,r,l,u,c,d,g,m,h,_,p,T,f,v,I,w,b,x,P,E,M,S,y,O,V,B,C,R,A,N,F,D,L,z,k,U,H){"use strict";const W=H.ToolbarDesign;const G=H.ButtonType;const Z=H.FlexRendertype;const K=H.FlexAlignItems;const q=H.FlexAlignContent;const Q=i.TextAlign;const j=i.ValueState;const X=H.InputType;var Y=o.extend("sap.ui.vk.DrawerToolbar",{metadata:{library:"sap.ui.vk",properties:{expanded:{type:"boolean",defaultValue:true},navigationMode:{type:"sap.ui.vk.NavigationMode",defaultValue:M.Turntable}},aggregations:{content:{type:"sap.ui.core.Control",multiple:true,forwarding:{getter:"_getToolbar",aggregation:"content",forwardBinding:true}},_container:{type:"sap.m.VBox",multiple:false,visibility:"hidden"}},associations:{viewport:{type:"sap.ui.vk.ViewportBase",multiple:false}},events:{expanded:{parameters:{expand:{type:"boolean"}}}}},constructor:function(e,t){o.apply(this,arguments)}});var J=[{name:"show",unicode:"e900"},{name:"hide",unicode:"e901"},{name:"turntable",unicode:"e902"},{name:"orbit",unicode:"e903"},{name:"pan",unicode:"e904"},{name:"zoom",unicode:"e905"},{name:"fit-to-view",unicode:"e906"},{name:"rectangular-selection",unicode:"e907"},{name:"predefined-views",unicode:"e93c"},{name:"predefined-views-left",unicode:"e94b"},{name:"predefined-views-right",unicode:"e94c"},{name:"predefined-views-top",unicode:"e94d"},{name:"predefined-views-bottom",unicode:"e949"},{name:"predefined-views-front",unicode:"e94a"},{name:"predefined-views-back",unicode:"e948"},{name:"cross-section",unicode:"e913"},{name:"cross-section-x",unicode:"e914"},{name:"cross-section-y",unicode:"e916"},{name:"cross-section-z",unicode:"e915"},{name:"reverse-direction",unicode:"e917"},{name:"distance-measurement",unicode:"e92b"},{name:"angle-measurement",unicode:"e926"},{name:"area-measurement",unicode:"e963"},{name:"settings",unicode:"e909"},{name:"calibrate-distance",unicode:"e968"},{name:"toggle-pmi",unicode:"e96d"},{name:"fit-to-page",unicode:"e96e"},{name:"fit-to-width",unicode:"e96f"}];var $="vk-icons";var ee="vk-icons";J.forEach(function(e){a.addIcon(e.name,$,ee,e.unicode)});var te="sap-icon://vk-icons/";Y.prototype.init=function(){if(o.prototype.init){o.prototype.init.apply(this)}this._measurementsToggleButton=null;this._distanceMeasurementItem=null;this._angleMeasurementItem=null;this._areaMeasurementItem=null;this._deleteMeasurementItem=null;this._measurementSettingsItem=null;this._calibrateDistanceMeasurementItem=null;this._itemsVisibility=new Map;this._itemsVisibilityObserver=new R(this._itemVisibilityChanged.bind(this));this._toolbar=new m({asyncMode:true,width:"auto",design:W.Solid,layoutData:new g({growFactor:0,shrinkFactor:0}),content:this.createButtons()}).addStyleClass("drawerToolbarMaxWidth").data("help-id","sapUiVkToolbar",true);this._toolbar.ontouchstart=function(e){e.setMarked()};this._toolbarObserver=new R(this._toolbarContentChanged.bind(this));this._toolbarObserver.observe(this._toolbar,{aggregations:["content"]});this._container=new c({renderType:Z.Bare,alignContent:q.Center,alignItems:K.Center,items:[this._toolbar,new h({src:"sap-icon://navigation-up-arrow",tooltip:this._getTooltip(),press:function(e){this._toggleExpanded();this._updateTooltip(e.getSource())}.bind(this),layoutData:new g({growFactor:0,shrinkFactor:0})}).addStyleClass("drawerToolbarIcon")]}).data("help-id","sapUiVkToolbarContainer",true);this.setAggregation("_container",this._container);this._rectSelectTool=new b;this._distanceMeasurementTool=new L({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._distanceMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"))}},this]});this._angleMeasurementTool=new z({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._angleMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"))}},this]});this._areaMeasurementTool=new k({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._areaMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"))}},this]});this._deleteMeasurementTool=new D({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._deleteMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"));if(this._getViewport().getMeasurementSurface().getMeasurements().length===0){this._measurementsToggleButton.setDefaultItem(this._distanceMeasurementItem)}}},this]});this._calibrateDistanceMeasurementTool=new F({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._calibrateDistanceMeasurementItem.getId()){var t=e.getParameter("enabled");this._measurementsToggleButton.setPressed(t);if(!t){this._measurementsToggleButton.setDefaultItem(this._distanceMeasurementItem)}}},this]});this._highlightMeasurementTool=new N;var e=[this._distanceMeasurementTool,this._angleMeasurementTool,this._areaMeasurementTool,this._deleteMeasurementTool,this._calibrateDistanceMeasurementTool];function i(t){var i=e.find(function(e){return e.getActive()});this._highlightMeasurementTool.setActive(i==null,this._getViewport())}e.forEach(function(e){e.attachEnabled(i,this)},this);var n=t.getEventBus();n.subscribe("sap.ui.vk","viewActivated",this._onViewActivated,this);n.subscribe("sap.ui.vk","readyForAnimation",this._onReadyForAnimation,this)};Y.prototype.exit=function(){n.getElementById(this.getViewport())?.detachResize(this._onViewportResize,this);var e=t.getEventBus();e.unsubscribe("sap.ui.vk","readyForAnimation",this._onReadyForAnimation,this);e.unsubscribe("sap.ui.vk","viewActivated",this._onViewActivated,this);this._distanceMeasurementTool.destroy();this._distanceMeasurementTool=null;this._angleMeasurementTool.destroy();this._angleMeasurementTool=null;this._highlightMeasurementTool.destroy();this._highlightMeasurementTool=null;this._areaMeasurementTool.destroy();this._areaMeasurementTool=null;this._deleteMeasurementTool.destroy();this._deleteMeasurementTool=null;this._calibrateDistanceMeasurementTool.destroy();this._calibrateDistanceMeasurementTool=null;this._measurementsToggleButton=null;this._distanceMeasurementItem=null;this._angleMeasurementItem=null;this._areaMeasurementItem=null;this._deleteMeasurementItem=null;this._measurementSettingsItem=null;this._calibrateDistanceMeasurementItem=null;this._toolbarObserver.disconnect();this._toolbarObserver=null;this._toolbar.destroy();this._toolbar=null};Y.prototype._onViewportResize=function(e){this._toolbar.onLayoutDataChange()};Y.prototype.setViewport=function(e){n.getElementById(this.getViewport())?.detachResize(this._onViewportResize,this);this.setAssociation("viewport",e);e?.attachResize(this._onViewportResize,this);e?.attachEvent("documentReplaced",{},this._onDocumentReplaced,this);e?.attachEvent("pageChanged",{},this._onPageChanged,this)};Y.prototype._onDocumentReplaced=function(e){this._pdfDocument=e.getParameter("newDocument");if(this._pdfDocument==null){this._pdfTotalPages=0;this._totalPageCountText.setText("0");this._currentPageIndexInput.setValue("");this._currentPageIndexInput.setEnabled(false);this._previousPageButton.setEnabled(false);this._nextPageButton.setEnabled(false);this._zoomInButton.setEnabled(false);this._zoomOutButton.setEnabled(false);this._zoomToFitPageButton.setEnabled(false);this._zoomToFitPageWidthButton.setEnabled(false)}else{this._pdfTotalPages=this._pdfDocument.pageCount;this._totalPageCountText.setText(`${this._pdfTotalPages}`);this._currentPageIndexInput.setEnabled(true);this._previousPageButton.setEnabled(this._pdfPageIndex!==0);this._nextPageButton.setEnabled(this._pdfPageIndex+1!==this._pdfTotalPages);this._zoomInButton.setEnabled(true);this._zoomOutButton.setEnabled(true);this._zoomToFitPageButton.setEnabled(true);this._zoomToFitPageWidthButton.setEnabled(true)}};Y.prototype._onPageChanged=function(e){this._pdfPageIndex=e.getParameter("newPageIndex");this._invisPageIndex.setText(y().getText("PAGE_COUNT_INPUT",[this._pdfPageIndex+1,this._pdfTotalPages]));this._currentPageIndexInput.setValue(this._pdfPageIndex+1);this._currentPageIndexInput.setValueState(j.None);this._previousPageButton.setEnabled(this._pdfPageIndex!==0);this._nextPageButton.setEnabled(this._pdfPageIndex+1!==this._pdfTotalPages)};Y.prototype._toolbarContentChanged=function(){var e=this._toolbar.getContent();for(var t=0;t<e.length;t++){if(e[t].getMetadata().getName()=="sap.m.ToolbarSeparator"){if(e[t-1]==undefined||e[t+1]==undefined||e[t-1].getMetadata().getName()=="sap.m.ToolbarSeparator"){this._toolbar.removeContent(t)}}}};Y.prototype._itemVisibilityChanged=function(e){if(!this._ignoreVisibilityChange){this._itemsVisibility.set(e.object,e.current)}};function ie(e){return e?e.getMetadata().getName()==="sap.ui.vk.threejs.Viewport":false}function ne(e){return e?e.getMetadata().getName()==="sap.ui.vk.svg.Viewport":false}function se(e){return e?e.getMetadata().getName()==="sap.ui.vk.NativeViewport":false}function oe(e){return e?e.getMetadata().getName()==="sap.ui.vk.pdf.Viewport":false}function ae(e){var t=e.getCurrentView&&e.getCurrentView();var i=t&&t.getDimension();return ie(e)&&!e._redlineHandler&&!e._isPlanarActivated()&&i!==2}Y.prototype._getViewport=function(){var e=n.getElementById(this.getViewport());e=e instanceof B&&e.getImplementation()||e;return e&&(ie(e)||ne(e)||se(e)||oe(e))?e:null};Y.prototype._getViewStateManager=function(){var e=n.getElementById(this.getViewport());var t=e.getViewStateManager();if(t){return n.getElementById(t)}return null};var re=[null,(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),0),(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),Math.PI),(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),-Math.PI/2),(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),Math.PI/2),(new U.Quaternion).setFromAxisAngle(new U.Vector3(1,0,0),-Math.PI/2),(new U.Quaternion).setFromAxisAngle(new U.Vector3(1,0,0),Math.PI/2)];Y.prototype.createButtons=function(){var e=this;var t=y();var i=new O({type:G.Transparent,tooltip:t.getText("CROSS_SECTION_TOOLTIP"),items:[new V({icon:te+"cross-section-x",text:t.getText("CROSS_SECTION_X"),key:0}),new V({icon:te+"cross-section-y",text:t.getText("CROSS_SECTION_Y"),key:1}),new V({icon:te+"cross-section-z",text:t.getText("CROSS_SECTION_Z"),key:2}),new V({icon:te+"reverse-direction",text:t.getText("CROSS_SECTION_REVERSE"),startsSection:true,toggleable:false,press:function(t){var i=e._getViewport();if(i&&e._crossSectionTool&&e._crossSectionTool.getActive()){e._crossSectionTool.setFlip(!e._crossSectionTool.getFlip())}}})],itemToggled:function(t){var i=e._getViewport();if(i&&e._crossSectionTool){var n=t.getParameter("newItem");e._crossSectionTool.setActive(n!=null,i);if(n){var s=parseInt(n.getKey(),10);if(s>=0&&s<3){e._crossSectionTool.setAxis(s)}}}}});i.vitId=C.CrossSection;var s=new I({icon:te+"turntable",type:G.Transparent,text:t.getText("TURNTABLE_TOOLTIP"),tooltip:t.getText("TURNTABLE_TOOLTIP"),press:function(t){e.setNavigationMode(M.Turntable)}});s.vitId=C.Turntable;var o=new I({icon:te+"orbit",type:G.Transparent,text:t.getText("ORBIT_TOOLTIP"),tooltip:t.getText("ORBIT_TOOLTIP"),pressed:false,press:function(t){e.setNavigationMode(M.Orbit)}});o.vitId=C.Orbit;var a=new I({icon:te+"pan",type:G.Transparent,text:t.getText("PAN_TOOLTIP"),tooltip:t.getText("PAN_TOOLTIP"),press:function(t){e.setNavigationMode(M.Pan)}});a.vitId=C.Pan;var r=new I({icon:te+"zoom",type:G.Transparent,text:t.getText("ZOOM_TOOLTIP"),tooltip:t.getText("ZOOM_TOOLTIP"),press:function(){e.setNavigationMode(M.Zoom)}});r.vitId=C.Zoom;this._gestureButtons=[s,o,a,r];var u=new _({icon:te+"show",type:G.Transparent,text:t.getText("SHOW_TOOLTIP"),tooltip:t.getText("SHOW_TOOLTIP"),press:function(){var t=e._getViewStateManager();if(t){var i=[];t.enumerateSelection(function(e){i.push(e)});t.setVisibilityState(i,true,false)}}});u.vitId=C.Show;var c=new _({icon:te+"hide",type:G.Transparent,text:t.getText("HIDE_TOOLTIP"),tooltip:t.getText("HIDE_TOOLTIP"),press:function(){var t=e._getViewStateManager();if(t){var i=[];t.enumerateSelection(function(e){i.push(e)});t.setVisibilityState(i,false,false)}}});c.vitId=C.Hide;var g=new _({icon:te+"fit-to-view",type:G.Transparent,text:t.getText("FIT_TO_VIEW"),tooltip:t.getText("FIT_TO_VIEW"),press:function(){var t=n.getElementById(e.getViewport());t=t instanceof B&&t.getImplementation()||t;if(t){t.zoomTo(S.All,null,.5,0)}}});g.vitId=C.FitToView;this._rectSelectionButton=new I({icon:te+"rectangular-selection",type:G.Transparent,text:t.getText("RECTANGULAR_SELECTION_TOOLTIP"),tooltip:t.getText("RECTANGULAR_SELECTION_TOOLTIP")});this._rectSelectionButton.vitId=C.RectangularSelection;var m=new w({icon:te+"predefined-views",activeIcon:te+"predefined-views",type:G.Transparent,text:t.getText("PREDEFINED_VIEW_MENUBUTTONTOOLTIP"),tooltip:t.getText("PREDEFINED_VIEW_MENUBUTTONTOOLTIP"),menu:new P({items:[new E({icon:te+"predefined-views",text:t.getText("PREDEFINED_VIEW_INITIAL")}),new E({icon:te+"predefined-views-front",text:t.getText("PREDEFINED_VIEW_FRONT"),startsSection:true}),new E({icon:te+"predefined-views-back",text:t.getText("PREDEFINED_VIEW_BACK")}),new E({icon:te+"predefined-views-left",text:t.getText("PREDEFINED_VIEW_LEFT")}),new E({icon:te+"predefined-views-right",text:t.getText("PREDEFINED_VIEW_RIGHT")}),new E({icon:te+"predefined-views-top",text:t.getText("PREDEFINED_VIEW_TOP")}),new E({icon:te+"predefined-views-bottom",text:t.getText("PREDEFINED_VIEW_BOTTOM")})]}).attachItemSelected(function(t){var i=e._getViewport();if(i){var n=t.getParameters("item").item;var s=this.indexOfItem(n);i._viewportGestureHandler.setView(re[s],1e3)}})});m.vitId=C.PredefinedViews;var h=new I({icon:"sap-icon://full-screen",type:G.Transparent,text:t.getText("VIEWER_FULLSCREENBUTTONTOOLTIP"),tooltip:t.getText("VIEWER_FULLSCREENBUTTONTOOLTIP"),press:function(t){var i=e._getViewport();var n=function(e){return!!(e.fullScreen||e.webkitIsFullScreen||e.mozFullScreen||e.msFullscreenElement)};if(this.getPressed()){if(!n(document)){if(!e._fullScreenHandler){e._fullScreenHandler=function(t){var s=n(document);if(!s){document.removeEventListener("fullscreenchange",e._fullScreenHandler);document.removeEventListener("mozfullscreenchange",e._fullScreenHandler);document.removeEventListener("webkitfullscreenchange",e._fullScreenHandler);document.removeEventListener("MSFullscreenChange",e._fullScreenHandler);this.setPressed(false);i.removeStyleClass("sapVizKitViewerFullScreen")}}.bind(this)}var s=document.getElementsByTagName("body")[0];if(s.requestFullscreen){document.addEventListener("fullscreenchange",e._fullScreenHandler);s.requestFullscreen()}else if(s.webkitRequestFullScreen){document.addEventListener("webkitfullscreenchange",e._fullScreenHandler);s.webkitRequestFullscreen()}else if(s.mozRequestFullScreen){document.addEventListener("mozfullscreenchange",e._fullScreenHandler);s.mozRequestFullScreen()}else if(s.msRequestFullscreen){document.addEventListener("MSFullscreenChange",e._fullScreenHandler);s.msRequestFullscreen()}}i.addStyleClass("sapVizKitViewerFullScreen")}else{if(n(document)){if(document.cancelFullScreen){document.cancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}}i.removeStyleClass("sapVizKitViewerFullScreen")}}});h.vitId=C.FullScreen;this._distanceMeasurementItem=new V({icon:te+"distance-measurement",text:t.getText("MEASUREMENTS_DISTANCE_MENUITEM")});this._angleMeasurementItem=new V({icon:te+"angle-measurement",text:t.getText("MEASUREMENTS_ANGLE_MENUITEM")});this._areaMeasurementItem=new V({icon:te+"area-measurement",text:t.getText("MEASUREMENTS_AREA_MENUITEM")});this._deleteMeasurementItem=new V({icon:"sap-icon://delete",text:t.getText("MEASUREMENTS_DELETE_MENUITEM")});this._calibrateDistanceMeasurementItem=new V({icon:te+"calibrate-distance",text:t.getText("MEASUREMENTS_CALIBRATE_DISTANCE_MENUITEM")});this._measurementSettingsItem=new V({startsSection:true,icon:te+"settings",text:t.getText("MEASUREMENTS_SETTINGS_MENUITEM"),toggleable:false});this._measurementsToggleButton=new O({type:G.Transparent,tooltip:t.getText("MEASUREMENTS_TOOLTIP"),items:[this._distanceMeasurementItem,this._angleMeasurementItem,this._areaMeasurementItem,this._deleteMeasurementItem,this._calibrateDistanceMeasurementItem,this._measurementSettingsItem],itemToggled:function(t){const i=e._getViewport();const n=t.getParameter("oldItem");const s=t.getParameter("newItem");const o=i.getMeasurementSurface();for(const e of o.getMeasurementsUnderConstruction()){o.cancelMeasurementConstruction(e)}if(n===e._distanceMeasurementItem){e._distanceMeasurementTool.setActive(false,i)}else if(n===e._angleMeasurementItem){e._angleMeasurementTool.setActive(false,i)}else if(n===e._areaMeasurementItem){e._areaMeasurementTool.setActive(false,i)}else if(n===e._deleteMeasurementItem){e._deleteMeasurementTool.setActive(false,i)}else if(n===e._calibrateDistanceMeasurementItem){e._calibrateDistanceMeasurementTool.setActive(false,i)}const a=i.getTools();let r;if(s===e._distanceMeasurementItem){r=e._distanceMeasurementTool}else if(s===e._angleMeasurementItem){r=e._angleMeasurementTool}else if(s===e._areaMeasurementItem){r=e._areaMeasurementTool}else if(s===e._deleteMeasurementItem){r=e._deleteMeasurementTool}else if(s===e._calibrateDistanceMeasurementItem){r=e._calibrateDistanceMeasurementTool}if(r!=null){if(a.indexOf(r.getId())<0){i.addTool(r)}r.setActive(true,i)}},itemSelected:function(t){var i=e._getViewport();var n=t.getParameter("item");if(n===e._measurementSettingsItem){e._distanceMeasurementTool.setActive(false,i);e._angleMeasurementTool.setActive(false,i);e._areaMeasurementTool.setActive(false,i);e._deleteMeasurementTool.setActive(false,i);e._calibrateDistanceMeasurementTool.setActive(false,i);e._distanceMeasurementTool.showSettingsDialog(i)}},beforeMenuOpen:function(){var t=e._getViewport();var i=t.getMeasurementSurface();var n=i.getMeasurements().length>0;e._deleteMeasurementItem.setEnabled(n);var s=i.getMeasurements().some(function(e){return e.isDistance});e._calibrateDistanceMeasurementItem.setEnabled(s)}});this._measurementsToggleButton.vitId=C.Measurements;this._zoomInButton=new _({icon:"sap-icon://zoom-in",tooltip:t.getText("ZOOM_IN_TOOLTIP"),enabled:false,press:()=>{const e=this._getViewport();const{left:t,top:i,right:n,bottom:s}=e.getDomRef("page").getBoundingClientRect();e.zoom(1.1,(t+n)/2,(i+s)/2)}});this._zoomInButton.vitId=C.ZoomIn;this._zoomOutButton=new _({icon:"sap-icon://zoom-out",tooltip:t.getText("ZOOM_OUT_TOOLTIP"),enabled:false,press:()=>{const e=this._getViewport();const{left:t,top:i,right:n,bottom:s}=e.getDomRef("page").getBoundingClientRect();e.zoom(1/1.1,(t+n)/2,(i+s)/2)}});this._zoomOutButton.vitId=C.ZoomOut;this._zoomToFitPageButton=new _({icon:te+"fit-to-page",tooltip:t.getText("FIT_TO_PAGE_TOOLTIP"),enabled:false,press:()=>this._getViewport().zoomToFitPage()});this._zoomToFitPageButton.vitId=C.FitToPage;this._zoomToFitPageWidthButton=new _({icon:te+"fit-to-width",tooltip:t.getText("FIT_TO_WIDTH_TOOLTIP"),enabled:false,press:()=>this._getViewport().zoomToFitPageWidth()});this._zoomToFitPageWidthButton.vitId=C.FitToWidth;this._previousPageButton=new _({type:G.Transparent,tooltip:t.getText("PREVIOUS_PAGE_TOOLTIP"),icon:"sap-icon://navigation-left-arrow",enabled:false,press:()=>{this._getViewport().setCurrentPageIndex(this._pdfPageIndex-1)}});this._nextPageButton=new _({type:G.Transparent,tooltip:t.getText("NEXT_PAGE_TOOLTIP"),icon:"sap-icon://navigation-right-arrow",enabled:false,press:()=>{this._getViewport().setCurrentPageIndex(this._pdfPageIndex+1)}});this._invisPageIndex=new l;this._currentPageIndexInput=new T({ariaLabelledBy:this._invisPageIndex,type:X.Number,enabled:false,submit:e=>{const t=e.getParameter("value");if(t<1||t>this._pdfTotalPages){return}this._getViewport().setCurrentPageIndex(t-1)},liveChange:e=>{const t=e.getParameter("value");const i=t.replaceAll(".","");this._currentPageIndexInput.setValue(i);if(i<1||i>this._pdfTotalPages){this._currentPageIndexInput.setValueState(j.Error);this._currentPageIndexInput.setValueStateText(y().getText(i===""?"PAGE_COUNT_EMPTY":"PAGE_COUNT_ERROR",[i]))}else{this._currentPageIndexInput.setValueState(j.None)}}}).addStyleClass("sapVizKitPageGalleryToolbarCurrentPageIndex").addEventDelegate({onfocusout:()=>{const e=this._currentPageIndexInput.getValue();if(e<1||e>this._pdfTotalPages){return}this._getViewport().setCurrentPageIndex(e-1)}});const p=new f({text:"/",wrapping:false,textAlign:Q.Center}).addStyleClass("sapVizKitPageGalleryToolbarSlash");this._totalPageCountText=new f({text:"0",wrapping:false});const b=new v;this._pageNavigation=new d({renderType:Z.Bare,alignItems:"Center",items:[this._previousPageButton,this._invisPageIndex,this._currentPageIndexInput,p,this._totalPageCountText,this._nextPageButton]}).addStyleClass("sapVizKitPageGalleryPageNavigation");this.addEventDelegate({onAfterRendering:()=>{const e=this._currentPageIndexInput.getDomRef("inner");if(e!=null){const t=parseFloat(window.getComputedStyle(e).minWidth);this._currentPageIndexInput.setWidth(Math.max(t,this._totalPageCountText.getDomRef().offsetWidth+12)+"px")}}});this._pageNavigation.vitId=C.PageNavigation;var x=new v;x.vitId=C.MeasurementsSeparator;var R=new I({pressed:true,icon:te+"toggle-pmi",type:G.Transparent,text:t.getText("PMI_TOOLTIP"),tooltip:t.getText("PMI_TOOLTIP"),press:function(){var t=e._getViewport();if(t){t.setShowPMI(this.getPressed());t.setShouldRenderFrame()}}});R.vitId=C.PMI;var A=new v;A.vitId=C.PMISeparator;var N=new v;var F=new v;var D=new v;var L=new v;this._itemsShowHideSelect=[u,c,D,this._rectSelectionButton,L];this._itemTurntable=this._gestureButtons[0];this._itemPan=this._gestureButtons[2];this._pdfItems=[this._zoomInButton,this._zoomOutButton,this._zoomToFitPageButton,this._zoomToFitPageWidthButton,b,this._pageNavigation];this._items3D=[this._gestureButtons[1],i,N,m,F];var z=[u,c,D,R,A,this._gestureButtons[0],this._gestureButtons[1],this._gestureButtons[2],this._gestureButtons[3],new v,this._measurementsToggleButton,x,g,new v,this._rectSelectionButton,L,i,N,m,F,h,this._zoomInButton,this._zoomOutButton,this._zoomToFitPageButton,this._zoomToFitPageWidthButton,b,this._pageNavigation];this._notPdfItems=[r,z[9],z[13],R,A,x,this._measurementsToggleButton,g,h];z.forEach(function(e){this._itemsVisibility.set(e,true);this._itemsVisibilityObserver.observe(e,{properties:["visible"]})}.bind(this));return z};var le=["drawerToolbarIconTurntable","drawerToolbarIconOrbit","drawerToolbarIconPan","drawerToolbarIconZoom"];var ue=function(e,t){this.viewport=e;this._toolbar=t;this._mode=1;this._gesture=false;this._x=0;this._y=0};function ce(e,t){le.forEach(function(i,n){if(e.hasStyleClass(i)&&n!==t){e.removeStyleClass(i)}else if(n===t){e.addStyleClass(i)}})}function de(e){var t=e.viewport;var i=e._mode;var n=t.hasStyleClass(le[i])?i:-1;e._isScrolling=true;if(n!==3){ce(t,3);setTimeout(function(){e._isScrolling=false;ce(t,n)},500)}}ue.prototype.beginGesture=function(e){this._gesture=true;if(this._mode<3){this._x=e.points[0].x;this._y=e.points[0].y}else{this._x=e.x;this._y=e.y}if(e.scroll){de(this)}if(this._toolbar._rectSelectionButton.getPressed()||e.event&&(u.os.macintosh?e.event.metaKey:e.event.ctrlKey)){var t=this.viewport.getDomRef().getBoundingClientRect();this._selectionRect={x1:this._x-t.left,y1:this._y-t.top,x2:this._x-t.left,y2:this._y-t.top}}};ue.prototype.endGesture=function(){this._gesture=false;if(this._selectionRect&&(this._selectionRect.x1!==this._selectionRect.x2||this._selectionRect.y1!==this._selectionRect.y2)){this._toolbar._rectSelectTool._select(this._selectionRect.x1,this._selectionRect.y1,this._selectionRect.x2,this._selectionRect.y2,this.viewport,this.viewport.getScene(),this.viewport.getCamera());this._selectionRect=null;this.viewport.setSelectionRect(null)}else if(!this._isScrolling){ce(this.viewport,-1)}};ue.prototype.move=function(e){if(this._gesture){if(e.n==1){var t=e.points[0];if(this._selectionRect){var i=this.viewport.getDomRef().getBoundingClientRect();this._selectionRect.x2=t.x-i.left;this._selectionRect.y2=t.y-i.top;this.viewport.setSelectionRect(this._selectionRect)}else{ce(this.viewport,this._mode);var n=t.x-this._x;var s=t.y-this._y;switch(this._mode){case 0:this.viewport.rotate(n,s,true);break;case 1:this.viewport.rotate(n,s,false);break;case 2:this.viewport.pan(n,s);break;case 3:this.viewport.zoom(1+s*.005);break;default:break}this._x=t.x;this._y=t.y}e.handled=true}else if(!(ie(this.viewport)&&this.viewport._isPanoramicActivated())&&e.n==2&&!this._isScrolling){ce(this.viewport,2)}else if(ie(this.viewport)&&this.viewport._isPanoramicActivated()&&e.n==2&&!this._isScrolling){ce(this.viewport,0)}}};ue.prototype.hover=function(){};ue.prototype.getViewport=function(){return this.viewport};Y.prototype.setNavigationMode=function(e){if(!e||e===M.NoChange){e=this.getNavigationMode()}var t=this._getViewport();if(t){if(!ae(t)){if(e!==M.Pan&&e!==M.Zoom){e=M.Pan}}else if(ie(t)&&t._isPanoramicActivated()){if(e!==M.Turntable&&e!==M.Zoom){e=M.Turntable}}}this.setProperty("navigationMode",e,true);var i=[M.Turntable,M.Orbit,M.Pan,M.Zoom].indexOf(e);this._gestureButtons.forEach(function(e,t){e.setPressed(t===i)});if(t!=null&&!t.isA("sap.ui.vk.pdf.Viewport")){if(!this._cameraHandler||this._cameraHandler.getViewport()!==t){this._cameraHandler=new ue(t,this);t._loco?.addHandler(this._cameraHandler,0)}this._cameraHandler._mode=i}};Y.prototype._getToolbar=function(){return this._toolbar};Y.prototype._getTooltip=function(){return y().getText(this.getExpanded()?"COLLAPSE_TOOLTIP":"EXPAND_TOOLTIP")};Y.prototype._updateTooltip=function(e){e.setTooltip(this._getTooltip())};Y.prototype._toggleExpanded=function(){var e=!this.getExpanded();this.setExpanded(e);this.fireExpanded({expand:e})};Y.prototype.setExpanded=function(e){this.setProperty("expanded",e,true);var t=this.getDomRef();if(t){if(!e){t.classList.add("drawerToolbarCollapsed");t.classList.remove("drawerToolbarExpanded");this._container.addStyleClass("vboxCollapsed")}else{t.classList.add("drawerToolbarExpanded");t.classList.remove("drawerToolbarCollapsed");this._container.removeStyleClass("vboxCollapsed")}}return this};Y.prototype._onViewActivated=function(e,t,i){if(i&&i.view&&i.source&&i.source===this._getViewport()){this.invalidate()}};Y.prototype._onReadyForAnimation=function(e,t,i){var n=this._getViewport();if(i?.view&&i.source&&i.source===n?._getViewStateManagerThreeJS?.()){this.invalidate()}};Y.prototype.onBeforeRendering=function(){var e=this._getViewport();this._container.setVisible(!!e);if(e){var t=ae(e);var i=ie(e)&&e._isPanoramicActivated();var n=se(e);var s=oe(e);this._ignoreVisibilityChange=true;this._itemsShowHideSelect.forEach(function(e){e.setVisible(!n&&!s&&this._itemsVisibility.get(e))}.bind(this));this._itemTurntable.setVisible(t&&this._itemsVisibility.get(this._itemTurntable));this._itemPan.setVisible(!i&&!s&&this._itemsVisibility.get(this._itemPan));this._items3D.forEach(function(e){e.setVisible(t&&!i&&this._itemsVisibility.get(e))}.bind(this));this._pdfItems.forEach(e=>{e.setVisible(s&&this._itemsVisibility.get(e))});this._notPdfItems.forEach(e=>{e.setVisible(!s&&this._itemsVisibility.get(e))});this._ignoreVisibilityChange=false;if(t&&!i){this._crossSectionTool=this._crossSectionTool||new x;e.addTool(this._crossSectionTool)}this.setNavigationMode(M.NoChange)}};Y.prototype.setPageNavigationEnabled=function(e){this._previousPageButton.setEnabled(e);this._currentPageIndexInput.setEnabled(e);this._nextPageButton.setEnabled(e)};return Y});
//# sourceMappingURL=DrawerToolbar.js.map