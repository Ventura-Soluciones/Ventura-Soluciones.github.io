/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log", "sap/ui/core/Lib", "sap/ui/core/UIComponent", "sap/ui/core/cache/CacheManager", "sap/ui/core/mvc/View", "sap/ui/core/mvc/ViewType", "sap/ui/model/json/JSONModel", "sap/ui/model/resource/ResourceModel"], function (Log, Lib, UIComponent, CacheManager, View, ViewType, JSONModel, i18nModel) {
  "use strict";

  function _inheritsLoose(t, o) { t.prototype = Object.create(o.prototype), t.prototype.constructor = t, _setPrototypeOf(t, o); }
  function _setPrototypeOf(t, e) { return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) { return t.__proto__ = e, t; }, _setPrototypeOf(t, e); }
  let RequestSettingsComponent = /*#__PURE__*/function (_UIComponent) {
    function RequestSettingsComponent() {
      return _UIComponent.apply(this, arguments) || this;
    }
    _inheritsLoose(RequestSettingsComponent, _UIComponent);
    var _proto = RequestSettingsComponent.prototype;
    _proto.getWaitInit = async function getWaitInit() {
      return this.waitInit;
    };
    _proto.init = async function init() {
      let resolveFunction;
      _UIComponent.prototype.init.call(this);
      this.waitInit = new Promise(resolve => {
        resolveFunction = resolve;
      });
      try {
        await Lib.load({
          name: "sap.fe.controls"
        });
      } catch (error) {
        Log.debug('"Error loading sap.fe.controls library", error');
      }
      const container = sap.ui.require("sap/ushell/Container");
      const personalizationService = await container.getServiceAsync("PersonalizationV2");
      this.model = new JSONModel({});
      this.personalizationService = personalizationService;
      this.scope = {
        clientStorageAllowed: false,
        keyCategory: personalizationService.constants.keyCategory.FIXED_KEY,
        validity: "Infinity",
        writeFrequency: personalizationService.constants.writeFrequency.LOW
      };
      this.personalizationId = {
        container: "sap.ushell.optimisticreq.personalization",
        item: "data"
      };
      const period = await this._getPersonalizedPeriod(personalizationService);
      // Remove old managecache entries via cache manager
      const timeStamp = new Date(Date.now() - period * 86400000);
      const filters = {
        olderThan: timeStamp,
        prefix: "sap.ui.model.odata.v4.managecache"
      };
      CacheManager.delWithFilters(filters);
      // Enhance user activities section with optimistic batch settings
      await this._createActivitiesSection();
      resolveFunction();
    };
    _proto._getPersonalizedPeriod = async function _getPersonalizedPeriod(personalizationService) {
      const personalizer = await personalizationService.getPersonalizer(this.personalizationId, this.scope);
      const personalizationContainer = await personalizer.getPersData();
      // Use personalization service to get/set period
      let period = personalizationContainer?.period;
      period ??= 30;
      this.model.setProperty("/period", period);
      this.model.setProperty("/oldperiod", period);
      return period;
    };
    _proto._setPersonalizedPeriod = async function _setPersonalizedPeriod(personalizationService, period) {
      const personalizer = await personalizationService.getPersonalizer(this.personalizationId, this.scope);
      return personalizer.setPersData(period);
    };
    _proto._createActivitiesSection = async function _createActivitiesSection() {
      const i18n = new i18nModel({
        bundleName: "sap.fe.plugins.managecache.comp.i18n.messagebundle"
      });
      const viewType = ViewType.XML;
      const viewSettings = {
        type: viewType,
        id: "requestCacheView",
        viewName: "sap.fe.plugins.managecache.comp.view.settings"
      };
      const container = sap.ui.require("sap/ushell/Container");
      const frameBoundExtension = await container.getServiceAsync("FrameBoundExtension");
      await frameBoundExtension.addGroupedUserSettingsEntry({
        title: i18n.getResourceBundle().getText("T_GROUP"),
        icon: "sap-icon://laptop",
        entryHelpId: "userActivitiesEntry",
        groupingId: "userActivities",
        groupingTabTitle: i18n.getResourceBundle().getText("title"),
        groupingTabHelpId: "requestCacheUserActivities-helpId",
        value: async function () {
          return Promise.resolve("Request Cache"); //check
        },
        content: async () => {
          return View.create(viewSettings).then(view => {
            view.setModel(this.model);
            view.setModel(i18n, "i18n");
            this.viewInstance = view;
            return this.viewInstance;
          });
        },
        onSave: async () => {
          const period = this.model.getProperty("/period");
          await this._setPersonalizedPeriod(this.personalizationService, {
            period: period
          });
          return this.viewInstance.getController().onSave(period);
        },
        onCancel: () => {
          return this.viewInstance.getController().onCancel();
        }
      });
    };
    return RequestSettingsComponent;
  }(UIComponent);
  return RequestSettingsComponent;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSZXF1ZXN0U2V0dGluZ3NDb21wb25lbnQiLCJfVUlDb21wb25lbnQiLCJhcHBseSIsImFyZ3VtZW50cyIsIl9pbmhlcml0c0xvb3NlIiwiX3Byb3RvIiwicHJvdG90eXBlIiwiZ2V0V2FpdEluaXQiLCJ3YWl0SW5pdCIsImluaXQiLCJyZXNvbHZlRnVuY3Rpb24iLCJjYWxsIiwiUHJvbWlzZSIsInJlc29sdmUiLCJMaWIiLCJsb2FkIiwibmFtZSIsImVycm9yIiwiTG9nIiwiZGVidWciLCJjb250YWluZXIiLCJzYXAiLCJ1aSIsInJlcXVpcmUiLCJwZXJzb25hbGl6YXRpb25TZXJ2aWNlIiwiZ2V0U2VydmljZUFzeW5jIiwibW9kZWwiLCJKU09OTW9kZWwiLCJzY29wZSIsImNsaWVudFN0b3JhZ2VBbGxvd2VkIiwia2V5Q2F0ZWdvcnkiLCJjb25zdGFudHMiLCJGSVhFRF9LRVkiLCJ2YWxpZGl0eSIsIndyaXRlRnJlcXVlbmN5IiwiTE9XIiwicGVyc29uYWxpemF0aW9uSWQiLCJpdGVtIiwicGVyaW9kIiwiX2dldFBlcnNvbmFsaXplZFBlcmlvZCIsInRpbWVTdGFtcCIsIkRhdGUiLCJub3ciLCJmaWx0ZXJzIiwib2xkZXJUaGFuIiwicHJlZml4IiwiQ2FjaGVNYW5hZ2VyIiwiZGVsV2l0aEZpbHRlcnMiLCJfY3JlYXRlQWN0aXZpdGllc1NlY3Rpb24iLCJwZXJzb25hbGl6ZXIiLCJnZXRQZXJzb25hbGl6ZXIiLCJwZXJzb25hbGl6YXRpb25Db250YWluZXIiLCJnZXRQZXJzRGF0YSIsInNldFByb3BlcnR5IiwiX3NldFBlcnNvbmFsaXplZFBlcmlvZCIsInNldFBlcnNEYXRhIiwiaTE4biIsImkxOG5Nb2RlbCIsImJ1bmRsZU5hbWUiLCJ2aWV3VHlwZSIsIlZpZXdUeXBlIiwiWE1MIiwidmlld1NldHRpbmdzIiwidHlwZSIsImlkIiwidmlld05hbWUiLCJmcmFtZUJvdW5kRXh0ZW5zaW9uIiwiYWRkR3JvdXBlZFVzZXJTZXR0aW5nc0VudHJ5IiwidGl0bGUiLCJnZXRSZXNvdXJjZUJ1bmRsZSIsImdldFRleHQiLCJpY29uIiwiZW50cnlIZWxwSWQiLCJncm91cGluZ0lkIiwiZ3JvdXBpbmdUYWJUaXRsZSIsImdyb3VwaW5nVGFiSGVscElkIiwidmFsdWUiLCJjb250ZW50IiwiVmlldyIsImNyZWF0ZSIsInRoZW4iLCJ2aWV3Iiwic2V0TW9kZWwiLCJ2aWV3SW5zdGFuY2UiLCJvblNhdmUiLCJnZXRQcm9wZXJ0eSIsImdldENvbnRyb2xsZXIiLCJvbkNhbmNlbCIsIlVJQ29tcG9uZW50Il0sInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyJDb21wb25lbnQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IExvZyBmcm9tIFwic2FwL2Jhc2UvTG9nXCI7XG5pbXBvcnQgdHlwZSBSZXNvdXJjZUJ1bmRsZSBmcm9tIFwic2FwL2Jhc2UvaTE4bi9SZXNvdXJjZUJ1bmRsZVwiO1xuaW1wb3J0IExpYiBmcm9tIFwic2FwL3VpL2NvcmUvTGliXCI7XG5pbXBvcnQgVUlDb21wb25lbnQgZnJvbSBcInNhcC91aS9jb3JlL1VJQ29tcG9uZW50XCI7XG5pbXBvcnQgQ2FjaGVNYW5hZ2VyIGZyb20gXCJzYXAvdWkvY29yZS9jYWNoZS9DYWNoZU1hbmFnZXJcIjtcbmltcG9ydCBWaWV3IGZyb20gXCJzYXAvdWkvY29yZS9tdmMvVmlld1wiO1xuaW1wb3J0IFZpZXdUeXBlIGZyb20gXCJzYXAvdWkvY29yZS9tdmMvVmlld1R5cGVcIjtcbmltcG9ydCBKU09OTW9kZWwgZnJvbSBcInNhcC91aS9tb2RlbC9qc29uL0pTT05Nb2RlbFwiO1xuaW1wb3J0IGkxOG5Nb2RlbCBmcm9tIFwic2FwL3VpL21vZGVsL3Jlc291cmNlL1Jlc291cmNlTW9kZWxcIjtcbmltcG9ydCB0eXBlIFJlcXVlc3RTZXR0aW5nc0NvbnRyb2xsZXIgZnJvbSBcIi4vY29udHJvbGxlci9zZXR0aW5ncy5jb250cm9sbGVyXCI7XG5cbmV4cG9ydCB0eXBlIFNjb3BlID0ge1xuXHR2YWxpZGl0eTogc3RyaW5nO1xuXHRrZXlDYXRlZ29yeTogc3RyaW5nO1xuXHR3cml0ZUZyZXF1ZW5jeTogc3RyaW5nO1xuXHRjbGllbnRTdG9yYWdlQWxsb3dlZDogYm9vbGVhbjtcbn07XG5leHBvcnQgdHlwZSBQZXJzb25hbGl6YXRpb25JZCA9IHtcblx0Y29udGFpbmVyOiBzdHJpbmc7XG5cdGl0ZW06IHN0cmluZztcbn07XG5leHBvcnQgdHlwZSBDdXN0b21TY29wZUNvbnN0YW50cyA9IHtcblx0Y29uc3RhbnRzOiB7XG5cdFx0a2V5Q2F0ZWdvcnk6IHtcblx0XHRcdEZJWEVEX0tFWTogc3RyaW5nO1xuXHRcdFx0R0VORVJBVEVEX0tFWTogc3RyaW5nO1xuXHRcdH07XG5cdFx0d3JpdGVGcmVxdWVuY3k6IHtcblx0XHRcdEhJR0g6IHN0cmluZztcblx0XHRcdExPVzogc3RyaW5nO1xuXHRcdH07XG5cdH07XG5cdGdldFBlcnNvbmFsaXplcjogKFxuXHRcdHBlcnNvbmFsaXphdGlvbklkOiBQZXJzb25hbGl6YXRpb25JZCxcblx0XHRzY29wZTogU2NvcGVcblx0KSA9PiBQcm9taXNlPHtcblx0XHRnZXRQZXJzRGF0YTogKCkgPT4gUHJvbWlzZTx7IHBlcmlvZDogbnVtYmVyIH0gfCB1bmRlZmluZWQ+O1xuXHRcdHNldFBlcnNEYXRhOiAoYXJnOiBvYmplY3QpID0+IFByb21pc2U8b2JqZWN0Pjtcblx0fT47XG59O1xuXG5leHBvcnQgdHlwZSBQZXJzb25hbGl6YXRpb25Db25zdGFudHMgPSB7XG5cdGtleUNhdGVnb3J5OiB7XG5cdFx0RklYRURfS0VZOiBzdHJpbmc7XG5cdFx0R0VORVJBVEVEX0tFWTogc3RyaW5nO1xuXHR9O1xuXHR3cml0ZUZyZXF1ZW5jeToge1xuXHRcdEhJR0g6IHN0cmluZztcblx0XHRMT1c6IHN0cmluZztcblx0fTtcbn07XG5cbmV4cG9ydCB0eXBlIFNoZWxsQ29udGFpbmVyID0ge1xuXHRnZXRTZXJ2aWNlQXN5bmMoYXJnOiBzdHJpbmcpOiBQcm9taXNlPEN1c3RvbVNjb3BlQ29uc3RhbnRzPjtcblx0Z2V0UmVuZGVyZXIoKToge1xuXHRcdGFkZFVzZXJQcmVmZXJlbmNlc0dyb3VwZWRFbnRyeShhcmc6IHtcblx0XHRcdG9uU2F2ZTogKCkgPT4gUHJvbWlzZTx2b2lkPjtcblx0XHRcdGdyb3VwaW5nSWQ6IHN0cmluZztcblx0XHRcdG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xuXHRcdFx0aWNvbjogc3RyaW5nO1xuXHRcdFx0Z3JvdXBpbmdUYWJIZWxwSWQ6IHN0cmluZztcblx0XHRcdHRpdGxlOiBzdHJpbmc7XG5cdFx0XHRlbnRyeUhlbHBJZDogc3RyaW5nO1xuXHRcdFx0Z3JvdXBpbmdUYWJUaXRsZTogc3RyaW5nO1xuXHRcdFx0dmFsdWU6ICgpID0+IFByb21pc2U8QXdhaXRlZDxzdHJpbmc+Pjtcblx0XHRcdGNvbnRlbnQ6ICgpID0+IFByb21pc2U8Vmlldz47XG5cdFx0fSk6IFByb21pc2U8dm9pZD47XG5cdH07XG59O1xuXG5jbGFzcyBSZXF1ZXN0U2V0dGluZ3NDb21wb25lbnQgZXh0ZW5kcyBVSUNvbXBvbmVudCB7XG5cdHZpZXdJbnN0YW5jZSE6IFZpZXc7XG5cblx0cGVyc29uYWxpemF0aW9uU2VydmljZSE6IEN1c3RvbVNjb3BlQ29uc3RhbnRzO1xuXG5cdG1vZGVsITogSlNPTk1vZGVsO1xuXG5cdHBlcnNvbmFsaXphdGlvbklkITogUGVyc29uYWxpemF0aW9uSWQ7XG5cblx0c2NvcGUhOiBTY29wZTtcblxuXHRwcml2YXRlIHdhaXRJbml0ITogUHJvbWlzZTx2b2lkPjtcblxuXHRwdWJsaWMgYXN5bmMgZ2V0V2FpdEluaXQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0cmV0dXJuIHRoaXMud2FpdEluaXQ7XG5cdH1cblxuXHRwdWJsaWMgYXN5bmMgaW5pdCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRsZXQgcmVzb2x2ZUZ1bmN0aW9uITogKCkgPT4gdm9pZDtcblx0XHRzdXBlci5pbml0KCk7XG5cdFx0dGhpcy53YWl0SW5pdCA9IG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG5cdFx0XHRyZXNvbHZlRnVuY3Rpb24gPSByZXNvbHZlO1xuXHRcdH0pO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IExpYi5sb2FkKHsgbmFtZTogXCJzYXAuZmUuY29udHJvbHNcIiB9KTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0TG9nLmRlYnVnKCdcIkVycm9yIGxvYWRpbmcgc2FwLmZlLmNvbnRyb2xzIGxpYnJhcnlcIiwgZXJyb3InKTtcblx0XHR9XG5cdFx0Y29uc3QgY29udGFpbmVyID0gc2FwLnVpLnJlcXVpcmUoXCJzYXAvdXNoZWxsL0NvbnRhaW5lclwiKSBhcyBTaGVsbENvbnRhaW5lcjtcblx0XHRjb25zdCBwZXJzb25hbGl6YXRpb25TZXJ2aWNlID0gKGF3YWl0IGNvbnRhaW5lci5nZXRTZXJ2aWNlQXN5bmMoXCJQZXJzb25hbGl6YXRpb25WMlwiKSkgYXMgdW5rbm93biBhcyBDdXN0b21TY29wZUNvbnN0YW50cztcblx0XHR0aGlzLm1vZGVsID0gbmV3IEpTT05Nb2RlbCh7fSk7XG5cdFx0dGhpcy5wZXJzb25hbGl6YXRpb25TZXJ2aWNlID0gcGVyc29uYWxpemF0aW9uU2VydmljZTtcblx0XHR0aGlzLnNjb3BlID0ge1xuXHRcdFx0Y2xpZW50U3RvcmFnZUFsbG93ZWQ6IGZhbHNlLFxuXHRcdFx0a2V5Q2F0ZWdvcnk6IChwZXJzb25hbGl6YXRpb25TZXJ2aWNlLmNvbnN0YW50cyBhcyBQZXJzb25hbGl6YXRpb25Db25zdGFudHMpLmtleUNhdGVnb3J5LkZJWEVEX0tFWSxcblx0XHRcdHZhbGlkaXR5OiBcIkluZmluaXR5XCIsXG5cdFx0XHR3cml0ZUZyZXF1ZW5jeTogKHBlcnNvbmFsaXphdGlvblNlcnZpY2UuY29uc3RhbnRzIGFzIFBlcnNvbmFsaXphdGlvbkNvbnN0YW50cykud3JpdGVGcmVxdWVuY3kuTE9XXG5cdFx0fTtcblx0XHR0aGlzLnBlcnNvbmFsaXphdGlvbklkID0ge1xuXHRcdFx0Y29udGFpbmVyOiBcInNhcC51c2hlbGwub3B0aW1pc3RpY3JlcS5wZXJzb25hbGl6YXRpb25cIixcblx0XHRcdGl0ZW06IFwiZGF0YVwiXG5cdFx0fTtcblx0XHRjb25zdCBwZXJpb2QgPSBhd2FpdCB0aGlzLl9nZXRQZXJzb25hbGl6ZWRQZXJpb2QocGVyc29uYWxpemF0aW9uU2VydmljZSk7XG5cdFx0Ly8gUmVtb3ZlIG9sZCBtYW5hZ2VjYWNoZSBlbnRyaWVzIHZpYSBjYWNoZSBtYW5hZ2VyXG5cdFx0Y29uc3QgdGltZVN0YW1wID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIHBlcmlvZCAqIDg2NDAwMDAwKTtcblx0XHRjb25zdCBmaWx0ZXJzOiB7IG9sZGVyVGhhbjogRGF0ZTsgcHJlZml4OiBzdHJpbmcgfSA9IHtcblx0XHRcdG9sZGVyVGhhbjogdGltZVN0YW1wLFxuXHRcdFx0cHJlZml4OiBcInNhcC51aS5tb2RlbC5vZGF0YS52NC5tYW5hZ2VjYWNoZVwiXG5cdFx0fTtcblx0XHRDYWNoZU1hbmFnZXIuZGVsV2l0aEZpbHRlcnMoZmlsdGVycyk7XG5cdFx0Ly8gRW5oYW5jZSB1c2VyIGFjdGl2aXRpZXMgc2VjdGlvbiB3aXRoIG9wdGltaXN0aWMgYmF0Y2ggc2V0dGluZ3Ncblx0XHRhd2FpdCB0aGlzLl9jcmVhdGVBY3Rpdml0aWVzU2VjdGlvbigpO1xuXHRcdHJlc29sdmVGdW5jdGlvbigpO1xuXHR9XG5cblx0YXN5bmMgX2dldFBlcnNvbmFsaXplZFBlcmlvZChwZXJzb25hbGl6YXRpb25TZXJ2aWNlOiBDdXN0b21TY29wZUNvbnN0YW50cyk6IFByb21pc2U8bnVtYmVyPiB7XG5cdFx0Y29uc3QgcGVyc29uYWxpemVyID0gYXdhaXQgcGVyc29uYWxpemF0aW9uU2VydmljZS5nZXRQZXJzb25hbGl6ZXIodGhpcy5wZXJzb25hbGl6YXRpb25JZCwgdGhpcy5zY29wZSk7XG5cdFx0Y29uc3QgcGVyc29uYWxpemF0aW9uQ29udGFpbmVyID0gYXdhaXQgcGVyc29uYWxpemVyLmdldFBlcnNEYXRhKCk7XG5cdFx0Ly8gVXNlIHBlcnNvbmFsaXphdGlvbiBzZXJ2aWNlIHRvIGdldC9zZXQgcGVyaW9kXG5cdFx0bGV0IHBlcmlvZCA9IHBlcnNvbmFsaXphdGlvbkNvbnRhaW5lcj8ucGVyaW9kO1xuXHRcdHBlcmlvZCA/Pz0gMzA7XG5cdFx0dGhpcy5tb2RlbC5zZXRQcm9wZXJ0eShcIi9wZXJpb2RcIiwgcGVyaW9kKTtcblx0XHR0aGlzLm1vZGVsLnNldFByb3BlcnR5KFwiL29sZHBlcmlvZFwiLCBwZXJpb2QpO1xuXHRcdHJldHVybiBwZXJpb2Q7XG5cdH1cblxuXHRhc3luYyBfc2V0UGVyc29uYWxpemVkUGVyaW9kKHBlcnNvbmFsaXphdGlvblNlcnZpY2U6IEN1c3RvbVNjb3BlQ29uc3RhbnRzLCBwZXJpb2Q6IHsgcGVyaW9kOiBudW1iZXIgfSk6IFByb21pc2U8b2JqZWN0PiB7XG5cdFx0Y29uc3QgcGVyc29uYWxpemVyID0gYXdhaXQgcGVyc29uYWxpemF0aW9uU2VydmljZS5nZXRQZXJzb25hbGl6ZXIodGhpcy5wZXJzb25hbGl6YXRpb25JZCwgdGhpcy5zY29wZSk7XG5cdFx0cmV0dXJuIHBlcnNvbmFsaXplci5zZXRQZXJzRGF0YShwZXJpb2QpO1xuXHR9XG5cblx0YXN5bmMgX2NyZWF0ZUFjdGl2aXRpZXNTZWN0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGkxOG4gPSBuZXcgaTE4bk1vZGVsKHsgYnVuZGxlTmFtZTogXCJzYXAuZmUucGx1Z2lucy5tYW5hZ2VjYWNoZS5jb21wLmkxOG4ubWVzc2FnZWJ1bmRsZVwiIH0pO1xuXHRcdGNvbnN0IHZpZXdUeXBlID0gVmlld1R5cGUuWE1MO1xuXHRcdGNvbnN0IHZpZXdTZXR0aW5ncyA9IHtcblx0XHRcdHR5cGU6IHZpZXdUeXBlLFxuXHRcdFx0aWQ6IFwicmVxdWVzdENhY2hlVmlld1wiLFxuXHRcdFx0dmlld05hbWU6IFwic2FwLmZlLnBsdWdpbnMubWFuYWdlY2FjaGUuY29tcC52aWV3LnNldHRpbmdzXCJcblx0XHR9O1xuXHRcdGNvbnN0IGNvbnRhaW5lciA9IHNhcC51aS5yZXF1aXJlKFwic2FwL3VzaGVsbC9Db250YWluZXJcIikgYXMgU2hlbGxDb250YWluZXI7XG5cdFx0Y29uc3QgZnJhbWVCb3VuZEV4dGVuc2lvbiA9IChhd2FpdCBjb250YWluZXIuZ2V0U2VydmljZUFzeW5jKFwiRnJhbWVCb3VuZEV4dGVuc2lvblwiKSkgYXMgdW5rbm93biBhcyB7XG5cdFx0XHRhZGRHcm91cGVkVXNlclNldHRpbmdzRW50cnk6IChzZXR0aW5nczogdW5rbm93bikgPT4gUHJvbWlzZTx2b2lkPjtcblx0XHR9O1xuXHRcdGF3YWl0IGZyYW1lQm91bmRFeHRlbnNpb24uYWRkR3JvdXBlZFVzZXJTZXR0aW5nc0VudHJ5KHtcblx0XHRcdHRpdGxlOiAoaTE4bi5nZXRSZXNvdXJjZUJ1bmRsZSgpIGFzIFJlc291cmNlQnVuZGxlKS5nZXRUZXh0KFwiVF9HUk9VUFwiKSxcblx0XHRcdGljb246IFwic2FwLWljb246Ly9sYXB0b3BcIixcblx0XHRcdGVudHJ5SGVscElkOiBcInVzZXJBY3Rpdml0aWVzRW50cnlcIixcblx0XHRcdGdyb3VwaW5nSWQ6IFwidXNlckFjdGl2aXRpZXNcIixcblx0XHRcdGdyb3VwaW5nVGFiVGl0bGU6IChpMThuLmdldFJlc291cmNlQnVuZGxlKCkgYXMgUmVzb3VyY2VCdW5kbGUpLmdldFRleHQoXCJ0aXRsZVwiKSxcblx0XHRcdGdyb3VwaW5nVGFiSGVscElkOiBcInJlcXVlc3RDYWNoZVVzZXJBY3Rpdml0aWVzLWhlbHBJZFwiLFxuXHRcdFx0dmFsdWU6IGFzeW5jIGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZShcIlJlcXVlc3QgQ2FjaGVcIik7IC8vY2hlY2tcblx0XHRcdH0sXG5cdFx0XHRjb250ZW50OiBhc3luYyAoKSA9PiB7XG5cdFx0XHRcdHJldHVybiBWaWV3LmNyZWF0ZSh2aWV3U2V0dGluZ3MpLnRoZW4oKHZpZXc6IFZpZXcpID0+IHtcblx0XHRcdFx0XHR2aWV3LnNldE1vZGVsKHRoaXMubW9kZWwpO1xuXHRcdFx0XHRcdHZpZXcuc2V0TW9kZWwoaTE4biwgXCJpMThuXCIpO1xuXHRcdFx0XHRcdHRoaXMudmlld0luc3RhbmNlID0gdmlldztcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy52aWV3SW5zdGFuY2U7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSxcblx0XHRcdG9uU2F2ZTogYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBwZXJpb2QgPSB0aGlzLm1vZGVsLmdldFByb3BlcnR5KFwiL3BlcmlvZFwiKSBhcyB1bmtub3duIGFzIG51bWJlcjtcblx0XHRcdFx0YXdhaXQgdGhpcy5fc2V0UGVyc29uYWxpemVkUGVyaW9kKHRoaXMucGVyc29uYWxpemF0aW9uU2VydmljZSwgeyBwZXJpb2Q6IHBlcmlvZCB9KTtcblx0XHRcdFx0cmV0dXJuICh0aGlzLnZpZXdJbnN0YW5jZS5nZXRDb250cm9sbGVyKCkgYXMgUmVxdWVzdFNldHRpbmdzQ29udHJvbGxlcikub25TYXZlKHBlcmlvZCk7XG5cdFx0XHR9LFxuXHRcdFx0b25DYW5jZWw6ICgpID0+IHtcblx0XHRcdFx0cmV0dXJuICh0aGlzLnZpZXdJbnN0YW5jZS5nZXRDb250cm9sbGVyKCkgYXMgUmVxdWVzdFNldHRpbmdzQ29udHJvbGxlcikub25DYW5jZWwoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufVxuZXhwb3J0IGRlZmF1bHQgUmVxdWVzdFNldHRpbmdzQ29tcG9uZW50O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7TUFzRU1BLHdCQUF3QiwwQkFBQUMsWUFBQTtJQUFBLFNBQUFELHlCQUFBO01BQUEsT0FBQUMsWUFBQSxDQUFBQyxLQUFBLE9BQUFDLFNBQUE7SUFBQTtJQUFBQyxjQUFBLENBQUFKLHdCQUFBLEVBQUFDLFlBQUE7SUFBQSxJQUFBSSxNQUFBLEdBQUFMLHdCQUFBLENBQUFNLFNBQUE7SUFBQUQsTUFBQSxDQWFoQkUsV0FBVyxHQUF4QixlQUFhQSxXQUFXQSxDQUFBLEVBQWtCO01BQ3pDLE9BQU8sSUFBSSxDQUFDQyxRQUFRO0lBQ3JC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