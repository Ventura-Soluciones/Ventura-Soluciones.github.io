{"version":3,"file":"FavAppPanel.js","names":["sap","ui","define","Log","GridContainer","GridContainerSettings","Button","ColorPalette","ColorPalettePopover","CustomListItem","Dialog","HBox","IllustratedMessage","IllustratedMessageSize","IllustratedMessageType","Input","Label","List","MessageBox","MessageStrip","MessageToast","NavContainer","ObjectIdentifier","Page","Popover","ScrollContainer","SearchField","StandardListItem","Text","Title","Toolbar","ToolbarSpacer","VBox","sap_m_library","Event","Element","EventBus","Icon","sap_ui_core_library","MessageType","Parameters","SimpleForm","sap_ui_layout_library","Config","Container","MyHomeImport","PageRuntime","___BaseApp","__BaseAppPersPanel","__Group","__MenuItem","___utils_Accessibility","___utils_Constants","___utils_DataFormatUtils","___utils_FESRUtil","___utils_InsightsUtils","_interopRequireDefault","obj","__esModule","default","_iteratorSymbol","Symbol","iterator","_settle","pact","state","value","s","_Pact","v","o","bind","then","observer","prototype","onFulfilled","onRejected","result","this","callback","e","_this","_isSettledPact","thenable","_forTo","array","body","check","i","reject","_cycle","length","ButtonType","_forOf","target","step","next","done","return","_fixup","TypeError","values","push","ListType","_catch","recover","PlacementType","_finallyRethrows","finalizer","dnd","form","ActionsPopover","BaseAppPersPanel","Group","MenuItem","checkPanelExists","DEFAULT_BG_COLOR","END_USER_COLORS","MYAPPS_SECTION_ID","MYHOME_PAGE_ID","getLeanURL","recycleId","addFESRId","addFESRSemanticStepName","sortMenuItems","_showAddApps","last","favouritesMenuItems","tilesPanelName","insightsConatinerlName","sortedMenuItems","CREATE_GROUP","ADD_APPS","ADD_FROM_INSIGHTS","FavAppPanel","extend","metadata","library","defaultAggregation","aggregations","apps","type","singularName","multiple","visibility","groups","constructor","_constructor","id","settings","BaseAppPersPanel.prototype.constructor.call","_selectedApps","_isInitialLoad","_updateAppColorPersonalization","personalizations","updateConfig","visualization","color","appId","oldAppId","persConfig","sourceGroupId","sectionId","isSourceGroupDefault","isDefaultSection","personalizationIndex","_getPersonalizationIndex","isRecentlyAddedApp","BGColor","isSection","init","_init","_this2","BaseAppPersPanel.prototype.init.call","setProperty","_i18nBundle","getText","_createActionButtons","_createHeaderMenuItems","appsWrapper","_generateAppsWrapper","addDragDropConfigTo","event","_onFavItemDrop","_handleKeyboardMoveApp","DropPosition","OnOrBetween","oEventBus","getInstance","subscribe","sChannelId","sEventId","oData","aSections","groupsPersInfo","groupInfo","Promise","resolve","addAppsAndSections","_importdone","getParent","_refreshAllPanels","setImportButtonVisibility","attachPersistDialog","_selectedGroupId","_showGroupDetailDialog","document","addEventListener","_resetCutElement","stateData","status","publish","_addAppsAndSections","sections","importedPersonalizations","_this3","aPromise","_getAppPersonalization","aPersonalization","getServiceAsync","pagesService","_temp4","setFavAppsPersonalization","reduce","chain","current","updateDefaultSectionPersonalization","_temp3","section","sectionViz","visualizations","_temp2","_temp","filteredPersonalizations","filterPersonalizations","concat","addSectionViz","appManagerInstance","_getSections","sNewSectionId","_generateId","addSection","sectionIndex","sectionProperties","title","visible","map","oViz","_filterPersonalizations","newSectionId","aAuthPers","oPers","aSectionViz","find","oSectionViz","targetURL","_updateDefaultSectionPersonalization","_this4","defaultSection","oSection","forEach","_addSectionViz","sectionsViz","sSectionId","_this5","promiseChain","_addVisualization","loadApps","_loadApps","_this6","fetchFavVizs","favoriteVisualizations","destroyAggregation","groupVisualizations","filter","groupVisualization","menuItems","_getGroupActions","_generateGroups","_setGroups","appVisualizations","appVisualization","index","_getAppActions","undefined","generateApps","setApps","_setGroupDetailDialogApps","container","toggleMenuListItem","_createGroupMenuItem","getApps","_switchToRecommendedIfNoFavApps","_createAddFromInsTilesMenuItem","_updateContainerHeader","_this7","_temp6","_temp5","load","menuItemId","getId","_controlMap","get","addInsightsMenuItem","icon","press","_handleAddFromInsights","_menuItems","addAggregation","_sortMenuItems","set","panelMenuItems","getAggregation","removeAllAggregation","menuItem","bgColor","key","group","number","badge","groupId","_handleGroupPress","oMenuItem","getGroupId","isUngroupedApp","appActions","selectColorMenuItem","getKey","Navigation","_openColorPopover","_getAllowedMoveGroups","moveToMenuItem","_openMoveToGroupPopover","createGroupMenuItem","source","getSource","app","_openCreateGroupDialog","removeFromMyHomeMenuItem","_handleRemove","removeFromGroupMenuItem","_handleMoveToGroup","renameGroupMenuItem","_onRenameGroup","removeAllAppsMenuItem","_handleUngroupApps","groupActions","isPresetSection","deleteGroupMenuItem","_onDeleteGroup","_this8","_actionButtons","addAppsBtn","tooltip","text","navigateToAppFinder","actionButton","_validateAppsMigration","isImportEnabled","_createImportButton","_importButton","_openImportAppsDialog","insertAggregation","_setImportButtonVisibility","bVisible","_this9","setImportEnabled","setVisible","addAppsMenuItem","item","_getDragDropInfo","appGroupId","_this10","dragTile","getParameter","dropTile","dropPosition","dropControl","dragItemIndex","indexOfItem","dropItemIndex","dragItem","_getTileItem","dropItem","dragDropInfo","_temp9","_temp8","isA","_adjustAppDragDropInfo","_temp7","_adjustGroupDragDropInfo","_this11","isUpdated","dragApp","dropApp","all","getVisualization","getUrl","_ref","dragVisualization","dropVisualization","RelativeDropPosition","Before","After","tile","getItems","tileGroupId","data","_getGroup","_this12","dropGroupIndex","findIndex","lastGroupIndex","_this13","_temp12","removeStyleClass","_temp11","On","_handleOnItemDrop","refresh","_temp10","_setBusy","_handleItemsReorder","_this14","_temp13","targetGroupId","_this15","isDragItemGroup","isDropItemGroup","_temp15","drapApp","_ref2","moveVisualization","sourceSectionIndex","sourceVisualizationIndex","visualizationIndex","targetSectionIndex","targetVisualizationIndex","_temp14","moveSection","_navigateToAppFinder","navigationService","navigationObject","pageID","sectionID","navigate","shellHash","JSON","stringify","error","warning","Error","message","pageRuntime","onImportDialogPress","skipAppsSelection","arguments","createGroupDialog","_generateCreateGroupDialog","destroyItems","tiles","appCopy","clone","_onPress","_highlightApp","_getAppTile","_setAggregation","fireEvent","_updateSelectedAppCount","open","_closeCreateGroupDialog","close","_resetCreateGroupDialog","navContainer","_generateCreateGroupNavContainer","groupNameInput","searchField","setValue","to","getInitialPage","_setNoAppsSelectedError","_selectedGroupColor","_toggleNavButton","nextBtn","backBtn","createBtn","currentPageIndex","indexOfPage","getCurrentPage","getPages","_validateGroupName","_generateCreateGroupAppsPage","_highlightSelectedApps","back","_onPressGroupCreate","content","escapeHandler","contentHeight","contentWidth","buttons","addStyleClass","selectedApp","oTile","bIsSelected","hasStyleClass","oScrollContainer","_generateAppsScrollContainer","splice","oApp","toggleStyleClass","setHeight","layout","columnSize","gap","vertical","height","oAppsCountContol","setText","initialPage","pages","_generateCreateGroupMainPage","width","required","liveChange","showHeader","enableScrolling","backgroundDesign","items","SimpleFormLayout","ResponsiveGridLayout","labelSpanS","labelSpanM","colors","oColor","colorSelect","_onColorSelect","_onCreateAppSearch","showIcon","_generateCreateGroupErrorMsg","illustrationSize","Base","description","_getLegendColor","messageStrip","groupName","getValue","trim","setValueState","setValueStateText","selectedApps","tilesContainer","some","searchQuery","searchExpression","RegExp","test","getHeader","filteredTiles","getVisible","hasFilteredApps","_this16","_temp18","_temp17","_temp16","_createGroup","groupColor","_getGroupColor","show","of","offset","err","_wasThrown","_result","params","_this17","getSectionVisualizations","sectionVisualizations","selectedVisualizations","sectionVisualization","url","viz","visualizationsToBeDeleted","duplicateVisualizationIds","duplicateApps","removeVisualizations","vizIds","_updateAppPersonalization","_updateGroupPersonalization","defaultColor","firstApp","setDefaultColor","getBgColor","colorPopoverId","_currentItem","colorPopover","showDefaultColorButton","showMoreColorsButton","showRecentColorsSection","_closeActionsPopover","selectedColor","_handleColorSelect","_oPopover","setPlacement","HorizontalPreferredRight","openBy","_this18","_temp20","isGroupedApp","_refreshGroupDetailDialog","_applyUngroupedTileColor","_temp19","groupIconControl","setColor","allowedMoveGroups","allowedMoveGroup","busy","_generateGroupDetailDialog","_generateAddFromInsightsDialog","oControl","setBusy","BaseAppPersPanel.prototype.setBusy.call","sourceGroup","popoverId","list","moveToGroupPopover","itemPress","placement","removeAllItems","targetGroup","addItem","getTitle","_this19","lastAppInGroup","actionText","messageIcon","QUESTION","WARNING","actions","Action","CANCEL","emphasizedAction","onClose","action","_temp22","_temp21","_removeApp","_closeGroupDetailDialog","_wasThrown2","_result2","_this20","_temp24","_deleteGroup","_temp23","_deletePersonalization","_this21","isLastAppInGroup","_temp25","confirmationMessage","confirmationTitle","_moveAppAndHandleGroupChanges","_this22","sTargetGroupTile","_temp28","_moveAppToGroup","_temp27","sMsg","_temp26","_wasThrown3","_result3","updatedApp","isRemove","groupApps","updatedAppIndex","groupApp","destroy","setBackgroundColor","_this23","_ref3","sourceVisualization","isTargetGroupDefault","_temp33","_temp32","_temp31","_moveAppToDefaultGroup","_temp30","_temp29","_removeDuplicateVisualizations","_this24","_temp34","_this25","vizIdsToBeDeleted","_temp35","_ungroupApps","_this26","deleteAction","moveAppAction","_temp36","_this27","_temp39","updatedSections","_temp38","_temp37","preset","_wasThrown4","_result4","editMode","_this28","dialog","name","_setGroupNameControl","_this29","_temp40","_applyGroupedAppsPersonalization","_dispatchAppsLoadedEvent","_applyTilesPersonalization","src","size","oGroupNameInput","onsapfocusleave","_onGroupEditName","endButton","customHeader","oPopover","groupDetailDialog","destroyApps","updatedTitle","_this30","_temp42","oldTitle","_temp41","_renameGroup","pageIndex","getPageIndex","getModel","getProperty","groupIndex","_temp43","renameSection","groupTitle","groupTitleControl","groupInputControl","setInitialFocus","setAddBtnEnabled","selectedItems","_getSelectedInsights","setEnabled","getAppFinderBtn","btnType","appsAppFinder","_closeAddFromInsightsDialog","Default","mode","selectionChange","_addFromInsights","enabled","addStaticTiles","wrapping","justifyContent","alignItems","Transparent","_this31","_getInsightTilesToAdd","appsToAdd","_generateInsightListItems","listItems","backgroundColor","subtitle","vizId","_this32","fetchInsightApps","_ref4","insightsApps","favoriteApps","insightsApp","isCount","isSmartBusinessTile","iAppIndex","favoriteApp","_filterDuplicateVizs","removeSelections","getSelectedItems","_this33","_temp45","_temp44","selectedItem","addVisualization","updateConfigs","_this34","_updateMoveAppPersonalization","sourcePersonalizationIndex","newPersonalization","iTargetPersonalizationIndex","_this35","updatedPersonalization","appPersonalization","personalization","isBookmark","addBookMark","_this36","_temp46","deleteSection","personalizationConfig","_this37","_this38","currentItem","closestTo","firstElementChild","_temp48","metaKey","ctrlKey","_cutApp","$","css","_oMoreIcon","_temp47","dragDropEvent","draggedControl","droppedControl","appsWrapperId","includes","generateIllustratedMessage","_generateIllustratedMessage","illustratedMessage","BaseAppPersPanel.prototype.generateIllustratedMessage.call","setDescription","setIllustrationSize","Small","setIllustrationType","AddingColumns","addAdditionalContent"],"sources":["FavAppPanel.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\n\nimport Log from \"sap/base/Log\";\nimport GridContainer from \"sap/f/GridContainer\";\nimport GridContainerSettings from \"sap/f/GridContainerSettings\";\nimport Button from \"sap/m/Button\";\nimport ColorPalette, { ColorPalette$ColorSelectEvent } from \"sap/m/ColorPalette\";\nimport ColorPalettePopover from \"sap/m/ColorPalettePopover\";\nimport CustomListItem from \"sap/m/CustomListItem\";\nimport Dialog from \"sap/m/Dialog\";\nimport GenericTile from \"sap/m/GenericTile\";\nimport HBox from \"sap/m/HBox\";\nimport IllustratedMessage from \"sap/m/IllustratedMessage\";\nimport IllustratedMessageSize from \"sap/m/IllustratedMessageSize\";\nimport IllustratedMessageType from \"sap/m/IllustratedMessageType\";\nimport Input from \"sap/m/Input\";\nimport Label from \"sap/m/Label\";\nimport List from \"sap/m/List\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport MessageStrip from \"sap/m/MessageStrip\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport NavContainer from \"sap/m/NavContainer\";\nimport ObjectIdentifier from \"sap/m/ObjectIdentifier\";\nimport Page from \"sap/m/Page\";\nimport Popover from \"sap/m/Popover\";\nimport ScrollContainer from \"sap/m/ScrollContainer\";\nimport SearchField from \"sap/m/SearchField\";\nimport StandardListItem from \"sap/m/StandardListItem\";\nimport Text from \"sap/m/Text\";\nimport Title from \"sap/m/Title\";\nimport Toolbar from \"sap/m/Toolbar\";\nimport ToolbarSpacer from \"sap/m/ToolbarSpacer\";\nimport VBox from \"sap/m/VBox\";\nimport { ButtonType, ListType, PlacementType } from \"sap/m/library\";\nimport Event from \"sap/ui/base/Event\";\nimport { MetadataOptions } from \"sap/ui/base/ManagedObject\";\nimport Control from \"sap/ui/core/Control\";\nimport Element from \"sap/ui/core/Element\";\nimport EventBus from \"sap/ui/core/EventBus\";\nimport Icon from \"sap/ui/core/Icon\";\nimport { DropInfo$DropEventParameters } from \"sap/ui/core/dnd/DropInfo\";\nimport { dnd } from \"sap/ui/core/library\";\nimport MessageType from \"sap/ui/core/message/MessageType\";\nimport Parameters from \"sap/ui/core/theming/Parameters\";\nimport SimpleForm from \"sap/ui/layout/form/SimpleForm\";\nimport { form } from \"sap/ui/layout/library\";\nimport Config from \"sap/ushell/Config\";\nimport Container from \"sap/ushell/Container\";\nimport MyHomeImport from \"sap/ushell/components/pages/MyHomeImport\";\nimport PageRuntime from \"sap/ushell/components/pages/controller/PageRuntime.controller\";\nimport Navigation from \"sap/ushell/services/Navigation\";\nimport Pages from \"sap/ushell/services/Pages\";\nimport { IExportData } from \"./AdvancedSettingsPanel\";\nimport App from \"./App\";\nimport AppsContainer from \"./AppsContainer\";\nimport { ActionsPopover } from \"./BaseApp\";\nimport BaseAppPersPanel from \"./BaseAppPersPanel\";\nimport BaseContainer from \"./BaseContainer\";\nimport type { $BasePanelSettings } from \"./BasePanel\";\nimport Group, { Group$PressEvent } from \"./Group\";\nimport MenuItem from \"./MenuItem\";\nimport {\n\tIAppPersonalization,\n\tIAppPersonalizationConfig,\n\tICustomVisualization,\n\tIDragDropInfo,\n\tISection,\n\tISectionAndVisualization,\n\tIUpdatePersonalizationConfig,\n\tIVisualization\n} from \"./interface/AppsInterface\";\nimport { checkPanelExists } from \"./utils/Accessibility\";\nimport { DEFAULT_BG_COLOR, END_USER_COLORS, MYAPPS_SECTION_ID, MYHOME_PAGE_ID } from \"./utils/Constants\";\nimport { getLeanURL, recycleId } from \"./utils/DataFormatUtils\";\nimport { addFESRId, addFESRSemanticStepName } from \"./utils/FESRUtil\";\nimport { sortMenuItems } from \"./utils/InsightsUtils\";\nconst _showAddApps = () => {\n\treturn (Config.last(\"/core/shell/enablePersonalization\") || Config.last(\"/core/catalog/enabled\")) as boolean;\n};\n\nexport enum favouritesMenuItems {\n\tCREATE_GROUP = \"createGrpMenuBtn\",\n\tADD_APPS = \"addAppsMenuBtn\",\n\tADD_FROM_INSIGHTS = \"addInsightsMenuBtn\"\n}\n\nconst tilesPanelName: string = \"sap.cux.home.TilesPanel\";\nconst insightsConatinerlName: string = \"sap.cux.home.InsightsContainer\";\nconst sortedMenuItems: (favouritesMenuItems | string)[] = [\n\tfavouritesMenuItems.CREATE_GROUP,\n\tfavouritesMenuItems.ADD_APPS,\n\tfavouritesMenuItems.ADD_FROM_INSIGHTS,\n\t\"settings\"\n];\n\n/**\n *\n * Provides the FavAppPanel Class.\n *\n * @extends sap.cux.home.BaseAppPersPanel\n *\n * @author SAP SE\n * @version 0.0.1\n * @since 1.121.0\n *\n * @internal\n * @experimental Since 1.121\n * @public\n *\n * @alias sap.cux.home.FavAppPanel\n */\nexport default class FavAppPanel extends BaseAppPersPanel {\n\tprivate _selectedApps: App[] = [];\n\tprivate _selectedGroupColor: string | undefined;\n\tprivate _selectedGroupId: string | undefined;\n\tprivate _currentItem!: App | Group;\n\tprivate _cutApp: GenericTile | undefined;\n\tprivate oEventBus!: EventBus;\n\tprivate _importButton!: Button;\n\tprivate _createGroupMenuItem!: MenuItem;\n\tprivate _isInitialLoad = true;\n\n\tstatic readonly metadata: MetadataOptions = {\n\t\tlibrary: \"sap.cux.home\",\n\t\tdefaultAggregation: \"apps\",\n\t\taggregations: {\n\t\t\t/**\n\t\t\t * Apps aggregation for Favorite apps\n\t\t\t */\n\t\t\tapps: { type: \"sap.cux.home.App\", singularName: \"app\", multiple: true, visibility: \"hidden\" },\n\t\t\t/**\n\t\t\t * Group aggregation for Favorite apps\n\t\t\t */\n\t\t\tgroups: { type: \"sap.cux.home.Group\", singularName: \"group\", multiple: true, visibility: \"hidden\" }\n\t\t}\n\t};\n\n\t/**\n\t * Constructor for a new favorite app panel.\n\t *\n\t * @param {string} [id] ID for the new control, generated automatically if an ID is not provided\n\t * @param {object} [settings] Initial settings for the new control\n\t */\n\tpublic constructor(id?: string, settings?: $BasePanelSettings) {\n\t\tsuper(id, settings);\n\t}\n\n\tpublic init() {\n\t\tsuper.init();\n\t\t//Configure Header\n\t\tthis.setProperty(\"key\", \"favApps\");\n\t\tthis.setProperty(\"title\", this._i18nBundle.getText(\"favoritesTab\"));\n\t\tthis.setProperty(\"tooltip\", this._i18nBundle.getText(\"favAppsInfo\"));\n\t\t//Setup Action Buttons\n\t\tvoid this._createActionButtons();\n\t\t//Setup Menu Items\n\t\tthis._createHeaderMenuItems();\n\t\t//add drag and drop config\n\t\tconst appsWrapper = this._generateAppsWrapper();\n\t\tif (appsWrapper) {\n\t\t\tthis.addDragDropConfigTo(\n\t\t\t\tappsWrapper,\n\t\t\t\t(event) => this._onFavItemDrop(event),\n\t\t\t\t(event: KeyboardEvent) => this._handleKeyboardMoveApp(event),\n\t\t\t\tdnd.DropPosition.OnOrBetween\n\t\t\t);\n\t\t}\n\n\t\tthis.oEventBus = EventBus.getInstance();\n\t\t// Subscribe to the event\n\t\tthis.oEventBus.subscribe(\n\t\t\t\"importChannel\",\n\t\t\t\"appsImport\",\n\t\t\tasync (sChannelId?: string, sEventId?: string, oData?) => {\n\t\t\t\tconst aSections = ((oData as IExportData)?.apps as ISectionAndVisualization[]) || [];\n\t\t\t\tconst groupsPersInfo = (oData as IExportData)?.groupInfo || [];\n\n\t\t\t\tawait this.addAppsAndSections(aSections, groupsPersInfo);\n\t\t\t\tthis._importdone();\n\t\t\t\tawait (this.getParent() as AppsContainer)._refreshAllPanels();\n\t\t\t},\n\t\t\tthis\n\t\t);\n\t\tthis.oEventBus.subscribe(\n\t\t\t\"importChannel\",\n\t\t\t\"resetImported\",\n\t\t\tasync () => {\n\t\t\t\tawait this.setImportButtonVisibility(true);\n\t\t\t},\n\t\t\tthis\n\t\t);\n\t\tthis.attachPersistDialog(() => {\n\t\t\t// if while navigating to different page, a group detail dialog was open, then while navigating back group detail dialog should be in open state.\n\t\t\tif (this._selectedGroupId) {\n\t\t\t\tvoid this._showGroupDetailDialog(this._selectedGroupId);\n\t\t\t}\n\t\t});\n\n\t\tdocument.addEventListener(\"click\", (event) => this._resetCutElement(event));\n\t\tdocument.addEventListener(\"keydown\", (event) => this._resetCutElement(event));\n\t}\n\n\tprivate _importdone() {\n\t\tconst stateData = { status: true };\n\t\tthis.oEventBus.publish(\"importChannel\", \"appsImported\", stateData);\n\t}\n\n\t/**\n\t * Checks and import apps and groups\n\t * @private\n\t */\n\tprivate async addAppsAndSections(sections: ISectionAndVisualization[], importedPersonalizations: IAppPersonalization[]) {\n\t\tlet aPromise: (() => Promise<void>)[] = [];\n\t\tlet aPersonalization = await this._getAppPersonalization();\n\n\t\tconst pagesService = await Container.getServiceAsync<Pages>(\"Pages\");\n\t\tfor (const section of sections) {\n\t\t\tconst sectionViz = section.visualizations as IVisualization[];\n\t\t\tif (sectionViz?.length) {\n\t\t\t\tif (section.default || section.id === MYAPPS_SECTION_ID) {\n\t\t\t\t\tconst filteredPersonalizations = this.filterPersonalizations(importedPersonalizations, section);\n\t\t\t\t\taPersonalization = aPersonalization.concat(filteredPersonalizations);\n\t\t\t\t\taPromise.push(() => {\n\t\t\t\t\t\treturn section.default ? this.addSectionViz(sectionViz) : this.addSectionViz(sectionViz, MYAPPS_SECTION_ID);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst sections = await this.appManagerInstance._getSections(true);\n\t\t\t\t\t//check if this generate id can be replaced with any exposed method\n\t\t\t\t\tconst sNewSectionId = pagesService._generateId(MYHOME_PAGE_ID);\n\t\t\t\t\tconst filteredPersonalizations = this.filterPersonalizations(importedPersonalizations, section, sNewSectionId);\n\t\t\t\t\t//update section id in personalization data\n\t\t\t\t\taPersonalization = aPersonalization.concat(filteredPersonalizations);\n\n\t\t\t\t\taPromise.push(() => {\n\t\t\t\t\t\treturn this.appManagerInstance.addSection({\n\t\t\t\t\t\t\tsectionIndex: sections.length,\n\t\t\t\t\t\t\tsectionProperties: {\n\t\t\t\t\t\t\t\tid: sNewSectionId,\n\t\t\t\t\t\t\t\ttitle: section.title,\n\t\t\t\t\t\t\t\tvisible: true,\n\t\t\t\t\t\t\t\tvisualizations: sectionViz?.map((oViz) => {\n\t\t\t\t\t\t\t\t\t//check if this generate id can be replaced with any exposed method\n\t\t\t\t\t\t\t\t\toViz.id = pagesService._generateId(MYHOME_PAGE_ID);\n\t\t\t\t\t\t\t\t\treturn oViz;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//update personalization\n\t\tawait this.setFavAppsPersonalization(aPersonalization);\n\t\treturn aPromise\n\t\t\t.reduce((chain, current) => {\n\t\t\t\treturn chain.then(() => current());\n\t\t\t}, Promise.resolve())\n\t\t\t.then(() => {\n\t\t\t\treturn this.updateDefaultSectionPersonalization(aPersonalization);\n\t\t\t});\n\t}\n\n\t/**\n\t * Filters personalization data for specific section\n\t *\n\t * @private\n\t * @param {IAppPersonalization[]} personalizations - array of user personalizations\n\t * @param {ISectionAndVisualization} section - section for which personalization data needs to be filtered\n\t * @param {String} newSectionId - new section id\n\t * @returns {IAppPersonalization[]} resolves to an array of authorized personalization for a given section\n\t */\n\tprivate filterPersonalizations(personalizations: IAppPersonalization[], section: ISectionAndVisualization, newSectionId?: string) {\n\t\t//filter personalization data based on section visualizations\n\t\tconst filteredPersonalizations = personalizations.reduce(function (aAuthPers: IAppPersonalization[], oPers: IAppPersonalization) {\n\t\t\tif (oPers.sectionId === section.id) {\n\t\t\t\tconst aSectionViz = section.visualizations;\n\t\t\t\tconst oViz = aSectionViz?.find((oSectionViz) => {\n\t\t\t\t\treturn oSectionViz.targetURL === oPers.appId;\n\t\t\t\t});\n\t\t\t\tif (oViz || oPers.isSection) {\n\t\t\t\t\toPers.sectionId = newSectionId || section.id;\n\t\t\t\t\taAuthPers.push(oPers);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn aAuthPers;\n\t\t}, []);\n\t\treturn filteredPersonalizations;\n\t}\n\n\t/**\n\t * Updates section id of recently added apps to default section in the persionalization array\n\t *\n\t * @private\n\t * @param {IAppPersonalization} aPersonalization - array of personlizations\n\t * @returns {IAppPersonalization[]} returns an array of personlizations\n\t */\n\tprivate async updateDefaultSectionPersonalization(aPersonalization: IAppPersonalization[]) {\n\t\t//update recently added app section id in personalization\n\t\tconst sections = await this.appManagerInstance._getSections(true);\n\t\tlet defaultSection = sections.find((oSection) => {\n\t\t\treturn oSection.default;\n\t\t});\n\t\tif (defaultSection) {\n\t\t\taPersonalization.forEach((oPers) => {\n\t\t\t\tif (oPers.isRecentlyAddedApp) {\n\t\t\t\t\toPers.sectionId = defaultSection.id;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn aPersonalization;\n\t}\n\n\t/**\n\t * Add section visualizations\n\t *\n\t * @param {Array} sectionsViz - array of section visualizations\n\t * @param {String} sSectionId - section id for which visualizations needs to be added\n\t * @returns {String} resolves to visualizations being added to given section\n\t */\n\tpublic async addSectionViz(sectionsViz: IVisualization[], sSectionId?: string) {\n\t\treturn sectionsViz.reduce((promiseChain, oViz: IVisualization) => {\n\t\t\treturn promiseChain.then(() => {\n\t\t\t\treturn this._addVisualization({ visualization: oViz } as ICustomVisualization, sSectionId);\n\t\t\t});\n\t\t}, Promise.resolve());\n\t}\n\n\t/**\n\t * Fetch fav apps and set apps aggregation\n\t * @private\n\t */\n\tpublic async loadApps() {\n\t\tconst favoriteVisualizations = await this.appManagerInstance.fetchFavVizs(true, false);\n\t\t//Create groups\n\t\tthis.destroyAggregation(\"groups\", true);\n\t\tconst groupVisualizations = favoriteVisualizations\n\t\t\t.filter((visualization) => visualization.isSection)\n\t\t\t.map((groupVisualization) => {\n\t\t\t\treturn {\n\t\t\t\t\t...groupVisualization,\n\t\t\t\t\tmenuItems: this._getGroupActions(groupVisualization)\n\t\t\t\t};\n\t\t\t});\n\t\tconst groups = this._generateGroups(groupVisualizations);\n\t\tthis._setGroups(groups);\n\n\t\t//Create apps\n\t\tthis.destroyAggregation(\"apps\", true);\n\t\tconst appVisualizations = favoriteVisualizations\n\t\t\t.filter((visualization) => !visualization.isSection)\n\t\t\t.map((appVisualization, index) => {\n\t\t\t\treturn {\n\t\t\t\t\t...appVisualization,\n\t\t\t\t\tmenuItems: this._getAppActions(undefined, index, appVisualization)\n\t\t\t\t};\n\t\t\t});\n\t\tconst apps = this.generateApps(appVisualizations);\n\t\tthis.setApps(apps);\n\t\tif (this._selectedGroupId) {\n\t\t\tvoid this._setGroupDetailDialogApps(this._selectedGroupId);\n\t\t}\n\t\tconst container = this.getParent() as BaseContainer;\n\t\tcontainer.toggleMenuListItem(this._createGroupMenuItem, this.getApps().length > 0);\n\t\tawait this._switchToRecommendedIfNoFavApps(apps, groups);\n\t\tif (checkPanelExists(container, insightsConatinerlName, tilesPanelName)) {\n\t\t\tthis._createAddFromInsTilesMenuItem(favouritesMenuItems.ADD_FROM_INSIGHTS);\n\t\t}\n\t\t//updating header once the visibility for createGrp menu item is set according to the no. of apps\n\t\tcontainer._updateContainerHeader(container);\n\t}\n\n\t/**\n\t * Switches to the \"recommendedApps\" tab if no favorite apps or groups exist during the initial load.\n\t * Ensures this logic runs only once.\n\t *\n\t * @private\n\t * @param {App[]} apps - The list of favorite apps.\n\t * @param {Group[]} groups - The list of favorite app groups.\n\t */\n\tprivate async _switchToRecommendedIfNoFavApps(apps: App[], groups: Group[]): Promise<void> {\n\t\tconst container = this.getParent() as BaseContainer;\n\t\tif (this._isInitialLoad && [...apps, ...groups].length === 0) {\n\t\t\tcontainer.setProperty?.(\"selectedKey\", \"recommendedApps\");\n\t\t\tawait (container as AppsContainer).load();\n\t\t}\n\t\tthis._isInitialLoad = false;\n\t}\n\n\t/**\n\t * Creates an \"Add from Insights Tiles\" menu item.\n\t *\n\t * @private\n\t * @param {string} id - The ID of the menu item.\n\t * @returns {MenuItem} The created MenuItem instance.\n\t */\n\tprivate _createAddFromInsTilesMenuItem(id: string) {\n\t\tconst menuItemId = `${this.getId()}-${id}`;\n\t\tif (!this._controlMap.get(menuItemId)) {\n\t\t\tconst addInsightsMenuItem = new MenuItem(menuItemId, {\n\t\t\t\ttitle: this._i18nBundle.getText(\"addFromInsights\"),\n\t\t\t\ticon: \"sap-icon://duplicate\",\n\t\t\t\tpress: () => void this._handleAddFromInsights()\n\t\t\t});\n\t\t\taddFESRId(addInsightsMenuItem, \"staticTilesDialog\");\n\t\t\tthis._menuItems.push(addInsightsMenuItem);\n\t\t\tthis.addAggregation(\"menuItems\", addInsightsMenuItem);\n\t\t\tthis._sortMenuItems(sortedMenuItems);\n\t\t\tthis._controlMap.set(menuItemId, addInsightsMenuItem as unknown as Control);\n\t\t}\n\t\treturn this._controlMap.get(menuItemId);\n\t}\n\n\t/**\n\t * Sorts the menu items based on the provided order.\n\t *\n\t * @private\n\t * @param {string[]} menuItems - The order of the menu items.\n\t */\n\tprivate _sortMenuItems(menuItems: string[]) {\n\t\tconst panelMenuItems = this.getAggregation(\"menuItems\") as MenuItem[];\n\t\tlet sortedMenuItems = sortMenuItems(menuItems, panelMenuItems);\n\t\tthis.removeAllAggregation(\"menuItems\");\n\t\tsortedMenuItems?.forEach((menuItem) => this.addAggregation(\"menuItems\", menuItem));\n\t}\n\n\t/**\n\t * Creates and returns group instances for given group objects\n\t * @private\n\t * @param {object[]} aGroupObject - Array of group object.\n\t * @returns {sap.cux.home.Group[]} - Array of group instances\n\t */\n\tprivate _generateGroups(groupVisualizations: ISectionAndVisualization[]): Group[] {\n\t\treturn groupVisualizations.map((groupVisualization, index) => {\n\t\t\tconst bgColor =\n\t\t\t\ttypeof groupVisualization.BGColor === \"object\" && \"key\" in groupVisualization.BGColor\n\t\t\t\t\t? groupVisualization.BGColor.key\n\t\t\t\t\t: groupVisualization.BGColor;\n\t\t\tconst group = new Group(`${this.getId()}-group-${index}`, {\n\t\t\t\ttitle: groupVisualization.title,\n\t\t\t\tbgColor: bgColor,\n\t\t\t\tstatus: groupVisualization.status,\n\t\t\t\ticon: groupVisualization.icon,\n\t\t\t\tnumber: groupVisualization.badge,\n\t\t\t\tgroupId: groupVisualization.id,\n\t\t\t\tpress: this._handleGroupPress.bind(this)\n\t\t\t});\n\t\t\tgroupVisualization.menuItems?.forEach((oMenuItem) => {\n\t\t\t\tgroup.addAggregation(\"menuItems\", oMenuItem);\n\t\t\t});\n\t\t\treturn group;\n\t\t});\n\t}\n\n\t/**\n\t * Add multiple groups in the groups aggregation.\n\t * @private\n\t * @param {sap.cux.home.Group[]} groups - Array of groups.\n\t */\n\tprivate _setGroups(groups: Group[]) {\n\t\tgroups.forEach((group) => {\n\t\t\tthis.addAggregation(\"groups\", group, true);\n\t\t});\n\t}\n\n\t/**\n\t * Returns list of actions available for app\n\t * @param {ssap.cux.home.Group} group - The group containing the app.\n\t * @private\n\t * @returns {sap.cux.home.MenuItem[]} - An array of menu items representing available actions for the app.\n\t */\n\tprivate _getAppActions(group?: Group, index?: number, appVisualization?: ICustomVisualization) {\n\t\tconst groupId = group?.getGroupId();\n\t\tconst defaultSection = appVisualization?.persConfig?.isDefaultSection;\n\t\tconst isUngroupedApp = !groupId;\n\t\tconst appActions = [];\n\t\tconst selectColorMenuItem = new MenuItem({\n\t\t\tid:\n\t\t\t\tgroupId && !defaultSection\n\t\t\t\t\t? `${groupId}--selectColorGroupAppMenuItem--${index}`\n\t\t\t\t\t: `${this.getKey()}--selectColorAppMenuItem--${index}`,\n\t\t\ttitle: this._i18nBundle.getText(\"selectColor\"),\n\t\t\ttype: ListType.Navigation,\n\t\t\tpress: this._openColorPopover.bind(this)\n\t\t});\n\t\tappActions.push(selectColorMenuItem);\n\n\t\taddFESRId(selectColorMenuItem, \"changeColor\");\n\n\t\tif (this._getAllowedMoveGroups(groupId)?.length >= 1) {\n\t\t\tconst moveToMenuItem = new MenuItem({\n\t\t\t\tid:\n\t\t\t\t\tgroupId && !defaultSection\n\t\t\t\t\t\t? `${groupId}--moveToGroupAppMenuItem--${index}`\n\t\t\t\t\t\t: `${this.getKey()}--moveToMenuItem--${index}`,\n\t\t\t\ttitle: this._i18nBundle.getText(\"moveTo\"),\n\t\t\t\ttype: ListType.Navigation,\n\t\t\t\tpress: (event) => this._openMoveToGroupPopover(event, group)\n\t\t\t});\n\t\t\tappActions.push(moveToMenuItem);\n\t\t\taddFESRId(moveToMenuItem, \"moveToGroup\");\n\t\t}\n\t\tif (isUngroupedApp) {\n\t\t\tconst createGroupMenuItem = new MenuItem(`${this.getKey()}--createGroupMenuItem--${index}`, {\n\t\t\t\ttitle: this._i18nBundle.getText(\"createGroup\"),\n\t\t\t\tpress: (event: Event) => {\n\t\t\t\t\tconst source = event.getSource<MenuItem>();\n\t\t\t\t\tconst app = source.getParent() as App;\n\t\t\t\t\tthis._selectedApps = [app];\n\t\t\t\t\tthis._openCreateGroupDialog();\n\t\t\t\t}\n\t\t\t});\n\t\t\tappActions.push(createGroupMenuItem);\n\t\t\taddFESRId(createGroupMenuItem, \"createGroupDialog\");\n\t\t}\n\t\tconst removeFromMyHomeMenuItem = new MenuItem({\n\t\t\tid:\n\t\t\t\tgroupId && !defaultSection\n\t\t\t\t\t? `${groupId}--removeFromMyHomeGroupAppMenuItem--${index}`\n\t\t\t\t\t: `${this.getKey()}--removeFromMyHomeMenuItem--${index}`,\n\t\t\ttitle: this._i18nBundle.getText(\"removeFromMyHome\"),\n\t\t\tpress: (event: Event) => {\n\t\t\t\tconst source = event.getSource<MenuItem>();\n\t\t\t\tconst app = source.getParent() as App;\n\t\t\t\tthis._handleRemove(app, group);\n\t\t\t}\n\t\t});\n\t\tappActions.push(removeFromMyHomeMenuItem);\n\t\taddFESRId(removeFromMyHomeMenuItem, \"removeFromMyHome\");\n\n\t\tif (!isUngroupedApp) {\n\t\t\tconst removeFromGroupMenuItem = new MenuItem(`${this.getKey()}--removeFromGroupMenuItem--${index}`, {\n\t\t\t\ttitle: this._i18nBundle.getText(\"removeFromGroup\"),\n\t\t\t\tpress: (event: Event) => {\n\t\t\t\t\tconst source = event.getSource<MenuItem>();\n\t\t\t\t\tconst app = source.getParent() as App;\n\t\t\t\t\tvoid this._handleMoveToGroup(app, groupId);\n\t\t\t\t}\n\t\t\t});\n\t\t\tappActions.push(removeFromGroupMenuItem);\n\t\t\taddFESRId(removeFromGroupMenuItem, \"ungroupApp\");\n\t\t}\n\n\t\treturn appActions;\n\t}\n\n\t/**\n\t * Returns list of actions available for selected group\n\t * @private\n\t * @param {sap.cux.home.Group} group - Group\n\t * @returns {sap.cux.home.MenuItem[]} - An array of menu items representing available actions for the group.\n\t */\n\tprivate _getGroupActions(group: ISectionAndVisualization) {\n\t\tconst renameGroupMenuItem = new MenuItem(`id-${group.id}-renameGroup`, {\n\t\t\ttitle: this._i18nBundle.getText(\"renameGroup\"),\n\t\t\tpress: this._onRenameGroup.bind(this)\n\t\t});\n\t\taddFESRId(renameGroupMenuItem, \"renameGroup\");\n\t\tconst selectColorMenuItem = new MenuItem(`id-${group.id}-selectColor`, {\n\t\t\ttitle: this._i18nBundle.getText(\"selectColor\"),\n\t\t\ttype: ListType.Navigation,\n\t\t\tpress: this._openColorPopover.bind(this)\n\t\t});\n\t\taddFESRId(selectColorMenuItem, \"changeColor\");\n\t\tconst removeAllAppsMenuItem = new MenuItem(`id-${group.id}-removeAllApps`, {\n\t\t\ttitle: this._i18nBundle.getText(\"removeAllApps\"),\n\t\t\tpress: this._handleUngroupApps.bind(this, group)\n\t\t});\n\t\taddFESRId(removeAllAppsMenuItem, \"removeAllApps\");\n\t\tconst groupActions = [renameGroupMenuItem, selectColorMenuItem, removeAllAppsMenuItem];\n\t\tif (!group.isPresetSection) {\n\t\t\tconst deleteGroupMenuItem = new MenuItem(`id-${group.id}-delete`, {\n\t\t\t\ttitle: this._i18nBundle.getText(\"delete\"),\n\t\t\t\tpress: this._onDeleteGroup.bind(this)\n\t\t\t});\n\t\t\taddFESRId(deleteGroupMenuItem, \"deleteGroup\");\n\t\t\tgroupActions.push(deleteGroupMenuItem);\n\t\t}\n\t\treturn groupActions;\n\t}\n\n\t/**\n\t * Creates actions buttons for panel.\n\t * @private\n\t */\n\tprivate async _createActionButtons() {\n\t\tif (!this._actionButtons) {\n\t\t\tthis._actionButtons = [];\n\t\t\tif (_showAddApps()) {\n\t\t\t\tconst addAppsBtn = new Button(`${this.getId()}-addAppsBtn`, {\n\t\t\t\t\ticon: \"sap-icon://action\",\n\t\t\t\t\ttooltip: this._i18nBundle.getText(\"addAppsTooltip\"),\n\t\t\t\t\ttext: this._i18nBundle.getText(\"addApps\"),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tvoid this.navigateToAppFinder();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\taddFESRId(addAppsBtn, \"addAppsBtn\");\n\t\t\t\tthis._actionButtons.push(addAppsBtn);\n\t\t\t}\n\t\t}\n\t\tthis._actionButtons.forEach((actionButton) => {\n\t\t\tthis.addAggregation(\"actionButtons\", actionButton);\n\t\t});\n\t\tconst isImportEnabled = await this._validateAppsMigration();\n\t\tif (isImportEnabled) {\n\t\t\tthis._createImportButton();\n\t\t}\n\t}\n\n\tprivate _createImportButton(): Button {\n\t\tif (!this._importButton) {\n\t\t\tthis._importButton = new Button(`${this.getId()}-importAppsBtn`, {\n\t\t\t\ttooltip: this._i18nBundle.getText(\"importAppsNow\"),\n\t\t\t\ttext: this._i18nBundle.getText(\"importAppsNow\"),\n\t\t\t\tpress: this._openImportAppsDialog.bind(this)\n\t\t\t});\n\t\t\taddFESRId(this._importButton, \"importAppsDialog\");\n\t\t\tthis._actionButtons.push(this._importButton);\n\t\t\tthis.insertAggregation(\"actionButtons\", this._importButton, 0);\n\t\t}\n\t\treturn this._importButton;\n\t}\n\n\tprivate async setImportButtonVisibility(bVisible: boolean): Promise<void> {\n\t\tawait MyHomeImport.setImportEnabled(bVisible);\n\t\tthis._createImportButton().setVisible(bVisible);\n\t}\n\n\t/**\n\t * Creates menu items for panel header.\n\t * @private\n\t */\n\tprivate _createHeaderMenuItems() {\n\t\tif (!this._menuItems) {\n\t\t\tthis._createGroupMenuItem = new MenuItem(`${this.getId()}-${favouritesMenuItems.CREATE_GROUP}`, {\n\t\t\t\ttitle: this._i18nBundle.getText(\"createGroup\"),\n\t\t\t\ticon: \"sap-icon://add\",\n\t\t\t\tpress: () => this._openCreateGroupDialog()\n\t\t\t});\n\t\t\tthis._menuItems = [this._createGroupMenuItem];\n\t\t\tif (_showAddApps()) {\n\t\t\t\tthis._menuItems.push(\n\t\t\t\t\tnew MenuItem(`${this.getId()}-${favouritesMenuItems.ADD_APPS}`, {\n\t\t\t\t\t\ttitle: this._i18nBundle.getText(\"addApps\"),\n\t\t\t\t\t\ticon: \"sap-icon://action\",\n\t\t\t\t\t\tpress: () => {\n\t\t\t\t\t\t\tvoid this.navigateToAppFinder();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\t// Assign FESR IDs based on menu items\n\t\t\taddFESRId(this._createGroupMenuItem, \"createGroupDialog\");\n\t\t\tconst addAppsMenuItem = this._menuItems.find((item) => item.getId() === `${this.getId()}-${favouritesMenuItems.ADD_APPS}`);\n\t\t\tif (addAppsMenuItem) {\n\t\t\t\taddFESRId(addAppsMenuItem, \"appsAppFinder\");\n\t\t\t}\n\t\t\tthis._menuItems.forEach((oMenuItem) => {\n\t\t\t\tthis.addAggregation(\"menuItems\", oMenuItem, true);\n\t\t\t});\n\t\t\tthis._sortMenuItems(sortedMenuItems);\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves drag and drop information from the given event.\n\t * @private\n\t * @param {Event<DropInfo$DropEventParameters>} event - The event containing drag and drop information.\n\t * @returns {Promise<IDragDropInfo>} The drag and drop information.\n\t */\n\tprivate async _getDragDropInfo(event: Event<DropInfo$DropEventParameters>, appGroupId?: string) {\n\t\tconst dragTile = event.getParameter?.(\"draggedControl\") as GenericTile,\n\t\t\tdropTile = event.getParameter?.(\"droppedControl\") as GenericTile,\n\t\t\tdropPosition = event.getParameter?.(\"dropPosition\"),\n\t\t\tdropControl = dragTile.getParent() as GridContainer,\n\t\t\tdragItemIndex = dropControl.indexOfItem(dragTile),\n\t\t\tdropItemIndex = dropControl.indexOfItem(dropTile),\n\t\t\tdragItem = this._getTileItem(dragTile, appGroupId),\n\t\t\tdropItem = this._getTileItem(dropTile, appGroupId);\n\n\t\tconst dragDropInfo: IDragDropInfo = {\n\t\t\tdragItem: dragItem!,\n\t\t\tdropItem: dropItem!,\n\t\t\tdropPosition: dropPosition as dnd.RelativeDropPosition,\n\t\t\tdropControl,\n\t\t\tdragItemIndex,\n\t\t\tdropItemIndex\n\t\t};\n\t\t//adjust drap drop info\n\t\tif (dragItemIndex !== dropItemIndex) {\n\t\t\tif (!dragItem?.isA(\"sap.cux.home.Group\") && !dropItem?.isA(\"sap.cux.home.Group\")) {\n\t\t\t\tawait this._adjustAppDragDropInfo(dragDropInfo, appGroupId);\n\t\t\t} else if (dragItem?.isA(\"sap.cux.home.Group\")) {\n\t\t\t\tawait this._adjustGroupDragDropInfo(dragDropInfo);\n\t\t\t}\n\t\t}\n\t\treturn dragDropInfo;\n\t}\n\n\t/**\n\t * Adjusts apps drag and drop information.\n\t * @private\n\t * @param {IDragDropInfo} dragDropInfo - The drag and drop information to adjust.\n\t * @returns {Promise<void>} A Promise that resolves when the adjustment is completed.\n\t */\n\tprivate async _adjustAppDragDropInfo(dragDropInfo: IDragDropInfo, appGroupId?: string) {\n\t\tlet isUpdated = false;\n\t\tconst dragApp = dragDropInfo.dragItem as App;\n\t\tconst dropApp = dragDropInfo.dropItem as App;\n\t\tconst [dragVisualization, dropVisualization] = await Promise.all([\n\t\t\tthis.appManagerInstance.getVisualization(dragApp.getUrl(), appGroupId),\n\t\t\tthis.appManagerInstance.getVisualization(dropApp.getUrl(), appGroupId)\n\t\t]);\n\t\tif (dragDropInfo.dropPosition === dnd.RelativeDropPosition.Before) {\n\t\t\t//let's say there are two apps a1, a2, if a1 is moved before a2, that essentailly means the drop item index is same as current item index, adjust the dropItemIndex accordingly\n\t\t\tif (dragDropInfo.dragItemIndex === dragDropInfo.dropItemIndex - 1) {\n\t\t\t\tdragDropInfo.dropItemIndex--;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tdragDropInfo.dragItemIndex < dragDropInfo.dropItemIndex &&\n\t\t\t\tdragVisualization?.persConfig?.sectionIndex === dropVisualization?.persConfig?.sectionIndex\n\t\t\t) {\n\t\t\t\tdragDropInfo.dropItemIndex--;\n\t\t\t\tisUpdated = true;\n\t\t\t}\n\t\t} else if (dragDropInfo.dropPosition === dnd.RelativeDropPosition.After) {\n\t\t\tif (dragDropInfo.dragItemIndex === dragDropInfo.dropItemIndex + 1) {\n\t\t\t\tdragDropInfo.dropItemIndex++;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tdragDropInfo.dragItemIndex > dragDropInfo.dropItemIndex &&\n\t\t\t\tdragVisualization?.persConfig?.sectionIndex === dropVisualization?.persConfig?.sectionIndex\n\t\t\t) {\n\t\t\t\tdragDropInfo.dropItemIndex++;\n\t\t\t\tisUpdated = true;\n\t\t\t}\n\t\t}\n\n\t\tif (isUpdated) {\n\t\t\tconst tile = (dragDropInfo.dropControl as GridContainer).getItems()[dragDropInfo.dropItemIndex] as GenericTile;\n\t\t\tconst app = this._getTileItem(tile, appGroupId);\n\t\t\tif (app) {\n\t\t\t\tdragDropInfo.dropItem = app;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _getTileItem(tile: GenericTile, appGroupId?: string) {\n\t\tconst tileGroupId = tile.data(\"groupId\") as string | undefined;\n\t\tif (tileGroupId) {\n\t\t\t//tile is a group\n\t\t\treturn this._getGroup(tileGroupId);\n\t\t} else {\n\t\t\tconst group = appGroupId ? this._getGroup(appGroupId) : null;\n\t\t\tconst apps = group ? group.getApps() : this.getApps();\n\t\t\treturn apps.find((app) => getLeanURL(app.getUrl()) === tile.getUrl());\n\t\t}\n\t}\n\n\t/**\n\t * Adjusts app/group drag and drop information.\n\t * @private\n\t * @param {IDragDropInfo} dragDropInfo - The drag and drop information to adjust.\n\t * @returns {Promise<void>} A Promise that resolves when the adjustment is completed.\n\t */\n\tprivate async _adjustGroupDragDropInfo(dragDropInfo: IDragDropInfo) {\n\t\tconst sections = await this.appManagerInstance._getSections();\n\t\tlet dropGroupIndex;\n\t\tdragDropInfo.dragItemIndex = sections.findIndex((section) => section.id === (dragDropInfo.dragItem as Group).getGroupId());\n\n\t\t//If dropped app is the first ungrouped app, put the group at the end\n\t\tif (!dragDropInfo.dropItem.isA(\"sap.cux.home.Group\")) {\n\t\t\tconst lastGroupIndex = (this.getAggregation(\"groups\") as Group[]).length;\n\t\t\tdragDropInfo.dropItemIndex =\n\t\t\t\tdragDropInfo.dropPosition === dnd.RelativeDropPosition.Before &&\n\t\t\t\tdragDropInfo.dropItemIndex === lastGroupIndex &&\n\t\t\t\tdragDropInfo.dragItemIndex !== lastGroupIndex\n\t\t\t\t\t? lastGroupIndex + 1\n\t\t\t\t\t: dragDropInfo.dragItemIndex;\n\t\t} else {\n\t\t\tdropGroupIndex = sections.findIndex((section) => section.id === (dragDropInfo.dropItem as Group).getGroupId());\n\t\t\t//update the drop item with section index\n\t\t\tdragDropInfo.dropItemIndex = dropGroupIndex;\n\t\t}\n\n\t\t//let's say there are two groups g1, g2, if g1 is moved before g2, that essentailly means the drop item index is same as current item index, adjust the dropItemIndex accordingly\n\t\tif (\n\t\t\tdragDropInfo.dropPosition === dnd.RelativeDropPosition.Before &&\n\t\t\tdragDropInfo.dragItemIndex === dragDropInfo.dropItemIndex - 1\n\t\t) {\n\t\t\tdragDropInfo.dropItemIndex--;\n\t\t} else if (\n\t\t\tdragDropInfo.dropPosition === dnd.RelativeDropPosition.After &&\n\t\t\t(dragDropInfo.dragItemIndex !== dragDropInfo.dropItemIndex || (dropGroupIndex && dragDropInfo.dropItemIndex >= dropGroupIndex))\n\t\t) {\n\t\t\tdragDropInfo.dropItemIndex++;\n\t\t}\n\t}\n\n\t/**\n\t * Handler for drop event of a favorite item.\n\t * @private\n\t * @param {Event<DropInfo$DropEventParameters>} event - The drop event containing information about the dropped item.\n\t * @returns {Promise<void>} A Promise that resolves when the drop event handling is completed.\n\t */\n\tprivate async _onFavItemDrop(event: Event<DropInfo$DropEventParameters>, appGroupId?: string) {\n\t\tconst dragTile = event.getParameter?.(\"draggedControl\") as GenericTile;\n\t\tconst dragDropInfo = await this._getDragDropInfo(event, appGroupId);\n\t\tconst { dragItemIndex, dropItemIndex, dropPosition, dragItem, dropItem } = dragDropInfo;\n\t\tif (dragItemIndex === dropItemIndex) return;\n\n\t\tif (dropPosition === dnd.RelativeDropPosition.On) {\n\t\t\tawait this._handleOnItemDrop(dragItem, dropItem);\n\t\t\tvoid this.refresh();\n\t\t} else if (dropPosition === dnd.RelativeDropPosition.After || dropPosition === dnd.RelativeDropPosition.Before) {\n\t\t\tthis._setBusy(true);\n\t\t\tawait this._handleItemsReorder(dragDropInfo, appGroupId);\n\t\t\tawait this.refresh();\n\n\t\t\tif (appGroupId) {\n\t\t\t\tvoid this._setGroupDetailDialogApps(appGroupId);\n\t\t\t}\n\t\t\tthis._setBusy(false);\n\t\t}\n\n\t\tdragTile.removeStyleClass(\"sapMGTPressActive\");\n\t}\n\n\t/**\n\t * Handles the drop of an item onto another item.\n\t * If an app in dropped over another app, create group dialog is opened.\n\t * If an app is dropped over a group, app should be moved inside that group.\n\t * @private\n\t * @param {Group | App} dragItem - The item being dragged.\n\t * @param {Group | App} dropItem - The item onto which the dragItem is dropped.\n\t * @returns {Promise<void>} A Promise that resolves when the dropping of the item is completed.\n\t */\n\tprivate async _handleOnItemDrop(dragItem: Group | App, dropItem: Group | App) {\n\t\tif (dragItem.isA(\"sap.cux.home.Group\")) return;\n\n\t\tif (!dropItem.isA(\"sap.cux.home.Group\")) {\n\t\t\t//if both dragged and dropped items are apps, create group dialog is opened.\n\t\t\tconst dragApp = dragItem as App;\n\t\t\tconst dropApp = dropItem as App;\n\t\t\tthis._selectedApps = [dragApp, dropApp];\n\t\t\tthis._openCreateGroupDialog(true);\n\t\t} else {\n\t\t\t//if dragged item is an app and dropped item is a group, app should be moved into that group.\n\t\t\tconst targetGroupId = (dropItem as Group).getGroupId();\n\t\t\tthis._setBusy(true);\n\t\t\tawait this._handleMoveToGroup(dragItem, undefined, targetGroupId);\n\t\t\tthis._setBusy(false);\n\t\t}\n\t}\n\n\t/**\n\t * Handles the reordering of items based on drag and drop information.\n\t * @private\n\t * @param {IDragDropInfo} dragDropInfo - The drag and drop information.\n\t * @returns {Promise<void>} A Promise that resolves when the reordering is completed.\n\t */\n\tprivate async _handleItemsReorder(dragDropInfo: IDragDropInfo, appGroupId?: string) {\n\t\tconst { dragItem, dropItem, dragItemIndex, dropItemIndex } = dragDropInfo;\n\t\tconst isDragItemGroup = dragItem.isA(\"sap.cux.home.Group\");\n\t\tconst isDropItemGroup = dropItem.isA(\"sap.cux.home.Group\");\n\t\tif (!isDragItemGroup && !isDropItemGroup) {\n\t\t\tconst drapApp = dragItem as App;\n\t\t\tconst dropApp = dropItem as App;\n\t\t\tconst [dragVisualization, dropVisualization] = await Promise.all([\n\t\t\t\tthis.appManagerInstance.getVisualization(drapApp.getUrl(), appGroupId),\n\t\t\t\tthis.appManagerInstance.getVisualization(dropApp.getUrl(), appGroupId)\n\t\t\t]);\n\t\t\tawait this.appManagerInstance.moveVisualization({\n\t\t\t\tsourceSectionIndex: dragVisualization?.persConfig?.sectionIndex as number,\n\t\t\t\tsourceVisualizationIndex: dragVisualization?.persConfig?.visualizationIndex as number,\n\t\t\t\ttargetSectionIndex: dropVisualization?.persConfig?.sectionIndex as number,\n\t\t\t\ttargetVisualizationIndex: dropVisualization?.persConfig?.visualizationIndex as number\n\t\t\t});\n\t\t} else if (isDragItemGroup && isDropItemGroup) {\n\t\t\tawait this.appManagerInstance.moveSection(dragItemIndex, dropItemIndex);\n\t\t}\n\t}\n\n\t/**\n\t * Navigates to the App Finder with optional group Id.\n\t * @async\n\t * @private\n\t * @param {string} [groupId] - Optional group Id\n\t */\n\tprivate async navigateToAppFinder(groupId?: string) {\n\t\tconst navigationService = await Container.getServiceAsync<Navigation>(\"Navigation\");\n\t\tconst navigationObject: { pageID: string; sectionID?: string } = {\n\t\t\tpageID: MYHOME_PAGE_ID\n\t\t};\n\t\tif (groupId) {\n\t\t\tnavigationObject.sectionID = groupId;\n\t\t}\n\t\tawait navigationService.navigate({\n\t\t\ttarget: {\n\t\t\t\tshellHash: `Shell-appfinder?&/catalog/${JSON.stringify(navigationObject)}`\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Validates if import apps is enabled\n\t *\n\t *@returns {Promise} - resolves to boolean value (import is enabled/disabled)\n\t */\n\tprivate async _validateAppsMigration() {\n\t\ttry {\n\t\t\treturn await MyHomeImport.isImportEnabled();\n\t\t} catch (error: unknown) {\n\t\t\tLog.warning(error instanceof Error ? error.message : \"Error while checking if import apps is enabled\");\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate _openImportAppsDialog() {\n\t\tconst pageRuntime = new PageRuntime();\n\t\tpageRuntime.onImportDialogPress();\n\t}\n\n\t/**\n\t * Opens the create group dialog.\n\t * @private\n\t * @param {boolean} [skipAppsSelection=false] - Whether to skip the apps selection page.\n\t */\n\tprivate _openCreateGroupDialog(skipAppsSelection = false) {\n\t\tconst createGroupDialog = this._generateCreateGroupDialog(skipAppsSelection);\n\t\tconst appsWrapper = this._controlMap.get(`${this.getId()}-createGroupDialog-appsPage-scrollContainer-apps`) as GridContainer;\n\t\tappsWrapper.destroyItems();\n\t\tconst tiles = [...this.getApps()].map((app) => {\n\t\t\tconst appCopy = app.clone();\n\t\t\tappCopy._onPress = (e) => this._highlightApp(e, appCopy); // override app press behaviour to highlight app\n\t\t\treturn (this.getParent() as AppsContainer)._getAppTile(appCopy);\n\t\t});\n\t\tthis._setAggregation(appsWrapper, tiles);\n\t\tlet apps = this.getApps();\n\t\t(this.getParent() as AppsContainer).fireEvent(\"appsLoaded\", { apps, tiles });\n\t\tthis._updateSelectedAppCount();\n\t\tcreateGroupDialog.open();\n\t}\n\n\t/**\n\t * Closes the create group dialog.\n\t * @private\n\t */\n\tprivate _closeCreateGroupDialog() {\n\t\tconst createGroupDialog = this._generateCreateGroupDialog();\n\t\tcreateGroupDialog?.close();\n\t\t//reset create group dialog on close\n\t\tthis._resetCreateGroupDialog();\n\t}\n\n\t/**\n\t * Resets the state of the create group dialog.\n\t * @private\n\t */\n\tprivate _resetCreateGroupDialog() {\n\t\tconst navContainer = this._generateCreateGroupNavContainer();\n\t\tconst groupNameInput = this._controlMap.get(`${this.getId()}-createGroupDialog-mainPage-form-groupName-input`) as Input;\n\t\tconst searchField = this._controlMap.get(`${this.getId()}-createGroupDialog-appsPage-search`) as SearchField;\n\t\tgroupNameInput.setValue(\"\");\n\t\tnavContainer.to(navContainer.getInitialPage() as string);\n\t\tthis._selectedApps = [];\n\t\tsearchField.setValue(\"\");\n\t\tthis._setNoAppsSelectedError(false);\n\t\tthis._selectedGroupColor = undefined;\n\t}\n\n\t/**\n\t * Generates or retrieves the dialog for creating a group.\n\t * @private\n\t * @param {boolean} bSkipAppsSelection - Whether to skip the apps selection page.\n\t * @returns {sap.m.Dialog} The generated dialog for creating a group.\n\t */\n\tprivate _generateCreateGroupDialog(skipAppsSelection: boolean = true) {\n\t\tconst id = `${this.getId()}-createGroupDialog`;\n\t\tconst navContainer = this._generateCreateGroupNavContainer();\n\t\tconst _toggleNavButton = (skipAppsSelection: boolean) => {\n\t\t\tconst nextBtn = this._controlMap.get(`${id}-nextBtn`) as Button;\n\t\t\tconst backBtn = this._controlMap.get(`${id}-backBtn`) as Button;\n\t\t\tconst createBtn = this._controlMap.get(`${id}-createBtn`) as Button;\n\t\t\tconst currentPageIndex = navContainer.indexOfPage(navContainer.getCurrentPage());\n\t\t\tnextBtn.setVisible(currentPageIndex !== navContainer.getPages().length - 1 && !skipAppsSelection);\n\t\t\tbackBtn.setVisible(currentPageIndex !== 0 && !skipAppsSelection);\n\t\t\tcreateBtn.setVisible(currentPageIndex === navContainer.getPages().length - 1 || skipAppsSelection);\n\t\t};\n\t\tif (!this._controlMap.get(id)) {\n\t\t\t//set up navigation buttons\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-nextBtn`,\n\t\t\t\tnew Button({\n\t\t\t\t\tid: `${id}-nextBtn`,\n\t\t\t\t\ttext: this._i18nBundle.getText(\"nextButton\"),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tif (this._validateGroupName()) {\n\t\t\t\t\t\t\tnavContainer.to(this._generateCreateGroupAppsPage());\n\t\t\t\t\t\t\t_toggleNavButton(skipAppsSelection);\n\t\t\t\t\t\t\tthis._highlightSelectedApps();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttype: \"Emphasized\"\n\t\t\t\t})\n\t\t\t);\n\t\t\t// Add FESR for next button\n\t\t\tconst nextBtn = this._controlMap.get(`${id}-nextBtn`) as Button;\n\t\t\taddFESRSemanticStepName(nextBtn, \"press\", \"createGroupNextBtn\");\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-backBtn`,\n\t\t\t\tnew Button({\n\t\t\t\t\tid: `${id}-backBtn`,\n\t\t\t\t\ttext: this._i18nBundle.getText(\"backButton\"),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tnavContainer.back();\n\t\t\t\t\t\t_toggleNavButton(skipAppsSelection);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t\t// Add FESR for back button\n\t\t\tconst backBtn = this._controlMap.get(`${id}-backBtn`) as Button;\n\t\t\taddFESRSemanticStepName(backBtn, \"press\", \"createGroupBackBtn\");\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-createBtn`,\n\t\t\t\tnew Button({\n\t\t\t\t\tid: `${id}-createBtn`,\n\t\t\t\t\ttext: this._i18nBundle.getText(\"createButton\"),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tvoid this._onPressGroupCreate();\n\t\t\t\t\t},\n\t\t\t\t\ttype: \"Emphasized\"\n\t\t\t\t})\n\t\t\t);\n\t\t\t// Add FESR for create button\n\t\t\tconst createBtn = this._controlMap.get(`${id}-createBtn`) as Button;\n\t\t\taddFESRSemanticStepName(createBtn, \"press\", \"addCreateGroup\");\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew Dialog(id, {\n\t\t\t\t\ttitle: this._i18nBundle.getText(\"createGroup\"),\n\t\t\t\t\tcontent: navContainer,\n\t\t\t\t\tescapeHandler: this._closeCreateGroupDialog.bind(this),\n\t\t\t\t\tcontentHeight: \"25rem\",\n\t\t\t\t\tcontentWidth: \"41.75rem\",\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tnextBtn,\n\t\t\t\t\t\tbackBtn,\n\t\t\t\t\t\tcreateBtn,\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\tid: `${id}-cancelBtn`,\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"cancelBtn\"),\n\t\t\t\t\t\t\tpress: this._closeCreateGroupDialog.bind(this)\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}).addStyleClass(\"sapCuxCreateGroupDialog sapContrastPlus\")\n\t\t\t);\n\t\t}\n\t\t_toggleNavButton(skipAppsSelection);\n\t\treturn this._controlMap.get(id) as Dialog;\n\t}\n\n\t/**\n\t * Handles the highlighting of an app when selected.\n\t * @private\n\t * @param {sap.ui.base.Event} event - The event object.\n\t * @param {Object} selectedApp - The selected app object.\n\t */\n\tprivate _highlightApp(event: Event, selectedApp: App) {\n\t\tconst oTile = event.getSource<GenericTile>(),\n\t\t\tbIsSelected = !oTile.hasStyleClass(\"sapCuxHighlightApp\"),\n\t\t\toScrollContainer = this._generateAppsScrollContainer();\n\t\tthis._selectedApps = this._selectedApps || [];\n\t\tif (bIsSelected) {\n\t\t\tthis._selectedApps.push(selectedApp);\n\t\t} else {\n\t\t\tthis._selectedApps.splice(\n\t\t\t\tthis._selectedApps.findIndex((oApp) => selectedApp.getUrl() === oApp.getUrl()),\n\t\t\t\t1\n\t\t\t);\n\t\t}\n\t\tthis._updateSelectedAppCount();\n\t\toTile.toggleStyleClass(\"sapCuxHighlightApp\", bIsSelected);\n\t\tthis._setNoAppsSelectedError(this._selectedApps.length < 1);\n\t\t//adjust scroll container height\n\t\toScrollContainer.setHeight(this._selectedApps.length < 1 ? \"15.3rem\" : \"17.5rem\");\n\t}\n\n\t/**\n\t * Generates the scroll container for displaying apps in the create group dialog.\n\t * @private\n\t * @returns {sap.m.ScrollContainer} The scroll container for displaying apps.\n\t */\n\tprivate _generateAppsScrollContainer() {\n\t\tconst id = `${this.getId()}-createGroupDialog-appsPage-scrollContainer`;\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-apps`,\n\t\t\t\tnew GridContainer({\n\t\t\t\t\tid: `${id}-apps`,\n\t\t\t\t\tlayout: new GridContainerSettings(`${id}--appsContainerSettings`, {\n\t\t\t\t\t\tcolumnSize: \"19rem\",\n\t\t\t\t\t\tgap: \"0.5rem\"\n\t\t\t\t\t})\n\t\t\t\t}).addStyleClass(\"sapCuxAppsGridContainerPadding\")\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew ScrollContainer(id, {\n\t\t\t\t\tid,\n\t\t\t\t\tvertical: true,\n\t\t\t\t\tvisible: true,\n\t\t\t\t\theight: \"17.5rem\",\n\t\t\t\t\tcontent: [this._controlMap.get(`${id}-apps`) as GridContainer]\n\t\t\t\t}).addStyleClass(\"sapUiSmallMarginBeginEnd\")\n\t\t\t);\n\t\t}\n\t\treturn this._controlMap.get(id) as ScrollContainer;\n\t}\n\n\t/**\n\t * Method for updating selected apps count in create group dialog\n\t * @private\n\t */\n\tprivate _updateSelectedAppCount() {\n\t\tconst oAppsCountContol = this._controlMap.get(`${this.getId()}-createGroupDialog-appsPage-headerContainer-count`) as Text;\n\t\toAppsCountContol.setText(\n\t\t\tthis._i18nBundle.getText(\"selectedAppsCount\", [this._selectedApps?.length || this._i18nBundle.getText(\"noAppSelected\")])\n\t\t);\n\t}\n\n\t/**\n\t * Creates or returns the navigation container for the create group dialog.\n\t * @private\n\t * @returns {sap.m.NavContainer} The navigation container for the create group dialog.\n\t */\n\tprivate _generateCreateGroupNavContainer() {\n\t\tconst id = `${this.getId()}-createGroupDialog-wrapper`;\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew NavContainer(id, {\n\t\t\t\t\tinitialPage: `${this.getId()}-createGroupDialog-mainPage`,\n\t\t\t\t\tpages: [this._generateCreateGroupMainPage(), this._generateCreateGroupAppsPage()]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\treturn this._controlMap.get(id) as NavContainer;\n\t}\n\n\t/**\n\t * Generates or retrieve the main page of the create group dialog.\n\t * @private\n\t * @returns {sap.m.Page} The main page of the create group dialog.\n\t */\n\tprivate _generateCreateGroupMainPage() {\n\t\tconst id = `${this.getId()}-createGroupDialog-mainPage`;\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-form-groupName-input`,\n\t\t\t\tnew Input({\n\t\t\t\t\tid: `${id}-form-groupName-input`,\n\t\t\t\t\twidth: \"13.75rem\",\n\t\t\t\t\trequired: true,\n\t\t\t\t\tliveChange: this._validateGroupName.bind(this)\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew Page({\n\t\t\t\t\tid,\n\t\t\t\t\tshowHeader: false,\n\t\t\t\t\tenableScrolling: false,\n\t\t\t\t\tbackgroundDesign: \"List\",\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew VBox({\n\t\t\t\t\t\t\tid: `${id}-headerContainer`,\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\tnew Title({\n\t\t\t\t\t\t\t\t\tid: `${id}-title`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"settings\")\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tnew Text({\n\t\t\t\t\t\t\t\t\tid: `${id}-description`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"settingsDescription\")\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}).addStyleClass(\"sapUiSmallMarginTop sapUiSmallMarginBeginEnd sapUiTinyMarginBottom\"),\n\t\t\t\t\t\tnew SimpleForm(`${id}-form`, {\n\t\t\t\t\t\t\tlayout: form.SimpleFormLayout.ResponsiveGridLayout,\n\t\t\t\t\t\t\tlabelSpanS: 4,\n\t\t\t\t\t\t\tlabelSpanM: 4,\n\t\t\t\t\t\t\tcontent: [\n\t\t\t\t\t\t\t\tnew Label({\n\t\t\t\t\t\t\t\t\tid: `${id}-form-groupName-label`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"groupNameLbl\")\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginTop\"),\n\t\t\t\t\t\t\t\tthis._controlMap.get(`${id}-form-groupName-input`) as Input,\n\t\t\t\t\t\t\t\tnew Label({\n\t\t\t\t\t\t\t\t\tid: `${id}-form-groupColor-label`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"groupColorLbl\")\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginTop\"),\n\t\t\t\t\t\t\t\tnew ColorPalette(`${id}-form-groupColor-pallet`, {\n\t\t\t\t\t\t\t\t\tcolors: END_USER_COLORS().map((oColor) => oColor.value) as string[],\n\t\t\t\t\t\t\t\t\tcolorSelect: this._onColorSelect.bind(this)\n\t\t\t\t\t\t\t\t}).addStyleClass(\"adjustSelectedColorPalette\")\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}).addStyleClass(\"sapUiMediumMarginTop\")\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\treturn this._controlMap.get(id) as Page;\n\t}\n\n\t/**\n\t * Generates or retrieve the app selection page of the create group dialog.\n\t * @private\n\t * @returns {sap.m.Page} The app selection page of the create group dialog.\n\t */\n\tprivate _generateCreateGroupAppsPage() {\n\t\tconst id = `${this.getId()}-createGroupDialog-appsPage`;\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-search`,\n\t\t\t\tnew SearchField({\n\t\t\t\t\tid: `${id}-search`,\n\t\t\t\t\tliveChange: this._onCreateAppSearch.bind(this)\n\t\t\t\t}).addStyleClass(\"sapUiTinyMarginTopBottom\")\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-errorMessageStrip`,\n\t\t\t\tnew MessageStrip(`${id}-errorMessageStrip`, {\n\t\t\t\t\tid: `${id}-errorMessageStrip`,\n\t\t\t\t\ttype: MessageType.Error,\n\t\t\t\t\tshowIcon: true,\n\t\t\t\t\ttext: this._i18nBundle.getText(\"selectionErrorMessage\"),\n\t\t\t\t\tvisible: false\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-headerContainer-count`,\n\t\t\t\tnew Text({\n\t\t\t\t\tid: `${id}-headerContainer-count`\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew Page(id, {\n\t\t\t\t\tshowHeader: false,\n\t\t\t\t\tbackgroundDesign: \"List\",\n\t\t\t\t\tenableScrolling: false,\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew VBox(`${id}-headerContainer`, {\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\tnew HBox(`${id}-headerContainer-titleCount`, {\n\t\t\t\t\t\t\t\t\tid: `${id}-headerContainer-titleCount`,\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\tnew Title({\n\t\t\t\t\t\t\t\t\t\t\tid: `${id}-headerContainer-title`,\n\t\t\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"selectedAppsTitle\")\n\t\t\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginEnd\"),\n\t\t\t\t\t\t\t\t\t\tthis._controlMap.get(`${id}-headerContainer-count`) as Text\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tnew Text({\n\t\t\t\t\t\t\t\t\tid: `${id}-description`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"appsSelectionDescription\")\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBottom\"),\n\t\t\t\t\t\t\t\tthis._controlMap.get(`${id}-search`) as SearchField,\n\t\t\t\t\t\t\t\tthis._controlMap.get(`${id}-errorMessageStrip`) as MessageStrip\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}).addStyleClass(\"sapUiSmallMarginTop sapUiSmallMarginBeginEnd sapUiTinyMarginBottom\"),\n\t\t\t\t\t\tthis._generateAppsScrollContainer(),\n\t\t\t\t\t\tthis._generateCreateGroupErrorMsg()\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\treturn this._controlMap.get(id) as Page;\n\t}\n\n\t/**\n\t * Generates the error message for create group dialog, when no apps are found for searched text.\n\t * @private\n\t * @returns {sap.m.IllustratedMessage} The error message for no filtered apps.\n\t */\n\tprivate _generateCreateGroupErrorMsg() {\n\t\tconst id = `${this.getId()}-createGroupDialog-appsPage-noFilterApps`;\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew IllustratedMessage({\n\t\t\t\t\tid,\n\t\t\t\t\tillustrationSize: IllustratedMessageSize.Base,\n\t\t\t\t\ttitle: this._i18nBundle.getText(\"noSearchedAppTitle\"),\n\t\t\t\t\tdescription: this._i18nBundle.getText(\"noSearchedAppDes\"),\n\t\t\t\t\tvisible: false\n\t\t\t\t}).addStyleClass(\"sapUiLargeMarginTop\")\n\t\t\t);\n\t\t}\n\t\treturn this._controlMap.get(id) as IllustratedMessage;\n\t}\n\n\t/**\n\t * Handles the color selection event for new group.\n\t * @private\n\t * @param {sap.ui.base.Event} event - The event object.\n\t */\n\tprivate _onColorSelect(event: ColorPalette$ColorSelectEvent) {\n\t\tthis._selectedGroupColor = this._getLegendColor(event.getParameter(\"value\") as string).key;\n\t}\n\n\t/**\n\t * Retrieves the key of the legend color based on the provided color value.\n\t * @param {string} color - The color value for which to retrieve the legend color key.\n\t * @returns {string} The legend color key corresponding to the provided color value, or the default background color key if not found.\n\t * @private\n\t */\n\tprivate _getLegendColor(color: string) {\n\t\treturn END_USER_COLORS().find((oColor) => oColor.value === color) || DEFAULT_BG_COLOR();\n\t}\n\n\t/**\n\t * Sets the visibility of the error message strip indicating no apps are selected in create group dialog.\n\t * @private\n\t * @param {boolean} error - Whether to show the error message strip (true) or hide it (false).\n\t */\n\tprivate _setNoAppsSelectedError(error: boolean) {\n\t\tconst messageStrip = this._controlMap.get(`${this.getId()}-createGroupDialog-appsPage-errorMessageStrip`) as MessageStrip;\n\t\tmessageStrip.setVisible(error);\n\t}\n\n\t/**\n\t * Validates the group name entered in the create group dialog.\n\t * @private\n\t * @returns {boolean} Whether the group name is valid (true) or not (false).\n\t */\n\tprivate _validateGroupName() {\n\t\tconst groupNameInput = this._controlMap.get(`${this.getId()}-createGroupDialog-mainPage-form-groupName-input`) as Input;\n\t\tconst groupName = groupNameInput.getValue().trim();\n\t\t//update value state\n\t\tgroupNameInput.setValueState(groupName ? \"None\" : \"Error\");\n\t\tgroupNameInput.setValueStateText(groupName ? \"\" : (this._i18nBundle.getText(\"invalidGroupName\") as string));\n\t\treturn groupName ? true : false;\n\t}\n\n\t/**\n\t * Highlights selected apps by adding a CSS class to corresponding tiles.\n\t * @private\n\t */\n\tprivate _highlightSelectedApps() {\n\t\tconst selectedApps = this._selectedApps || [];\n\t\tconst tilesContainer = this._controlMap.get(`${this.getId()}-createGroupDialog-appsPage-scrollContainer-apps`) as GridContainer;\n\t\tconst tiles = (tilesContainer.getItems() || []) as GenericTile[];\n\t\ttiles.forEach((tile) => {\n\t\t\ttile.toggleStyleClass(\n\t\t\t\t\"sapCuxHighlightApp\",\n\t\t\t\tselectedApps.some((app) => getLeanURL(app.getUrl()) === tile.getUrl())\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Handles the search for apps in create group dialog.\n\t * @private\n\t * @param {sap.ui.base.Event} event - The event object.\n\t */\n\tprivate _onCreateAppSearch(event: Event) {\n\t\tconst tilesContainer = this._controlMap.get(`${this.getId()}-createGroupDialog-appsPage-scrollContainer-apps`) as GridContainer,\n\t\t\tsearchQuery = event.getSource<SearchField>().getValue(),\n\t\t\ttiles = (tilesContainer.getItems() || []) as GenericTile[],\n\t\t\tsearchExpression = new RegExp(searchQuery, \"i\");\n\t\ttiles.forEach((tile) => {\n\t\t\ttile.setVisible(searchExpression.test(tile.getHeader()));\n\t\t});\n\t\tconst filteredTiles = tiles.filter((tile) => tile.getVisible());\n\t\tconst hasFilteredApps = filteredTiles.length > 0;\n\t\tthis._generateAppsScrollContainer()?.setVisible(hasFilteredApps);\n\t\tthis._generateCreateGroupErrorMsg()?.setVisible(!hasFilteredApps);\n\t}\n\n\t/**\n\t * Handles the event when the user presses the button to create a new group.\n\t * @private\n\t */\n\tprivate async _onPressGroupCreate() {\n\t\tconst groupNameInput = this._controlMap.get(`${this.getId()}-createGroupDialog-mainPage-form-groupName-input`) as Input;\n\t\tif (this._validateGroupName()) {\n\t\t\tif (this._selectedApps?.length) {\n\t\t\t\tthis._setBusy(true);\n\t\t\t\ttry {\n\t\t\t\t\tawait this._createGroup({\n\t\t\t\t\t\tselectedApps: this._selectedApps,\n\t\t\t\t\t\tgroupName: groupNameInput.getValue(),\n\t\t\t\t\t\tgroupColor: this._getGroupColor()\n\t\t\t\t\t});\n\t\t\t\t\tawait this.refresh();\n\n\t\t\t\t\t// Show toast message after successful group creation\n\t\t\t\t\tMessageToast.show(this._i18nBundle.getText(\"newGroupCreated\") as string, {\n\t\t\t\t\t\tof: this._controlMap.get(`${this.getId()}-createGroupDialog`),\n\t\t\t\t\t\toffset: \"0 80\"\n\t\t\t\t\t});\n\t\t\t\t\tconst groups = (this.getAggregation(\"groups\") || []) as Group[];\n\t\t\t\t\tvoid this._showGroupDetailDialog(groups[0]?.getGroupId());\n\t\t\t\t} catch (err) {\n\t\t\t\t\tLog.error(err as string);\n\t\t\t\t\tMessageToast.show(this._i18nBundle.getText(\"unableToCreateGroup\") as string);\n\t\t\t\t} finally {\n\t\t\t\t\tthis._setBusy(false);\n\t\t\t\t\tthis._closeCreateGroupDialog();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._setNoAppsSelectedError(true);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new group with the given properties and adds selected apps to it.\n\t * @param {Object} params - The properties for creating the group.\n\t * @param {sap.ui.core.URI[]} params.selectedApps - Target URL unique identifier of the selected apps to be added to the group.\n\t * @param {string} [params.groupName] - The name of the group. If not provided, a default name will be used.\n\t * @param {string} [params.groupColor] - The color of the group. If not provided, the default color will be used.\n\t * @private\n\t */\n\tprivate async _createGroup(params: { selectedApps: App[]; groupName: string; groupColor: string }) {\n\t\tconst { selectedApps, groupName, groupColor } = params;\n\t\tconst sectionVisualizations = await this.appManagerInstance.getSectionVisualizations();\n\t\tconst visualizations = selectedApps.reduce((selectedVisualizations: ICustomVisualization[], oApp) => {\n\t\t\tconst sectionVisualization = sectionVisualizations.find((oSectionViz) => oSectionViz.url === oApp.getUrl());\n\t\t\tif (sectionVisualization) {\n\t\t\t\tselectedVisualizations.push(sectionVisualization);\n\t\t\t}\n\t\t\treturn selectedVisualizations;\n\t\t}, []);\n\t\tconst sectionId = visualizations[0].persConfig!.sectionId!;\n\t\tawait this.appManagerInstance.addSection({\n\t\t\tsectionIndex: 1,\n\t\t\tsectionProperties: {\n\t\t\t\ttitle: groupName || this._i18nBundle.getText(\"newGroup\"),\n\t\t\t\tvisible: true,\n\t\t\t\tvisualizations: visualizations.map((viz) => viz.visualization)\n\t\t\t}\n\t\t});\n\n\t\tconst visualizationsToBeDeleted: string[] = visualizations.reduce((visualizationsToBeDeleted: string[], oViz) => {\n\t\t\tif (oViz.visualization?.id) {\n\t\t\t\tconst duplicateVisualizationIds = (oViz.persConfig?.duplicateApps || []).map((oViz) => oViz.visualization?.id) as string[];\n\t\t\t\tvisualizationsToBeDeleted = visualizationsToBeDeleted.concat([oViz.visualization?.id], duplicateVisualizationIds);\n\t\t\t}\n\t\t\treturn visualizationsToBeDeleted;\n\t\t}, []);\n\n\t\tawait this.appManagerInstance.removeVisualizations({ sectionId, vizIds: visualizationsToBeDeleted });\n\t\tconst sections = await this.appManagerInstance._getSections(true);\n\t\tconst defaultSection = sections.find((oSection) => oSection.default);\n\t\tconst targetGroupId = sections[defaultSection ? 1 : 0]?.id;\n\t\t//update personalization\n\t\tawait this._updateAppPersonalization(\n\t\t\tvisualizations.map((oViz) => {\n\t\t\t\treturn {\n\t\t\t\t\tvisualization: oViz,\n\t\t\t\t\ttargetGroupId\n\t\t\t\t};\n\t\t\t})\n\t\t);\n\t\tawait this._updateGroupPersonalization(targetGroupId!, groupColor);\n\t}\n\n\t/**\n\t * Retrieves the color for the group.\n\t * @private\n\t * @returns {string} The color for the group.\n\t */\n\tprivate _getGroupColor() {\n\t\tconst defaultColor = DEFAULT_BG_COLOR().key;\n\t\tconst firstApp = this._selectedApps[0];\n\t\tconst setDefaultColor = this._selectedApps.some((app) => app.getBgColor() !== firstApp.getBgColor());\n\t\t//if group color is selected then apply that color, else if all the selected apps have same color then give the same color to group, else apply default color.\n\t\treturn this._selectedGroupColor || (setDefaultColor ? defaultColor : firstApp.getBgColor());\n\t}\n\n\t/**\n\t * Opens a color popover for selecting a background color for an item.\n\t * @param {sap.ui.base.Event} event - The event object.\n\t * @private\n\t */\n\tprivate _openColorPopover(event: Event<{ listItem?: StandardListItem }>) {\n\t\tconst colorPopoverId = `${this.getId()}-colorPopover`,\n\t\t\tcolors = END_USER_COLORS().map((oColor) => oColor.value) as string[];\n\t\tconst source = event.getSource<MenuItem>();\n\t\tthis._currentItem = source.getParent() as App | Group;\n\t\tlet colorPopover = this._controlMap.get(colorPopoverId) as ColorPalettePopover;\n\t\tif (!colorPopover) {\n\t\t\tcolorPopover = new ColorPalettePopover(colorPopoverId, {\n\t\t\t\tid: colorPopoverId,\n\t\t\t\tcolors: colors,\n\t\t\t\tshowDefaultColorButton: false,\n\t\t\t\tshowMoreColorsButton: false,\n\t\t\t\tshowRecentColorsSection: false,\n\t\t\t\tcolorSelect: (event: ColorPalette$ColorSelectEvent) => {\n\t\t\t\t\tActionsPopover._closeActionsPopover();\n\t\t\t\t\tconst selectedColor = event.getParameter(\"value\") as string;\n\t\t\t\t\tvoid this._handleColorSelect(this._currentItem, selectedColor);\n\t\t\t\t}\n\t\t\t}).addStyleClass(\"sapContrastPlus\");\n\t\t\t(colorPopover as ColorPalettePopover & { _oPopover: Popover })._oPopover.setPlacement(PlacementType.HorizontalPreferredRight);\n\t\t\tthis._controlMap.set(colorPopoverId, colorPopover);\n\t\t}\n\t\tcolorPopover.openBy(event.getParameter(\"listItem\") as Control);\n\t}\n\n\t/**\n\t * Handles the selection of a color for an app or group.\n\t * @param {sap.cux.home.App | sap.cux.home.Group} item - The item control.\n\t * @param {string} color - The selected color.\n\t * @returns {Promise<void>} - A promise that resolves when the color selection is handled.\n\t * @private\n\t */\n\tprivate async _handleColorSelect(item: App | Group, color: string) {\n\t\tconst selectedColor = this._getLegendColor(color).key;\n\t\titem.setProperty(\"bgColor\", selectedColor, true);\n\t\tconst groupId = item.isA(\"sap.cux.home.Group\") ? (item as Group).getGroupId() : null;\n\t\tconst isGroupedApp = !groupId && item.getParent()?.isA(\"sap.cux.home.Group\");\n\n\t\t//update tile color\n\t\tif (isGroupedApp) {\n\t\t\tthis._refreshGroupDetailDialog(item as App, false);\n\t\t} else {\n\t\t\t//if ungroup app or group\n\t\t\tthis._applyUngroupedTileColor(item, color);\n\t\t\tthis.oEventBus.publish(\"appsChannel\", \"favAppColorChanged\", { item, color });\n\t\t}\n\n\t\t//update personalization\n\t\tif (groupId) {\n\t\t\t//if group\n\t\t\tvoid this._updateGroupPersonalization(groupId, selectedColor);\n\t\t\tconst groupIconControl = this._controlMap.get(`${this.getId()}-detailDialog-toolbar-color`) as Icon;\n\t\t\tgroupIconControl?.setColor(color);\n\t\t} else {\n\t\t\t//if app\n\t\t\tconst app = item as App;\n\t\t\tconst groupId = isGroupedApp ? (app.getParent() as Group).getGroupId() : undefined;\n\t\t\tconst visualization = await this.appManagerInstance.getVisualization(app.getUrl(), groupId);\n\t\t\tif (visualization) {\n\t\t\t\tvoid this._updateAppPersonalization([{ visualization, color: selectedColor }]);\n\t\t\t}\n\t\t}\n\t\tthis.oEventBus.publish(\"appsChannel\", \"favAppColorChanged\", { item, color });\n\t}\n\n\t/**\n\t * Retrieves the list of groups where apps can be moved, excluding the source group if specified.\n\t * @param {string|null} sourceGroupId - The ID of the source group from which apps are being moved.\n\t * @returns {sap.cux.home.Group[]} An array of groups where apps can be moved.\n\t * @private\n\t */\n\tprivate _getAllowedMoveGroups(sourceGroupId: string | undefined) {\n\t\tlet allowedMoveGroups = (this.getAggregation(\"groups\") || []) as Group[];\n\t\tif (sourceGroupId) {\n\t\t\tallowedMoveGroups = allowedMoveGroups.filter((allowedMoveGroup) => allowedMoveGroup.getGroupId() !== sourceGroupId);\n\t\t}\n\t\treturn allowedMoveGroups;\n\t}\n\n\t/**\n\t * Sets the busy state for dialogs and the panel.\n\t * @param {boolean} busy - Indicates whether the dialogs and the panel should be set to busy state.\n\t * @private\n\t */\n\tprivate _setBusy(busy: boolean) {\n\t\t[this._generateGroupDetailDialog(), this._generateCreateGroupDialog(), this._generateAddFromInsightsDialog()].forEach(\n\t\t\t(oControl) => {\n\t\t\t\toControl.setBusy(busy);\n\t\t\t}\n\t\t);\n\t\tsuper.setBusy(busy);\n\t}\n\n\t/**\n\t * Opens a popover to move the app to another group.\n\t * @param {sap.cux.home.Group} sourceGroup - The source group from which the app is being moved.\n\t * @param {sap.ui.base.Event} event - The event triggering the popover opening.\n\t * @private\n\t */\n\tprivate _openMoveToGroupPopover(event: Event<{ listItem?: StandardListItem }>, sourceGroup?: Group) {\n\t\tconst popoverId = `${this.getId()}-moveToGroupPopover`,\n\t\t\tsource = event?.getSource<MenuItem>(),\n\t\t\tapp = source?.getParent() as App,\n\t\t\tsourceGroupId = sourceGroup?.getGroupId();\n\n\t\tlet list = this._controlMap.get(`${popoverId}-list`) as List,\n\t\t\tmoveToGroupPopover = this._controlMap.get(popoverId) as Popover;\n\n\t\tif (!moveToGroupPopover) {\n\t\t\tlist = new List({\n\t\t\t\tid: `${popoverId}-list`,\n\t\t\t\titemPress: () => ActionsPopover._closeActionsPopover()\n\t\t\t});\n\t\t\tthis._controlMap.set(`${popoverId}-list`, list);\n\t\t\tmoveToGroupPopover = new Popover({\n\t\t\t\tid: popoverId,\n\t\t\t\tshowHeader: false,\n\t\t\t\tplacement: PlacementType.HorizontalPreferredRight,\n\t\t\t\tcontent: [list]\n\t\t\t}).addStyleClass(\"sapContrastPlus\");\n\t\t\tthis._controlMap.set(popoverId, moveToGroupPopover);\n\t\t}\n\t\tlist.removeAllItems();\n\n\t\tthis._getAllowedMoveGroups(sourceGroupId).forEach((targetGroup) =>\n\t\t\tlist.addItem(\n\t\t\t\tnew StandardListItem(recycleId(`${this.getId()}-moveTo-${app.getId()}`), {\n\t\t\t\t\ttitle: targetGroup.getTitle(),\n\t\t\t\t\ttype: \"Active\",\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tvoid this._handleMoveToGroup(app, sourceGroupId, targetGroup.getGroupId());\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\n\t\tmoveToGroupPopover.openBy(event.getParameter(\"listItem\") as Control);\n\t}\n\n\t/**\n\t * Handles the removal of an app, displaying a confirmation dialog to the user.\n\t * If the app is the last one in the group, a warning dialog is displayed for confirmation.\n\t * @param {sap.cux.home.App} app - The app to be removed.\n\t * @param {sap.cux.home.Group} [group] - The group from which the app should be removed. If not provided, the app is considered to be in favorites.\n\t * @private\n\t */\n\tprivate _handleRemove(app: App, group?: Group): void {\n\t\tconst lastAppInGroup = group?.getApps()?.length === 1;\n\n\t\tlet message = this._i18nBundle.getText(\"removeAppMessage\", [app.getTitle()]),\n\t\t\ttitle = this._i18nBundle.getText(\"remove\"),\n\t\t\tactionText = this._i18nBundle.getText(\"remove\"),\n\t\t\tmessageIcon = MessageBox.Icon.QUESTION;\n\n\t\tif (lastAppInGroup) {\n\t\t\tmessage = this._i18nBundle.getText(\"removeFromMyHomeMessage\", [app.getTitle()]);\n\t\t\ttitle = this._i18nBundle.getText(\"delete\");\n\t\t\tactionText = this._i18nBundle.getText(\"delete\");\n\t\t\tmessageIcon = MessageBox.Icon.WARNING;\n\t\t}\n\n\t\tMessageBox.show(message as string, {\n\t\t\ticon: messageIcon,\n\t\t\ttitle: title,\n\t\t\tactions: [actionText as string, MessageBox.Action.CANCEL],\n\t\t\temphasizedAction: actionText,\n\t\t\tonClose: async (action: string) => {\n\t\t\t\tif (action === actionText) {\n\t\t\t\t\tthis._setBusy(true);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this._removeApp(app, group);\n\t\t\t\t\t\tif (lastAppInGroup) {\n\t\t\t\t\t\t\tthis._closeGroupDetailDialog();\n\t\t\t\t\t\t} else if (group) {\n\t\t\t\t\t\t\tthis._refreshGroupDetailDialog(app);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tawait (this.getParent() as AppsContainer)._refreshAllPanels();\n\t\t\t\t\t\tMessageToast.show(this._i18nBundle.getText(\"appRemoved\") as string);\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tLog.error(err as string);\n\t\t\t\t\t\tMessageToast.show(this._i18nBundle.getText(\"unableToRemoveApp\") as string);\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tthis._setBusy(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Removes the specified app from the group or favorites.\n\t * If the app is the last one in the group, the group will be deleted as well.\n\t * If the app is an ungrouped app, its duplicate apps (if any) will also be deleted.\n\t * @param {App} app - The app to be removed.\n\t * @param {Group} [group] - The group from which the app should be removed. If not provided, the app is considered to be in favorites.\n\t * @returns {Promise<void>}\n\t * @private\n\t */\n\tprivate async _removeApp(app: App, group?: Group) {\n\t\tconst lastAppInGroup = group?.getApps()?.length === 1,\n\t\t\tgroupId = group?.getGroupId(),\n\t\t\tappId = app.getUrl(),\n\t\t\tviz = await this.appManagerInstance.getVisualization(appId, groupId);\n\t\tif (lastAppInGroup) {\n\t\t\t//if last app in group, then delete the group as well\n\t\t\tawait this._deleteGroup(groupId!);\n\t\t} else {\n\t\t\tlet visualizationsToBeDeleted = [viz?.visualization?.id];\n\t\t\tif (!groupId) {\n\t\t\t\t//for apps outside group i.e. for favorite apps delete duplicate apps as well\n\t\t\t\tvisualizationsToBeDeleted = visualizationsToBeDeleted.concat(\n\t\t\t\t\tviz?.persConfig?.duplicateApps?.map((viz) => viz.visualization?.id)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (viz?.persConfig?.sectionId && visualizationsToBeDeleted.length > 0) {\n\t\t\t\tawait this.appManagerInstance.removeVisualizations({\n\t\t\t\t\tsectionId: viz.persConfig.sectionId,\n\t\t\t\t\tvizIds: visualizationsToBeDeleted as string[]\n\t\t\t\t});\n\t\t\t\tvoid this._deletePersonalization({\n\t\t\t\t\tappId: appId,\n\t\t\t\t\toldAppId: viz?.oldAppId,\n\t\t\t\t\tsectionId: viz?.persConfig?.sectionId,\n\t\t\t\t\tisRecentlyAddedApp: viz?.persConfig?.isDefaultSection\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Handler for moving an app from a source group to a target group.\n\t * @param {sap.cux.home.App} app - The app to be moved.\n\t * @param {string} sourceGroupId - The ID of the source group from which the app is being moved.\n\t * @param {string | null} targetGroupId - The ID of the target group to which the app will be moved.\n\t * @private\n\t */\n\tprivate async _handleMoveToGroup(app: App, sourceGroupId?: string, targetGroupId?: string) {\n\t\tconst sourceGroup = sourceGroupId ? this._getGroup(sourceGroupId) : undefined,\n\t\t\tisLastAppInGroup = sourceGroup?.getApps()?.length === 1;\n\n\t\tif (isLastAppInGroup) {\n\t\t\tconst confirmationMessage = this._i18nBundle.getText(\"moveAppMessage\", [app.getTitle()]) as string;\n\t\t\tconst confirmationTitle = this._i18nBundle.getText(\"delete\") as string;\n\t\t\tMessageBox.show(confirmationMessage, {\n\t\t\t\ticon: MessageBox.Icon.WARNING,\n\t\t\t\ttitle: confirmationTitle,\n\t\t\t\tactions: [confirmationTitle, MessageBox.Action.CANCEL],\n\t\t\t\temphasizedAction: confirmationTitle,\n\t\t\t\tonClose: (action: string) => {\n\t\t\t\t\tif (action === confirmationTitle) {\n\t\t\t\t\t\tvoid this._moveAppAndHandleGroupChanges(app, sourceGroupId, targetGroupId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tawait this._moveAppAndHandleGroupChanges(app, sourceGroupId, targetGroupId);\n\t\t}\n\t}\n\n\t/**\n\t * Moves an app to a different group and handles group changes.\n\t * @param {App} app - The app to be moved.\n\t * @param {string} [sourceGroupId] - The ID of the source group from which the app is being moved.\n\t * @param {string} [targetGroupId] - The ID of the target group to which the app is being moved.\n\t * @returns {Promise<void>} - A Promise that resolves once the app is moved and group changes are handled.\n\t * @private\n\t */\n\tprivate async _moveAppAndHandleGroupChanges(app: App, sourceGroupId?: string, targetGroupId?: string) {\n\t\tconst sourceGroup = sourceGroupId ? this._getGroup(sourceGroupId) : null,\n\t\t\ttargetGroup = targetGroupId ? this._getGroup(targetGroupId) : null,\n\t\t\tsTargetGroupTile = targetGroup?.getTitle(),\n\t\t\tisLastAppInGroup = sourceGroup?.getApps()?.length === 1;\n\t\ttry {\n\t\t\tthis._setBusy(true);\n\t\t\tawait this._moveAppToGroup(app, sourceGroupId, targetGroupId);\n\t\t\t//delete group, if it is the last app in the group\n\t\t\tif (isLastAppInGroup) {\n\t\t\t\tawait this._deleteGroup(sourceGroupId as string);\n\t\t\t\tthis._closeGroupDetailDialog();\n\t\t\t} else if (sourceGroupId) {\n\t\t\t\tthis._refreshGroupDetailDialog(app);\n\t\t\t}\n\t\t\tconst sMsg = sTargetGroupTile\n\t\t\t\t? this._i18nBundle.getText(\"appMoved\", [sTargetGroupTile])\n\t\t\t\t: this._i18nBundle.getText(\"appUngrouped\");\n\t\t\tMessageToast.show(sMsg as string);\n\t\t\tawait this.refresh();\n\t\t} catch (error) {\n\t\t\tLog.error(error as string);\n\t\t} finally {\n\t\t\tthis._setBusy(false);\n\t\t}\n\t}\n\n\t/**\n\t * Refreshes the group detail dialog.\n\t * @param {sap.cux.home.App} updatedApp - The updated app control.\n\t * @param {boolean} [isRemove=true] - A flag indicating whether to remove the app. Defaults to true.\n\t * @private\n\t */\n\tprivate _refreshGroupDetailDialog(updatedApp: App, isRemove = true) {\n\t\tconst appsWrapper = this._controlMap.get(`${this.getId()}-detailDialog-apps`) as GridContainer;\n\t\tconst tiles = appsWrapper.getItems() as GenericTile[];\n\t\tconst group = updatedApp.getParent() as Group;\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\t\tconst groupApps = group.getApps();\n\t\tif (isRemove) {\n\t\t\tconst updatedAppIndex = groupApps.findIndex((groupApp) => groupApp.getUrl() === updatedApp.getUrl());\n\t\t\tif (updatedAppIndex > -1) {\n\t\t\t\tgroupApps[updatedAppIndex].destroy(true);\n\t\t\t\ttiles[updatedAppIndex].destroy(true);\n\t\t\t}\n\t\t} else {\n\t\t\t//update app color, along with duplicate apps, if any\n\t\t\tgroupApps.forEach((groupApp, index) => {\n\t\t\t\tif (groupApp.getUrl() === updatedApp.getUrl()) {\n\t\t\t\t\tgroupApp.setProperty(\"bgColor\", updatedApp.getBgColor(), true);\n\t\t\t\t\ttiles[index].setBackgroundColor(updatedApp.getBgColor());\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Moves an app from a source group to a target group.\n\t * @param {sap.cux.home.App} app - The app to be moved.\n\t * @param {string} sourceGroupId - The ID of the source group from which the app is being moved.\n\t * @param {string} targetGroupId - The ID of the target group to which the app will be moved. If null, the default section is considered.\n\t * @private\n\t */\n\tprivate async _moveAppToGroup(app: App, sourceGroupId?: string, targetGroupId?: string) {\n\t\tconst appId = app.getUrl();\n\t\tconst [visualizations, sections] = await Promise.all([\n\t\t\t\tthis.appManagerInstance.getSectionVisualizations(sourceGroupId),\n\t\t\t\tthis.appManagerInstance._getSections()\n\t\t\t]),\n\t\t\tsourceVisualization = visualizations.find((oViz) => oViz.url === appId),\n\t\t\tsourceVisualizationIndex = sourceVisualization?.persConfig?.visualizationIndex ?? -1,\n\t\t\tsourceSectionIndex = sourceVisualization?.persConfig?.sectionIndex as number;\n\t\tconst isTargetGroupDefault = !targetGroupId; //if group id is not passed, then we consider it as default section\n\t\tconst isSourceGroupDefault = !sourceGroupId;\n\t\tconst targetSectionIndex = sections.findIndex((section) => (!targetGroupId ? section.default : section.id === targetGroupId));\n\n\t\tif (sourceVisualization) {\n\t\t\tif (isTargetGroupDefault) {\n\t\t\t\tawait this._moveAppToDefaultGroup(sourceVisualization);\n\t\t\t} else {\n\t\t\t\tif (isSourceGroupDefault) {\n\t\t\t\t\t//remove duplicate apps\n\t\t\t\t\tawait this._removeDuplicateVisualizations(sourceVisualization);\n\t\t\t\t}\n\t\t\t\tawait this.appManagerInstance.moveVisualization({\n\t\t\t\t\tsourceSectionIndex: sourceSectionIndex,\n\t\t\t\t\tsourceVisualizationIndex: sourceVisualizationIndex,\n\t\t\t\t\ttargetSectionIndex: targetSectionIndex,\n\t\t\t\t\ttargetVisualizationIndex: -1\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst sections = await this.appManagerInstance._getSections(true);\n\t\t\tconst defaultSection = sections.find((oSection) => oSection.default);\n\t\t\tawait this._updateAppPersonalization([\n\t\t\t\t{\n\t\t\t\t\tvisualization: sourceVisualization,\n\t\t\t\t\ttargetGroupId: targetGroupId ?? defaultSection?.id,\n\t\t\t\t\tisTargetGroupDefault\n\t\t\t\t}\n\t\t\t]);\n\t\t}\n\t}\n\n\t/**\n\t * Moves a visualization to the default group.\n\t * @param {ICustomVisualization} visualization - The visualization to be moved to the default group.\n\t * @returns {Promise<void>} - A promise that resolves once the visualization is moved to the default group.\n\t * @private\n\t */\n\tprivate async _moveAppToDefaultGroup(visualization: ICustomVisualization) {\n\t\tawait this._addVisualization(visualization);\n\t\tif (visualization.persConfig?.sectionId && visualization.visualization?.id) {\n\t\t\tawait this.appManagerInstance.removeVisualizations({\n\t\t\t\tsectionId: visualization.persConfig?.sectionId,\n\t\t\t\tvizIds: [visualization.visualization?.id]\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Removes duplicate visualizations associated with a specific visualization.\n\t * @param {ICustomVisualization} visualization - The visualization for which duplicate visualizations should be removed.\n\t * @returns {Promise<void>} - A promise that resolves once duplicate visualizations are removed.\n\t * @private\n\t */\n\tprivate async _removeDuplicateVisualizations(visualization: ICustomVisualization) {\n\t\tconst vizIdsToBeDeleted = (visualization?.persConfig?.duplicateApps?.map((oViz) => oViz.visualization?.id) || []) as string[];\n\t\tif (visualization.persConfig?.sectionId && vizIdsToBeDeleted.length > 0) {\n\t\t\tawait this.appManagerInstance.removeVisualizations({\n\t\t\t\tsectionId: visualization.persConfig?.sectionId,\n\t\t\t\tvizIds: vizIdsToBeDeleted\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Handles the event for renaming a group.\n\t * Opens the group detail dialog in edit mode.\n\t * @private\n\t * @param {sap.ui.base.Event} event - The event object.\n\t */\n\tprivate _onRenameGroup(event: Event) {\n\t\tconst group = event.getSource<MenuItem>()?.getParent() as Group;\n\t\tvoid this._showGroupDetailDialog(group.getGroupId(), true);\n\t}\n\n\t/**\n\t * Event Handler for ungroup apps, shows confirmation dialog, ungroups the apps on confirmation\n\t * @param {sap.cux.home.Group} group - The group from which the apps will be ungrouped.\n\t * @private\n\t */\n\tprivate _handleUngroupApps(group: ISectionAndVisualization) {\n\t\tconst message = this._i18nBundle.getText(\"ungroupAppsMessage\", [group.title]) as string,\n\t\t\ttitle = this._i18nBundle.getText(\"delete\") as string,\n\t\t\tactionText = this._i18nBundle.getText(\"delete\") as string;\n\t\tMessageBox.show(message, {\n\t\t\ticon: MessageBox.Icon.WARNING,\n\t\t\ttitle: title,\n\t\t\tactions: [actionText, MessageBox.Action.CANCEL],\n\t\t\temphasizedAction: actionText,\n\t\t\tonClose: (action: string) => {\n\t\t\t\tif (action === actionText) {\n\t\t\t\t\tvoid this._ungroupApps(group.id!);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Handles the event for deleting a group.\n\t * Shows confirmation dialog to either delete the group and apps, or move the apps in favorites.\n\t * @private\n\t * @param {sap.ui.base.Event} event - The event object.\n\t */\n\tprivate _onDeleteGroup(event: Event) {\n\t\tconst group = event.getSource<MenuItem>()?.getParent() as Group,\n\t\t\tmessage = this._i18nBundle.getText(\"deleteGroupMessage\", [group.getTitle()]) as string,\n\t\t\ttitle = this._i18nBundle.getText(\"delete\") as string,\n\t\t\tdeleteAction = this._i18nBundle.getText(\"delete\") as string,\n\t\t\tmoveAppAction = this._i18nBundle.getText(\"moveApps\") as string;\n\t\tMessageBox.show(message, {\n\t\t\ticon: MessageBox.Icon.WARNING,\n\t\t\ttitle: title,\n\t\t\tactions: [deleteAction, this._i18nBundle.getText(\"moveApps\") as string, MessageBox.Action.CANCEL],\n\t\t\temphasizedAction: deleteAction,\n\t\t\tonClose: async (action: string) => {\n\t\t\t\tif (action === deleteAction) {\n\t\t\t\t\tthis._setBusy(true);\n\t\t\t\t\tawait this._deleteGroup(group.getGroupId());\n\t\t\t\t\tMessageToast.show(this._i18nBundle.getText(\"groupDeleted\") as string);\n\t\t\t\t\tvoid this.refresh();\n\t\t\t\t\tthis._closeGroupDetailDialog();\n\t\t\t\t\tthis._setBusy(false);\n\t\t\t\t} else if (action === moveAppAction) {\n\t\t\t\t\tvoid this._ungroupApps(group.getGroupId());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Ungroups apps from the specified group Id.\n\t * @async\n\t * @private\n\t * @param {string} groupId - The Id of the group from which apps will be ungrouped.\n\t * @returns {Promise<void>} - A Promise that resolves once the ungrouping process is complete.\n\t */\n\tprivate async _ungroupApps(groupId: string) {\n\t\tthis._setBusy(true);\n\t\ttry {\n\t\t\tconst visualizations = await this.appManagerInstance.getSectionVisualizations(groupId);\n\t\t\tconst sections = await this.appManagerInstance._getSections();\n\t\t\tconst section = sections.find((oSection) => oSection.id === groupId);\n\t\t\tawait Promise.all(visualizations.map((oViz) => this._addVisualization(oViz)));\n\t\t\tconst updatedSections = await this.appManagerInstance._getSections(true);\n\t\t\tconst defaultSection = updatedSections.find((oSection) => oSection.default);\n\t\t\t//update personalization\n\t\t\tawait this._updateAppPersonalization(\n\t\t\t\tvisualizations.map((oViz) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tvisualization: oViz,\n\t\t\t\t\t\ttargetGroupId: defaultSection?.id,\n\t\t\t\t\t\tisTargetGroupDefault: true\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t);\n\n\t\t\t//if preset section, then section shouldn't be deleted, instead remove visualizations inside section\n\t\t\tif (section?.preset) {\n\t\t\t\tawait this.appManagerInstance.removeVisualizations({\n\t\t\t\t\tsectionId: groupId,\n\t\t\t\t\tvizIds: visualizations.map((oViz) => oViz.visualization?.id) as string[]\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tawait this._deleteGroup(groupId);\n\t\t\t}\n\n\t\t\tMessageToast.show(this._i18nBundle.getText(\"appsUngrouped\") ?? \"\");\n\t\t\tawait this.refresh();\n\t\t} catch (error) {\n\t\t\tLog.error(error as string);\n\t\t\tMessageToast.show(this._i18nBundle.getText(\"unableToUngroupApps\") ?? \"\");\n\t\t} finally {\n\t\t\tthis._setBusy(false);\n\t\t\tthis._closeGroupDetailDialog();\n\t\t}\n\t}\n\n\t/**\n\t * Shows the detail dialog for a group.\n\t * @async\n\t * @param {string} groupId - The Id of the group.\n\t * @param {boolean} [editMode=false] - Whether to open the dialog in edit mode.\n\t * @private\n\t */\n\tprivate async _showGroupDetailDialog(groupId: string, editMode = false) {\n\t\tconst group = this._getGroup(groupId);\n\t\tif (!group) {\n\t\t\treturn;\n\t\t}\n\t\tthis._selectedGroupId = groupId;\n\t\tconst dialog = this._generateGroupDetailDialog();\n\t\t//set group icon\n\t\tconst groupIconControl = this._controlMap.get(`${this.getId()}-detailDialog-toolbar-color`) as Icon;\n\t\tgroupIconControl.setColor(Parameters.get({ name: group.getBgColor() }) as string);\n\t\t//set group apps\n\t\tawait this._setGroupDetailDialogApps(groupId);\n\t\tdialog.open();\n\t\t//set group title\n\t\tthis._setGroupNameControl(group.getTitle(), editMode);\n\t}\n\n\t/**\n\t * Sets the apps for the detail dialog for a group.\n\t * @async\n\t * @param {string} groupId - The Id of the group.\n\t * @returns {Promise<void>} - A Promise that resolves once the apps for the group detail dialog are set.\n\t * @private\n\t */\n\tprivate async _setGroupDetailDialogApps(groupId: string) {\n\t\tconst group = this._getGroup(groupId);\n\t\tif (group) {\n\t\t\tlet appVisualizations = await this.appManagerInstance.getSectionVisualizations(groupId, false);\n\t\t\tgroup.destroyAggregation(\"apps\", true);\n\t\t\tappVisualizations = appVisualizations.map((appVisualization, index) => {\n\t\t\t\treturn {\n\t\t\t\t\t...appVisualization,\n\t\t\t\t\tmenuItems: this._getAppActions(group, index, appVisualization) //add actions to show in group\n\t\t\t\t};\n\t\t\t});\n\t\t\tconst apps = this.generateApps(appVisualizations);\n\t\t\tconst appsWrapper = this._controlMap.get(`${this.getId()}-detailDialog-apps`) as GridContainer;\n\t\t\tthis._setAggregation(group, apps, \"apps\");\n\t\t\tappsWrapper.destroyItems();\n\t\t\tthis._setAggregation(\n\t\t\t\tappsWrapper,\n\t\t\t\tgroup.getApps().map((app) => (this.getParent() as AppsContainer)._getAppTile(app))\n\t\t\t);\n\t\t\tthis._applyGroupedAppsPersonalization(groupId);\n\t\t\tthis._dispatchAppsLoadedEvent(apps);\n\t\t}\n\t}\n\n\t/**\n\t * Applies personalization to the grouped apps within the specified group.\n\t * @param {string} groupId - The ID of the group to which the apps belong.\n\t * @private\n\t */\n\tprivate _applyGroupedAppsPersonalization(groupId: string) {\n\t\tconst appsWrapper = this._controlMap.get(`${this.getId()}-detailDialog-apps`) as GridContainer;\n\t\tconst tiles = (appsWrapper?.getItems() || []) as GenericTile[];\n\t\tvoid this._applyTilesPersonalization(tiles, groupId, false);\n\t}\n\n\t/**\n\t * Applies Deprecated Info for apps inside the group.\n\t * @param {App[]} apps - The ID of the group to which the apps belong.\n\t * @private\n\t */\n\tprivate _dispatchAppsLoadedEvent(apps: App[]) {\n\t\tconst appsWrapper = this._controlMap.get(`${this.getId()}-detailDialog-apps`) as GridContainer;\n\t\tconst tiles = (appsWrapper?.getItems() || []) as GenericTile[];\n\t\t(this.getParent() as AppsContainer).fireEvent(\"appsLoaded\", { apps, tiles });\n\t}\n\n\t/**\n\t * Generates the group detail dialog.\n\t * @private\n\t * @returns {sap.m.Dialog} The generated detail dialog for the group.\n\t */\n\tprivate _generateGroupDetailDialog() {\n\t\tconst id = `${this.getId()}-detailDialog`;\n\t\tif (!this._controlMap.get(id)) {\n\t\t\t//group color icon\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-toolbar-color`,\n\t\t\t\tnew Icon({\n\t\t\t\t\tid: `${id}-toolbar-color`,\n\t\t\t\t\tsrc: \"sap-icon://color-fill\",\n\t\t\t\t\tsize: \"1.25rem\"\n\t\t\t\t}).addStyleClass(\"sapUiTinyMarginEnd\")\n\t\t\t);\n\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-toolbar-title`,\n\t\t\t\tnew Title({\n\t\t\t\t\tid: `${id}-toolbar-title`,\n\t\t\t\t\tvisible: true\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tconst oGroupNameInput = new Input({\n\t\t\t\tid: `${id}-toolbar-title-edit`,\n\t\t\t\twidth: \"13.75rem\",\n\t\t\t\tvisible: false\n\t\t\t});\n\n\t\t\tthis._controlMap.set(`${id}-toolbar-title-edit`, oGroupNameInput);\n\n\t\t\toGroupNameInput.onsapfocusleave = () => {\n\t\t\t\tvoid this._onGroupEditName(oGroupNameInput.getValue());\n\t\t\t};\n\n\t\t\t//apps wrapper\n\t\t\tconst appsWrapper = new GridContainer({\n\t\t\t\tid: `${id}-apps`,\n\t\t\t\tlayout: new GridContainerSettings(`${id}-appsLayout`, {\n\t\t\t\t\tcolumnSize: \"19rem\",\n\t\t\t\t\tgap: \"0.5rem\"\n\t\t\t\t})\n\t\t\t}).addStyleClass(\"sapCuxAppsContainerBorder sapCuxAppsDetailContainerPadding\");\n\t\t\t// Add drag-and-drop config\n\t\t\tthis.addDragDropConfigTo(appsWrapper, (event) => this._onFavItemDrop(event, this._selectedGroupId));\n\t\t\tthis._controlMap.set(`${id}-apps`, appsWrapper);\n\t\t\t//add apps button\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-addAppsBtn`,\n\t\t\t\tnew Button(`${id}-addAppsBtn`, {\n\t\t\t\t\ttext: this._i18nBundle.getText(\"addApps\"),\n\t\t\t\t\ticon: \"sap-icon://action\",\n\t\t\t\t\tvisible: _showAddApps(),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tconst groupId = this._selectedGroupId;\n\t\t\t\t\t\tthis._closeGroupDetailDialog();\n\t\t\t\t\t\tthis._selectedGroupId = groupId;\n\t\t\t\t\t\tvoid this.navigateToAppFinder(groupId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew Dialog(id, {\n\t\t\t\t\tcontent: this._controlMap.get(`${id}-apps`) as HBox,\n\t\t\t\t\tcontentWidth: \"60.75rem\",\n\t\t\t\t\tendButton: new Button({\n\t\t\t\t\t\tid: `${id}-groupDetailCloseBtn`,\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"closeBtn\"),\n\t\t\t\t\t\tpress: this._closeGroupDetailDialog.bind(this)\n\t\t\t\t\t}),\n\t\t\t\t\tescapeHandler: this._closeGroupDetailDialog.bind(this),\n\t\t\t\t\tcustomHeader: new Toolbar(`${this.getId()}-toolbar`, {\n\t\t\t\t\t\tcontent: [\n\t\t\t\t\t\t\tthis._controlMap.get(`${id}-toolbar-color`) as Icon,\n\t\t\t\t\t\t\tthis._controlMap.get(`${id}-toolbar-title`) as Title,\n\t\t\t\t\t\t\tthis._controlMap.get(`${id}-toolbar-title-edit`) as Input,\n\t\t\t\t\t\t\tnew ToolbarSpacer({ id: `${this.getId()}-toolbarSpacer` }),\n\t\t\t\t\t\t\tthis._controlMap.get(`${id}-addAppsBtn`) as Button,\n\t\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\t\tid: \"overflowBtn\",\n\t\t\t\t\t\t\t\ticon: \"sap-icon://overflow\",\n\t\t\t\t\t\t\t\ttype: \"Transparent\",\n\t\t\t\t\t\t\t\tpress: (event) => {\n\t\t\t\t\t\t\t\t\tconst source = event.getSource<Button>();\n\t\t\t\t\t\t\t\t\tconst group = this._selectedGroupId ? this._getGroup(this._selectedGroupId) : null;\n\t\t\t\t\t\t\t\t\tconst groupActions = group?.getAggregation(\"menuItems\") as MenuItem[];\n\t\t\t\t\t\t\t\t\tconst oPopover = ActionsPopover.get(groupActions);\n\t\t\t\t\t\t\t\t\toPopover.openBy(source);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t})\n\t\t\t\t}).addStyleClass(\"sapCuxGroupDetailDialog\")\n\t\t\t);\n\t\t}\n\t\treturn this._controlMap.get(id) as Dialog;\n\t}\n\n\t/**\n\t * Closes the group detail dialog.\n\t * @private\n\t */\n\tprivate _closeGroupDetailDialog() {\n\t\tconst groupDetailDialog = this._controlMap.get(`${this.getId()}-detailDialog`) as Dialog;\n\t\tconst group = this._getGroup(this._selectedGroupId as string);\n\t\tgroup?.destroyApps();\n\t\tthis._selectedGroupId = undefined;\n\t\tgroupDetailDialog?.close();\n\t}\n\n\t/**\n\t * Updates the group name with new name.\n\t * This method is triggered on group name input focus leave.\n\t * @private\n\t * @async\n\t * @param {string} updatedTitle - The new title for the group.\n\t */\n\tprivate async _onGroupEditName(updatedTitle: string) {\n\t\tthis._setBusy(true);\n\t\tconst groupId = this._selectedGroupId,\n\t\t\tgroup = this._getGroup(groupId!),\n\t\t\toldTitle = group?.getTitle();\n\t\tif (updatedTitle && updatedTitle !== oldTitle) {\n\t\t\tawait this._renameGroup(groupId!, updatedTitle);\n\t\t\tgroup?.setProperty(\"title\", updatedTitle, true);\n\t\t\tvoid this.refresh();\n\t\t\tMessageToast.show(this._i18nBundle.getText(\"groupNameChanged\") || \"\");\n\t\t}\n\t\tthis._setGroupNameControl(updatedTitle, false);\n\t\tthis._setBusy(false);\n\t}\n\n\t/**\n\t * Renames a group.\n\t * @async\n\t * @param {string} groupId - The Id of the group to rename.\n\t * @param {string} updatedTitle - The new title for the group.\n\t * @returns {Promise<void>} A Promise that resolves once the group is renamed.\n\t */\n\tprivate async _renameGroup(groupId: string, updatedTitle: string) {\n\t\tconst pagesService = await Container.getServiceAsync<Pages>(\"Pages\");\n\t\tconst pageIndex = pagesService.getPageIndex(MYHOME_PAGE_ID),\n\t\t\tgroups = pagesService.getModel().getProperty(`/pages/${pageIndex}/sections/`) as ISection[],\n\t\t\tgroupIndex = groups.findIndex((group) => group.id === groupId);\n\t\tif (groupIndex > -1) {\n\t\t\tawait pagesService.renameSection(pageIndex, groupIndex, updatedTitle);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the group name control in the detail dialog.\n\t * Shows input control to edit the group name in edit mode, otherwise, shows group name as title control.\n\t * @private\n\t * @param {string} groupTitle - The title of the group.\n\t * @param {boolean} editMode - Whether the dialog is in edit mode.\n\t */\n\tprivate _setGroupNameControl(groupTitle: string, editMode: boolean) {\n\t\tconst groupDetailDialog = this._controlMap.get(`${this.getId()}-detailDialog`) as Dialog;\n\t\tconst groupTitleControl = this._controlMap.get(`${this.getId()}-detailDialog-toolbar-title`) as Title;\n\t\tconst groupInputControl = this._controlMap.get(`${this.getId()}-detailDialog-toolbar-title-edit`) as Input;\n\t\tgroupInputControl.setValue(groupTitle);\n\t\tgroupTitleControl.setText(groupTitle);\n\t\tgroupInputControl?.setVisible(editMode);\n\t\tgroupTitleControl?.setVisible(!editMode);\n\t\tif (editMode) {\n\t\t\t//in edit mode set the focus on input\n\t\t\tgroupDetailDialog.setInitialFocus(groupInputControl);\n\t\t}\n\t}\n\n\t/**\n\t * Generates the dialog for adding apps from insights.\n\t * @returns {sap.m.Dialog} The dialog for adding apps from insights.\n\t * @private\n\t */\n\tprivate _generateAddFromInsightsDialog() {\n\t\tconst id = `${this.getId()}-addFromInsightsDialog`;\n\n\t\tconst setAddBtnEnabled = () => {\n\t\t\tconst selectedItems = this._getSelectedInsights();\n\t\t\t(this._controlMap.get(`${id}-addBtn`) as Button).setEnabled(selectedItems.length > 0);\n\t\t};\n\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tconst getAppFinderBtn = (id: string, btnType?: ButtonType) => {\n\t\t\t\tconst appsAppFinder = new Button(id, {\n\t\t\t\t\ticon: \"sap-icon://action\",\n\t\t\t\t\ttext: this._i18nBundle.getText(\"appFinderBtn\"),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tthis._closeAddFromInsightsDialog();\n\t\t\t\t\t\tvoid this.navigateToAppFinder();\n\t\t\t\t\t},\n\t\t\t\t\tvisible: _showAddApps(),\n\t\t\t\t\ttype: btnType || ButtonType.Default\n\t\t\t\t});\n\t\t\t\taddFESRSemanticStepName(appsAppFinder, \"press\", \"appsAppFinder\");\n\t\t\t\treturn appsAppFinder;\n\t\t\t};\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-list`,\n\t\t\t\tnew List({\n\t\t\t\t\tid: `${id}-list`,\n\t\t\t\t\tmode: \"MultiSelect\",\n\t\t\t\t\tselectionChange: setAddBtnEnabled\n\t\t\t\t})\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-addBtn`,\n\t\t\t\tnew Button({\n\t\t\t\t\tid: `${id}-addBtn`,\n\t\t\t\t\ttext: this._i18nBundle.getText(\"addFromInsightsDialogBtn\"),\n\t\t\t\t\ttype: \"Emphasized\",\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tvoid this._addFromInsights();\n\t\t\t\t\t},\n\t\t\t\t\tenabled: false\n\t\t\t\t})\n\t\t\t);\n\t\t\tconst addStaticTiles = this._controlMap.get(`${id}-addBtn`) as Button;\n\t\t\taddFESRSemanticStepName(addStaticTiles, \"press\", \"addStaticTiles\");\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-errorMessage`,\n\t\t\t\tnew IllustratedMessage({\n\t\t\t\t\tid: `${id}-errorMessage`,\n\t\t\t\t\tillustrationSize: IllustratedMessageSize.Base,\n\t\t\t\t\ttitle: this._i18nBundle.getText(\"noAppsTitle\"),\n\t\t\t\t\tdescription: this._i18nBundle.getText(\"noDataMsgInsightTiles\"),\n\t\t\t\t\tvisible: true\n\t\t\t\t}).addStyleClass(\"sapUiLargeMarginTop\")\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew Dialog(id, {\n\t\t\t\t\ttitle: this._i18nBundle.getText(\"addFromInsights\"),\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew Label({\n\t\t\t\t\t\t\tid: `${id}-label`,\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"addFromInsightsDialogLabel\"),\n\t\t\t\t\t\t\twrapping: true\n\t\t\t\t\t\t}).addStyleClass(\"sapMTitleAlign sapUiTinyMarginTopBottom sapUiSmallMarginBeginEnd\"),\n\t\t\t\t\t\tnew HBox({\n\t\t\t\t\t\t\tid: `${id}-textContainer`,\n\t\t\t\t\t\t\tjustifyContent: \"SpaceBetween\",\n\t\t\t\t\t\t\talignItems: \"Center\",\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\tnew Title({\n\t\t\t\t\t\t\t\t\tid: `${id}-text`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"addFromInsightsDialogTitle\")\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tgetAppFinderBtn(`${id}-addAppsBtn`, ButtonType.Transparent)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginTop dialogHeader sapUiSmallMarginBeginEnd\"),\n\t\t\t\t\t\tthis._controlMap.get(`${id}-list`) as List,\n\t\t\t\t\t\tthis._controlMap.get(`${id}-errorMessage`) as IllustratedMessage\n\t\t\t\t\t],\n\t\t\t\t\tcontentWidth: \"42.75rem\",\n\t\t\t\t\tcontentHeight: \"32.5rem\",\n\t\t\t\t\tendButton: new Button({\n\t\t\t\t\t\tid: `${id}-addFromInsightsCloseBtn`,\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"closeBtn\"),\n\t\t\t\t\t\tpress: this._closeAddFromInsightsDialog.bind(this)\n\t\t\t\t\t}),\n\t\t\t\t\tescapeHandler: this._closeAddFromInsightsDialog.bind(this),\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tthis._controlMap.get(`${id}-addBtn`) as Button,\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\tid: `${id}-cancelBtn`,\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"cancelBtn\"),\n\t\t\t\t\t\t\tpress: this._closeAddFromInsightsDialog.bind(this)\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}).addStyleClass(\"sapContrastPlus sapCuxAddFromInsightsDialog\")\n\t\t\t);\n\t\t}\n\t\tsetAddBtnEnabled();\n\t\treturn this._controlMap.get(id) as Dialog;\n\t}\n\n\t/**\n\t * Handles the addition of apps from insights.\n\t * @returns {Promise<void>} A Promise that resolves when the operation is complete.\n\t * @private\n\t */\n\tprivate async _handleAddFromInsights() {\n\t\tconst appsToAdd = await this._getInsightTilesToAdd();\n\t\tconst dialog = this._generateAddFromInsightsDialog();\n\t\t(this._controlMap.get(`${this.getId()}-addFromInsightsDialog-errorMessage`) as IllustratedMessage)?.setVisible(\n\t\t\tappsToAdd.length === 0\n\t\t);\n\t\tthis._generateInsightListItems(appsToAdd);\n\t\tdialog.open();\n\t}\n\n\t/**\n\t * Generates list items for the provided apps and populates the list in the \"Add from Insights\" dialog.\n\t * @param {ICustomVisualization[]} apps - An array of custom visualizations representing the apps to be added.\n\t * @private\n\t */\n\tprivate _generateInsightListItems(apps: ICustomVisualization[]) {\n\t\tconst list = this._controlMap.get(`${this.getId()}-addFromInsightsDialog-list`) as List;\n\t\tif (apps.length) {\n\t\t\tlist.destroyItems();\n\t\t\tconst listItems = apps.map((app, index) => {\n\t\t\t\tconst bgColor = typeof app.BGColor === \"object\" && \"key\" in app.BGColor ? app.BGColor.key : app.BGColor;\n\t\t\t\treturn new CustomListItem({\n\t\t\t\t\tid: `${this.getId()}-addFromInsightsDialog-listItem-${index}`,\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew HBox({\n\t\t\t\t\t\t\tid: `${this.getId()}-addFromInsightsDialog-listItem-${index}-content`,\n\t\t\t\t\t\t\talignItems: \"Center\",\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\tnew Icon({\n\t\t\t\t\t\t\t\t\tid: `${this.getId()}-addFromInsightsDialog-listItem-${index}-content-icon`,\n\t\t\t\t\t\t\t\t\tsrc: app.icon,\n\t\t\t\t\t\t\t\t\tbackgroundColor: this._getLegendColor(bgColor || \"\").value,\n\t\t\t\t\t\t\t\t\tcolor: \"white\",\n\t\t\t\t\t\t\t\t\twidth: \"2.25rem\",\n\t\t\t\t\t\t\t\t\theight: \"2.25rem\",\n\t\t\t\t\t\t\t\t\tsize: \"1.25rem\"\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiRoundedBorder sapUiTinyMargin\"),\n\t\t\t\t\t\t\t\tnew ObjectIdentifier({\n\t\t\t\t\t\t\t\t\tid: `${this.getId()}-addFromInsightsDialog-listItem-${index}-content-identifier`,\n\t\t\t\t\t\t\t\t\ttitle: app.title,\n\t\t\t\t\t\t\t\t\ttext: app.subtitle,\n\t\t\t\t\t\t\t\t\ttooltip: app.title\n\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMargin\")\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t})\n\t\t\t\t\t.addStyleClass(\"sapUiContentPadding\")\n\t\t\t\t\t.data(\"vizId\", app.visualization?.vizId) as CustomListItem;\n\t\t\t});\n\t\t\tthis._setAggregation(list, listItems);\n\t\t}\n\t\tlist?.setVisible(apps.length !== 0);\n\t}\n\n\t/**\n\t * Retrieves the insight tiles to add.\n\t * @returns {Promise<ICustomVisualization[]>} A Promise that resolves with an array of insight tiles to add.\n\t * @private\n\t */\n\tprivate async _getInsightTilesToAdd() {\n\t\tconst [insightsApps, favoriteApps] = await Promise.all([\n\t\t\tthis.appManagerInstance.fetchInsightApps(true, this._i18nBundle.getText(\"insights\") as string),\n\t\t\tthis.appManagerInstance.fetchFavVizs(false, true)\n\t\t]); //check force refresh true?\n\t\t//find the visualizations that are present in insight tile but not in favorite apps\n\t\tconst appsToAdd = insightsApps.reduce((appsToAdd: ICustomVisualization[], insightsApp) => {\n\t\t\tif (!insightsApp.isCount && !insightsApp.isSmartBusinessTile) {\n\t\t\t\t// Check if App is not present in Fav Apps\n\t\t\t\tconst iAppIndex = favoriteApps.findIndex(\n\t\t\t\t\t(favoriteApp) =>\n\t\t\t\t\t\tfavoriteApp.visualization?.vizId === insightsApp.visualization?.vizId || favoriteApp.appId === insightsApp.appId\n\t\t\t\t);\n\t\t\t\tif (iAppIndex === -1) {\n\t\t\t\t\tappsToAdd.push(insightsApp);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn appsToAdd;\n\t\t}, []);\n\t\treturn this.appManagerInstance._filterDuplicateVizs(appsToAdd, false);\n\t}\n\n\t/**\n\t * Closes the dialog for adding apps from insights.\n\t * @private\n\t */\n\tprivate _closeAddFromInsightsDialog() {\n\t\tconst dialog = this._generateAddFromInsightsDialog();\n\t\tconst list = this._controlMap.get(`${this.getId()}-addFromInsightsDialog-list`) as List;\n\t\tlist.removeSelections();\n\t\tdialog?.close();\n\t}\n\n\t/**\n\t * Retrieves the selected insights from the dialog.\n\t * @returns {sap.m.ListItemBase[]} An array of selected insights.\n\t * @private\n\t */\n\tprivate _getSelectedInsights() {\n\t\tconst list = this._controlMap.get(`${this.getId()}-addFromInsightsDialog-list`) as List;\n\t\treturn list.getSelectedItems() || [];\n\t}\n\n\t/**\n\t * Adds apps from insights.\n\t * @returns {void}\n\t * @private\n\t */\n\tprivate async _addFromInsights() {\n\t\tthis._setBusy(true);\n\t\tconst selectedItems = this._getSelectedInsights();\n\t\tfor (const selectedItem of selectedItems) {\n\t\t\tawait this.appManagerInstance.addVisualization(selectedItem.data(\"vizId\") as string);\n\t\t}\n\t\tthis._closeAddFromInsightsDialog();\n\t\tMessageToast.show(\n\t\t\tthis._i18nBundle.getText(selectedItems.length === 1 ? \"addFromInsightTileSuccess\" : \"addFromInsightTilesSuccess\", [\n\t\t\t\tselectedItems.length\n\t\t\t]) as string\n\t\t);\n\t\tawait (this.getParent() as AppsContainer)._refreshAllPanels();\n\t\tthis._setBusy(false);\n\t}\n\n\t/**\n\t * Updates the personalization data for apps.\n\t * @param {IUpdatePersonalizationConfig[]} updateConfigs - The array of configurations for updating personalization.\n\t * @param {IUpdatePersonalizationConfig} updateConfig - Configuration object for updating personalization.\n\t * @param {ICustomVisualization} updateConfig.visualization - Visualization.\n\t * @param {string} updateConfig.color - The color to update for the app.\n\t * @param {boolean} updateConfig.isTargetGroupDefault - A flag indicating whether the target section is the default.\n\t * @param {string} [updateConfig.targetGroupId] - The Id of the target group. Defaults to source group Id if not provided.\n\t * @returns {Promise<void>} A promise that resolves when the personalization data is updated.\n\t * @private\n\t */\n\tprivate async _updateAppPersonalization(updateConfigs: IUpdatePersonalizationConfig[]) {\n\t\tconst personalizations = await this._getAppPersonalization();\n\n\t\tfor (const updateConfig of updateConfigs) {\n\t\t\tconst { visualization } = updateConfig;\n\t\t\tconst { persConfig } = visualization;\n\t\t\tconst sourceGroupId = persConfig?.sectionId;\n\t\t\tconst targetGroupId = updateConfig.targetGroupId ?? sourceGroupId;\n\n\t\t\tif (sourceGroupId !== targetGroupId) {\n\t\t\t\t//move app scenario\n\t\t\t\tthis._updateMoveAppPersonalization(personalizations, updateConfig);\n\t\t\t} else {\n\t\t\t\t//only color is updated\n\t\t\t\tthis._updateAppColorPersonalization(personalizations, updateConfig);\n\t\t\t}\n\t\t}\n\t\tawait this.setFavAppsPersonalization(personalizations);\n\t}\n\n\t/**\n\t * Updates the color personalization for an app.\n\t * @param {IAppPersonalization[]} personalizations - The array of app personalizations.\n\t * @param {IUpdatePersonalizationConfig} updateConfig - The update configuration.\n\t * @returns {void}\n\t * @private\n\t */\n\tprivate _updateAppColorPersonalization = (personalizations: IAppPersonalization[], updateConfig: IUpdatePersonalizationConfig) => {\n\t\tconst { visualization, color } = updateConfig;\n\t\tconst { appId, oldAppId, persConfig } = visualization;\n\t\tconst sourceGroupId = persConfig?.sectionId;\n\t\tconst isSourceGroupDefault = persConfig?.isDefaultSection;\n\t\tconst personalizationIndex = this._getPersonalizationIndex(personalizations, {\n\t\t\tappId,\n\t\t\toldAppId,\n\t\t\tsectionId: sourceGroupId,\n\t\t\tisRecentlyAddedApp: isSourceGroupDefault\n\t\t});\n\t\tif (personalizationIndex > -1) {\n\t\t\tpersonalizations[personalizationIndex].BGColor = color as string;\n\t\t} else {\n\t\t\tpersonalizations.push({\n\t\t\t\tBGColor: color as string,\n\t\t\t\tsectionId: sourceGroupId,\n\t\t\t\tisRecentlyAddedApp: isSourceGroupDefault as boolean,\n\t\t\t\tappId,\n\t\t\t\tisSection: false\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\t * Updates the personalization when an app is moved to a different group.\n\t * @param {IAppPersonalization[]} personalizations - The array of app personalizations.\n\t * @param {IUpdatePersonalizationConfig} updateConfig - The update configuration.\n\t * @returns {void}\n\t * @private\n\t */\n\tprivate _updateMoveAppPersonalization(personalizations: IAppPersonalization[], updateConfig: IUpdatePersonalizationConfig) {\n\t\tconst { visualization, isTargetGroupDefault } = updateConfig;\n\t\tconst { appId, oldAppId, persConfig } = visualization;\n\t\tconst sourceGroupId = persConfig?.sectionId;\n\t\tconst isSourceGroupDefault = persConfig?.isDefaultSection;\n\t\tconst duplicateApps = persConfig?.duplicateApps || [];\n\t\tconst targetGroupId = updateConfig.targetGroupId ?? sourceGroupId;\n\n\t\tconst sourcePersonalizationIndex = this._getPersonalizationIndex(personalizations, {\n\t\t\tappId,\n\t\t\toldAppId,\n\t\t\tsectionId: sourceGroupId,\n\t\t\tisRecentlyAddedApp: isSourceGroupDefault\n\t\t});\n\t\t//if personalization exists for app in source group\n\t\tif (sourcePersonalizationIndex > -1) {\n\t\t\tconst newPersonalization = {\n\t\t\t\t...personalizations[sourcePersonalizationIndex],\n\t\t\t\tsectionId: targetGroupId,\n\t\t\t\tisRecentlyAddedApp: isTargetGroupDefault,\n\t\t\t\tisSection: false\n\t\t\t} as IAppPersonalization;\n\t\t\t//if no duplicate apps in source group, clean up source group personlization\n\t\t\tif (duplicateApps.length === 0) {\n\t\t\t\tpersonalizations.splice(sourcePersonalizationIndex, 1);\n\t\t\t}\n\n\t\t\t//update target personalization\n\t\t\tconst iTargetPersonalizationIndex = this._getPersonalizationIndex(personalizations, {\n\t\t\t\tappId,\n\t\t\t\toldAppId,\n\t\t\t\tsectionId: targetGroupId,\n\t\t\t\tisRecentlyAddedApp: isTargetGroupDefault\n\t\t\t});\n\t\t\tif (iTargetPersonalizationIndex > -1) {\n\t\t\t\tpersonalizations.splice(iTargetPersonalizationIndex, 1); //clean up any existing personalization\n\t\t\t}\n\t\t\t//push new personalization for target group\n\t\t\tpersonalizations.push(newPersonalization);\n\t\t}\n\t}\n\n\t/**\n\t * Updates the personalization data for a group with the selected color.\n\t * @param {string} groupId - The ID of the group.\n\t * @param {string} selectedColor - The selected color for the group.\n\t * @returns {Promise<void>} A promise that resolves when the personalization data is updated.\n\t * @private\n\t */\n\tprivate async _updateGroupPersonalization(groupId: string, selectedColor: string) {\n\t\tconst personalizations = await this._getAppPersonalization();\n\t\tconst personalizationIndex = this._getPersonalizationIndex(personalizations, {\n\t\t\tisSection: true,\n\t\t\tsectionId: groupId\n\t\t});\n\t\tconst updatedPersonalization = {\n\t\t\tBGColor: selectedColor,\n\t\t\tisSection: true,\n\t\t\tsectionId: groupId,\n\t\t\tisRecentlyAddedApp: false\n\t\t};\n\t\tif (personalizationIndex > -1) {\n\t\t\t//if color is already present for the group, update the color\n\t\t\tpersonalizations[personalizationIndex] = updatedPersonalization;\n\t\t} else {\n\t\t\tpersonalizations.push(updatedPersonalization);\n\t\t}\n\t\tawait this.setFavAppsPersonalization(personalizations);\n\t}\n\n\t/**\n\t * Finds the index of personalization data matching the specified properties.\n\t * @param {IAppPersonalization[]} personalizations - The array of personalization data.\n\t * @param {IAppPersonalization} appPersonalization - The properties to match for finding the index.\n\t * @param {string} [appPersonalization.appId] -  id of the app.\n\t * @param {string} [appPersonalization.oldAppId] - old id of the app.\n\t * @param {string} [appPersonalization.sectionId] - id of the section.\n\t * @param {boolean} appPersonalization.isSection - A flag indicating whether the personalization is for a section.\n\t * @param {boolean} appPersonalization.isRecentlyAddedApp - A flag indicating whether the app is a recently added app.\n\t * @returns {number} The index of the matching personalization data, or -1 if not found.\n\t * @private\n\t */\n\tprivate _getPersonalizationIndex(personalizations: IAppPersonalization[], appPersonalization: IAppPersonalizationConfig) {\n\t\tconst { appId, oldAppId, sectionId, isSection, isRecentlyAddedApp } = appPersonalization;\n\t\treturn personalizations.findIndex((personalization) => {\n\t\t\tif (isSection) {\n\t\t\t\treturn personalization.sectionId === sectionId && personalization.isSection;\n\t\t\t} else {\n\t\t\t\treturn isRecentlyAddedApp\n\t\t\t\t\t? (personalization.appId === appId || personalization.appId === oldAppId) && personalization.isRecentlyAddedApp\n\t\t\t\t\t: (personalization.appId === appId || personalization.appId === oldAppId) && personalization.sectionId === sectionId;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Adds a visualization.\n\t * @param {object} oViz - The visualization to be added.\n\t * @param {object} oViz.visualization - The visualization object.\n\t * @param {boolean} [oViz.visualization.isBookmark=false] - Indicates if the visualization is a bookmark.\n\t * @param {string} [oViz.visualization.vizId] - The ID of the visualization if it's not a bookmark.\n\t * @returns {Promise<void>} A promise that resolves to void after the visualization is added.\n\t * @private\n\t */\n\tprivate _addVisualization(viz: ICustomVisualization, sSectionId?: string) {\n\t\tif (viz.visualization) {\n\t\t\treturn viz.visualization.isBookmark\n\t\t\t\t? this.appManagerInstance.addBookMark(viz.visualization)\n\t\t\t\t: this.appManagerInstance.addVisualization(viz.visualization.vizId, sSectionId);\n\t\t}\n\t\treturn Promise.reject(new Error(\"No visualization provided to add\"));\n\t}\n\n\t/**\n\t * Deletes a group.\n\t * @param {string} groupId - The Id of the group to delete.\n\t * @returns {Promise<void>} A Promise that resolves once the group is deleted.\n\t * @private\n\t */\n\tprivate async _deleteGroup(groupId: string) {\n\t\tconst pagesService = await Container.getServiceAsync<Pages>(\"Pages\");\n\t\tconst pageIndex = pagesService.getPageIndex(MYHOME_PAGE_ID),\n\t\t\tgroups = pagesService.getModel().getProperty(`/pages/${pageIndex}/sections/`) as ISection[],\n\t\t\tgroupIndex = groups.findIndex((group) => group.id === groupId);\n\t\tif (groupIndex > -1) {\n\t\t\tawait pagesService.deleteSection(pageIndex, groupIndex);\n\t\t\tvoid this._deletePersonalization({ sectionId: groupId, isSection: true });\n\t\t}\n\t}\n\n\t/**\n\t * Deletes personalization data based on the specified properties.\n\t * @param {IAppPersonalizationConfig} personalizationConfig - The properties to identify the personalization data to delete.\n\t * @param {boolean} [personalizationConfig.isSection] - A flag indicating whether the personalization is for a group.\n\t * @param {string} [appPersonalization.appId] -  id of the app.\n\t * @param {string} [appPersonalization.oldAppId] - old id of the app.\n\t * @param {string} personalizationConfig.sectionId - The ID of the group associated with the personalization.\n\t * @param {boolean} [appPersonalization.isRecentlyAddedApp] - A flag indicating whether the app is a recently added app.\n\t * @returns {Promise<void>} A promise that resolves when the personalization data is deleted.\n\t * @private\n\t */\n\tprivate async _deletePersonalization(personalizationConfig: IAppPersonalizationConfig) {\n\t\tconst { isSection, sectionId } = personalizationConfig;\n\t\tlet personalizations = await this._getAppPersonalization();\n\n\t\tif (!isSection) {\n\t\t\tconst personalizationIndex = this._getPersonalizationIndex(personalizations, personalizationConfig);\n\t\t\tif (personalizationIndex > -1) {\n\t\t\t\tpersonalizations.splice(personalizationIndex, 1);\n\t\t\t}\n\t\t} else {\n\t\t\t// Delete personalizations for all associated apps if a group is deleted\n\t\t\tpersonalizations = personalizations.filter((personalization) => personalization.sectionId !== sectionId);\n\t\t}\n\n\t\tvoid this.setFavAppsPersonalization(personalizations);\n\t}\n\n\t/**\n\t * Handles the press event of a group.\n\t * @param {Group$PressEvent} event - The press event object.\n\t * @private\n\t */\n\tprivate _handleGroupPress(event: Group$PressEvent) {\n\t\tconst groupId = event.getParameter(\"groupId\");\n\t\tif (groupId) {\n\t\t\tvoid this._showGroupDetailDialog(groupId);\n\t\t}\n\t}\n\n\t/**\n\t * Handles keyboard events for cutting and moving applications.\n\t * When the Cmd (Mac) or Ctrl (Windows) key is pressed along with 'x', the currently selected element is cut.\n\t * When the Cmd (Mac) or Ctrl (Windows) key is pressed along with 'v':\n\t * - If the operation is performed on a group, the previously cut application is moved into the group.\n\t * - If the operation is performed on an application, the create group dialog is opened.\n\t * @param {KeyboardEvent} event - The keyboard event object.\n\t * @param {string} [appGroupId] - The group Id of the app, if app belongs to a group.\n\t * @returns {Promise<void>} A Promise that resolves when app is moved to a group or create group dialog is opened.\n\t * @private\n\t */\n\tprivate async _handleKeyboardMoveApp(event: KeyboardEvent, appGroupId?: string) {\n\t\tconst currentItem = Element.closestTo((event.target as HTMLElement).firstElementChild as HTMLElement) as GenericTile & {\n\t\t\t_oMoreIcon: Button;\n\t\t};\n\t\tconst container = currentItem.getParent() as GridContainer;\n\t\tif (event.metaKey || event.ctrlKey) {\n\t\t\t// ctrl(windows)/cmd (mac) + x, sets app to be moved to a group, or to create a group\n\t\t\tif (event.key === \"x\" && !currentItem.data(\"groupId\") && !this._cutApp && !appGroupId) {\n\t\t\t\tcurrentItem.$().css(\"opacity\", 0.6);\n\t\t\t\tcurrentItem._oMoreIcon.setEnabled(false);\n\t\t\t\tthis._cutApp = currentItem;\n\t\t\t}\n\n\t\t\tif (event.key === \"v\" && this._cutApp && !appGroupId) {\n\t\t\t\tconst dragDropEvent = new Event(\"keyboardDragDropEvent\", container, {\n\t\t\t\t\tdraggedControl: this._cutApp,\n\t\t\t\t\tdroppedControl: currentItem,\n\t\t\t\t\tdropPosition: dnd.RelativeDropPosition.On\n\t\t\t\t});\n\t\t\t\tawait this._onFavItemDrop(dragDropEvent);\n\t\t\t\tthis._cutApp = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Cancels the cut operation when clicked outside apps section or when focus moves out of apps section.\n\t * @param {MouseEvent | KeyboardEvent} event - The mouse or keyboard event triggering the reset.\n\t * @private\n\t */\n\tprivate _resetCutElement(event: MouseEvent | KeyboardEvent) {\n\t\tconst appsWrapperId = this._generateAppsWrapper().getId();\n\t\tif (!(event.target as HTMLElement).id.includes(appsWrapperId)) {\n\t\t\tthis._cutApp?.$().css(\"opacity\", \"\");\n\t\t\tthis._cutApp = undefined;\n\t\t}\n\t}\n\n\t/**\n\t * Generates illustrated message for favorite apps panel.\n\t * @private\n\t * @override\n\t * @returns {sap.m.IllustratedMessage} Illustrated error message.\n\t */\n\tprotected generateIllustratedMessage() {\n\t\tconst illustratedMessage = super.generateIllustratedMessage();\n\t\t//overrride the default title and add additional content\n\t\tillustratedMessage.setDescription(this._i18nBundle.getText(\"noFavAppsDescription\"));\n\t\tillustratedMessage.setIllustrationSize(IllustratedMessageSize.Small);\n\t\tillustratedMessage.setIllustrationType(IllustratedMessageType.AddingColumns);\n\t\tillustratedMessage.addAdditionalContent(\n\t\t\tnew Button(`${this.getId()}-errorMessage-addApps`, {\n\t\t\t\ttext: this._i18nBundle.getText(\"addApps\"),\n\t\t\t\ttooltip: this._i18nBundle.getText(\"addAppsTooltip\"),\n\t\t\t\ticon: \"sap-icon://action\",\n\t\t\t\tvisible: _showAddApps(),\n\t\t\t\tpress: () => {\n\t\t\t\t\tvoid this.navigateToAppFinder();\n\t\t\t\t},\n\t\t\t\ttype: \"Emphasized\"\n\t\t\t})\n\t\t);\n\t\treturn illustratedMessage;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}