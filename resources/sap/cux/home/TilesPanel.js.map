{"version":3,"file":"TilesPanel.js","names":["sap","ui","define","Log","GridContainer","GridContainerItemLayoutData","Button","CustomListItem","Dialog","GenericTile","HBox","HeaderContainer","IllustratedMessage","IllustratedMessageSize","IllustratedMessageType","Label","List","ObjectIdentifier","Title","VBox","sap_m_library","EventBus","Icon","Lib","JSONModel","Config","Container","S4MyHome","__BasePanel","__MenuItem","___utils_Accessibility","__AppManager","___utils_Constants","___utils_DataFormatUtils","___utils_Device","___utils_DragDropUtils","___utils_FESRUtil","___utils_InsightsUtils","_interopRequireDefault","obj","__esModule","default","_catch","body","recover","result","e","then","ButtonType","_finallyRethrows","finalizer","bind","LoadState","BasePanel","MenuItem","checkPanelExists","AppManager","DEFAULT_BG_COLOR","END_USER_COLORS","MYHOME_PAGE_ID","MYINSIGHT_SECTION_ID","SETTINGS_PANELS_KEYS","recycleId","DeviceType","fetchElementProperties","focusDraggedItem","addFESRId","addFESRSemanticStepName","FESR_EVENTS","createShowMoreActionButton","createShowMoreMenuItem","getAssociatedFullScreenMenuItem","sortMenuItems","tilesMenuItems","tilesContainerMenuItems","tilesActionButtons","tilesContainerActionButtons","DisplayFormat","favAppPanelName","appsConatinerlName","sortedMenuItems","REFRESH","ADD_APPS","EDIT_TILES","_showAddApps","last","StandardTileWidth","StandardWideTileWidth","Gap","TilesPanel","extend","metadata","library","properties","title","type","group","defaultValue","visibility","key","fullScreenName","defaultAggregation","aggregations","tiles","multiple","singularName","events","handleHidePanel","parameters","handleUnhidePanel","constructor","_constructor","id","settings","BasePanel.prototype.constructor.call","this","_insightsSectionTitle","_i18nBundle","getText","_addFromFavDialogId","getId","_headerVisible","init","_init","_this","BasePanel.prototype.init.call","_controlMap","Map","_oData","activateInsightsTiles","activateInsightsTilesOnPhone","activateInsightsTilesOnDesktop","_controlModel","appManagerInstance","getInstance","setProperty","refreshMenuItem","_createRefreshMenuItem","editTilesMenuItem","_createEditTilesMenuItem","menuItems","forEach","menuItem","addAggregation","_sortMenuItems","addTilesButton","_createAddTilesButton","ADD_TILES","actionButtons","actionButton","_createTilesFlexWrapper","getServiceAsync","VizInstantiationService","catch","error","Error","message","String","oEventBus","subscribe","sChannelId","sEventId","oData","Promise","resolve","createInsightSection","_addSectionViz","refreshData","_adjustLayout","_importdone","reject","_toggleTileActivity","_this2","toggleUserActions","event","show","getParameter","_temp2","_temp","_appSwitched","attachRouteMatched","warning","aSectionViz","sSectionId","reduce","promiseChain","oViz","isBookmark","addBookMark","addVisualization","vizId","stateData","status","publish","_showPlaceHolders","placeholderArray","Array","_calculatePlaceholderTileCount","fill","Loading","aInsightsApps","map","tileState","index","sizeBehavior","state","frameType","mode","visible","renderOnThemeChange","ariaRole","dropAreaOffset","setLayoutData","columns","_clearPlaceHolders","renderPanel","_renderPanel","_exit","_this3","_temp4","_result","_temp3","container","getParent","addFromFavAppMenuItem","_createAddFromFavMenuItem","_await$_this3$refresh","fireHandleHidePanel","_wasThrown","fireEvent","panelMenuItems","getAggregation","removeAllAggregation","_refreshData","refreshTiles","arguments","length","undefined","_this4","panelName","getMetadata","getName","fetchInsightApps","_this4$appManagerInst","_temp6","fireHandleUnhidePanel","isMobile","getDeviceType","Mobile","tilesMobileContainer","tilesContainer","sDefaultAggreName","getDefaultAggregationName","dynamicTiles","refresh","_getInsightsContainer","updatePanelsItemCount","bIsSmartBusinessTilePresent","some","oApp","isSmartBusinessTile","_temp5","load","name","_tilesWrapper","renderType","width","items","_createMobileFlexWrapper","_createWrapperFlexBox","setModel","_addContent","scrollStep","scrollStepByItem","gridLayout","scrollTime","showDividers","addStyleClass","_attachAggregationToContainer","_updateTilesActivity","isPhoneScreen","bActivateInsightsTiles","Boolean","getProperty","bindAggregation","path","factory","context","getObject","oVisualization","instantiateVisualization","visualization","minRows","getDisplayFormat","Standard","bindProperty","_setDropAreaRectFunction","addDragDropConfigTo","oEvent","_handleTilesDnd","tilesDropAreaOffset","Object","defineProperty","value","domRef","getDomRef","mDropRect","getBoundingClientRect","left","right","top","bottom","height","sInsertPosition","oDragItem","oDropItem","iDragItemIndex","indexOfItem","iDropItemIndex","_DragnDropTiles","_this5","oDisplacedItem","oItemMoved","splice","moveConfigs","pageId","sourceSectionIndex","persConfig","sectionIndex","sourceVisualizationIndex","visualizationIndex","targetSectionIndex","targetVisualizationIndex","moveVisualization","setTimeout","handleEditTiles","_handleEditTiles","parent","getSource","isA","_getLayout","openSettingsDialog","INSIGHTS_TILES","handleHideHeader","_handleHideHeader","_toggleHeaderActions","handleAddHeader","_handleAddHeader","_closeAddFromFavDialog","list","get","removeSelections","close","navigateToAppFinder","_navigateToAppFinder","groupId","navigationService","navigationObject","pageID","sectionID","navigate","target","shellHash","JSON","stringify","_getLegendColor","color","find","oColor","_handleAddFromFavApps","_this6","_getFavToAdd","appsToAdd","dialog","_generateAddFromFavAppsDialog","setVisible","_generateAddFromFavAppsListItems","open","_this7","fetchFavVizs","aFavApps","aDynamicApps","filter","oDynApp","isCount","aFilteredFavApps","iAppIndex","findIndex","oInsightApps","targetURL","_getSelectedInsights","getSelectedItems","destroyItems","listItems","app","content","alignItems","src","icon","backgroundColor","BGColor","size","text","subtitle","tooltip","data","item","addItem","setAddBtnEnabled","selectedItems","setEnabled","getAppFinderBtn","btnType","appFinderBtn","press","Default","PRESS","set","selectionChange","addButton","_addFromFavApps","enabled","illustrationSize","Small","illustrationType","AddDimensions","description","wrapping","justifyContent","Transparent","contentWidth","contentHeight","endButton","escapeHandler","buttons","_this8","setBusy","promise","oMovingConfig","insightsSectionIndex","displayFormatHint","supportedDisplayFormats","includes","_temp7","_calculateVisibleTileCount","insightsApps","layout","layoutDomRef","apps","count","isHeaderVisible","sectionNodeIndex","sectionDomRef","childNodes","domProperties","availableWidth","widthMap","StandardWide","nextTileWidth","Math","floor","isMobileDevice","visibleTileCount","isElementExpanded","_getCurrentExpandedElementName","slice","showFullScreenButton","toggleActionButton","toggleFullScreenElements","fullScreenButton","fullScreenText","getTitle","updateMenuItem","SHOW_MORE","updateActionButton","insightsContainer","getContainerMenuItems","_getContainerMenuItems","_containerMenuItems","containerRefresh","containerEditTiles","containerShowMore","containerAddFromFav","getContainerActionButtons","_getContainerActionButtons","_containerActionButtons","push","containerFullScreenActionButton","fesrId","_this9","_temp8","bShow","toggleMenuListItem"],"sources":["TilesPanel.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\n\nimport Log from \"sap/base/Log\";\nimport GridContainer from \"sap/f/GridContainer\";\nimport GridContainerItemLayoutData from \"sap/f/GridContainerItemLayoutData\";\nimport Button from \"sap/m/Button\";\nimport CustomListItem from \"sap/m/CustomListItem\";\nimport Dialog from \"sap/m/Dialog\";\nimport FlexBox from \"sap/m/FlexBox\";\nimport GenericTile from \"sap/m/GenericTile\";\nimport HBox from \"sap/m/HBox\";\nimport HeaderContainer from \"sap/m/HeaderContainer\";\nimport IllustratedMessage from \"sap/m/IllustratedMessage\";\nimport IllustratedMessageSize from \"sap/m/IllustratedMessageSize\";\nimport IllustratedMessageType from \"sap/m/IllustratedMessageType\";\nimport Label from \"sap/m/Label\";\nimport List from \"sap/m/List\";\nimport ObjectIdentifier from \"sap/m/ObjectIdentifier\";\nimport Title from \"sap/m/Title\";\nimport VBox from \"sap/m/VBox\";\nimport { ButtonType, LoadState } from \"sap/m/library\";\nimport Event from \"sap/ui/base/Event\";\nimport ManagedObject from \"sap/ui/base/ManagedObject\";\nimport Control from \"sap/ui/core/Control\";\nimport type { MetadataOptions } from \"sap/ui/core/Element\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport EventBus from \"sap/ui/core/EventBus\";\nimport Icon from \"sap/ui/core/Icon\";\nimport Lib from \"sap/ui/core/Lib\";\nimport { DropInfo$DropEventParameters } from \"sap/ui/core/dnd/DropInfo\";\nimport Context from \"sap/ui/model/Context\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport Config from \"sap/ushell/Config\";\nimport Container from \"sap/ushell/Container\";\nimport S4MyHome from \"sap/ushell/api/S4MyHome\";\nimport Navigation from \"sap/ushell/services/Navigation\";\nimport VisualizationInstantiation from \"sap/ushell/services/VisualizationInstantiation\";\nimport BaseContainer from \"./BaseContainer\";\nimport BasePanel from \"./BasePanel\";\nimport InsightsContainer from \"./InsightsContainer\";\nimport MenuItem from \"./MenuItem\";\nimport { $TilesPanelSettings } from \"./TilesPanel\";\nimport { ICustomVisualization, ISectionAndVisualization, IVisualization } from \"./interface/AppsInterface\";\nimport { checkPanelExists } from \"./utils/Accessibility\";\nimport AppManager from \"./utils/AppManager\";\nimport { DEFAULT_BG_COLOR, END_USER_COLORS, MYHOME_PAGE_ID, MYINSIGHT_SECTION_ID, SETTINGS_PANELS_KEYS } from \"./utils/Constants\";\nimport { recycleId } from \"./utils/DataFormatUtils\";\nimport { DeviceType, fetchElementProperties } from \"./utils/Device\";\nimport { focusDraggedItem } from \"./utils/DragDropUtils\";\nimport { addFESRId, addFESRSemanticStepName, FESR_EVENTS } from \"./utils/FESRUtil\";\nimport { createShowMoreActionButton, createShowMoreMenuItem, getAssociatedFullScreenMenuItem, sortMenuItems } from \"./utils/InsightsUtils\";\n\nexport enum tilesMenuItems {\n\tREFRESH = \"tiles-refresh\",\n\tADD_APPS = \"tiles-addSmartApps\",\n\tEDIT_TILES = \"tiles-editTiles\"\n}\n\nexport enum tilesContainerMenuItems {\n\tREFRESH = \"container-tiles-refresh\",\n\tADD_APPS = \"container-tiles-addSmartApps\",\n\tEDIT_TILES = \"container-tiles-editTiles\",\n\tSHOW_MORE = \"tilesContainerFullScreenMenuItem\"\n}\n\nexport enum tilesActionButtons {\n\tADD_TILES = \"tiles-addTilesButton\"\n}\n\nexport enum tilesContainerActionButtons {\n\tADD_TILES = \"container-tiles-addTilesButton\",\n\tSHOW_MORE = \"tilesContanerFullScreenActionButton\"\n}\n\nexport enum DisplayFormat {\n\tStandard = \"standard\",\n\tStandardWide = \"standardWide\"\n}\n\nconst favAppPanelName: string = \"sap.cux.home.FavAppPanel\";\nconst appsConatinerlName: string = \"sap.cux.home.AppsContainer\";\n\nconst sortedMenuItems: (tilesMenuItems | string)[] = [\n\ttilesMenuItems.REFRESH,\n\ttilesMenuItems.ADD_APPS,\n\ttilesMenuItems.EDIT_TILES,\n\t\"showMore\",\n\t\"settings\"\n];\n\nconst _showAddApps = () => {\n\treturn (Config.last(\"/core/shell/enablePersonalization\") || Config.last(\"/core/catalog/enabled\")) as boolean;\n};\n\nconst StandardTileWidth = 176;\nconst StandardWideTileWidth = 368;\nconst Gap = 16;\n\n/**\n *\n * Tiles Panel class for managing and storing Insights Tiles.\n *\n * @extends sap.cux.home.BasePanel\n *\n * @author SAP SE\n * @version 0.0.1\n * @since 1.122.0\n *\n * @internal\n * @experimental Since 1.122\n * @public\n *\n * @alias sap.cux.home.TilesPanel\n */\n\nexport default class TilesPanel extends BasePanel {\n\tconstructor(idOrSettings?: string | $TilesPanelSettings);\n\tconstructor(id?: string, settings?: $TilesPanelSettings);\n\t/**\n\t * Constructor for a new Tiles Panel.\n\t *\n\t * @param {string} [id] ID for the new control, generated automatically if an ID is not provided\n\t * @param {object} [settings] Initial settings for the new control\n\t */\n\tpublic constructor(id?: string, settings?: $TilesPanelSettings) {\n\t\tsuper(id, settings);\n\t}\n\tprivate _oData!: Record<string, unknown>;\n\tprivate readonly _insightsSectionTitle: string = this._i18nBundle.getText(\"insights\") as string;\n\tprivate readonly _addFromFavDialogId: string = `${this.getId()}-addFromFavDialog`;\n\tprivate appManagerInstance!: AppManager;\n\tprivate VizInstantiationService!: VisualizationInstantiation;\n\tprivate tilesContainer!: GridContainer;\n\tprivate tilesMobileContainer!: HeaderContainer;\n\tprivate _tilesWrapper!: VBox;\n\tprivate aInsightsApps!: ICustomVisualization[] | GenericTile[];\n\tprivate _controlModel!: JSONModel;\n\tpublic _controlMap!: Map<string, Control | Element | UI5Element>;\n\tprivate _containerMenuItems!: MenuItem[];\n\tprivate _containerActionButtons!: Button[];\n\tprivate oEventBus!: EventBus;\n\tprivate insightsContainer!: InsightsContainer;\n\tprivate _appSwitched!: boolean;\n\tprivate _headerVisible: boolean = false;\n\tstatic readonly metadata: MetadataOptions = {\n\t\tlibrary: \"sap.cux.home\",\n\t\tproperties: {\n\t\t\t/**\n\t\t\t * Title for the tiles panel\n\t\t\t */\n\t\t\ttitle: { type: \"string\", group: \"Misc\", defaultValue: \"\", visibility: \"hidden\" },\n\t\t\t/**\n\t\t\t * Key for the tiles panel\n\t\t\t */\n\t\t\tkey: { type: \"string\", group: \"Misc\", defaultValue: \"\", visibility: \"hidden\" },\n\t\t\t/**\n\t\t\t * The name of the URL parameter used to expand the container into full-screen mode.\n\t\t\t */\n\t\t\tfullScreenName: { type: \"string\", group: \"Misc\", defaultValue: \"SI1\", visibility: \"hidden\" }\n\t\t},\n\t\tdefaultAggregation: \"tiles\",\n\t\taggregations: {\n\t\t\t/**\n\t\t\t * Aggregation of tiles available within the tiles Panel\n\t\t\t */\n\t\t\ttiles: { type: \"sap.cux.home.App\", multiple: true, singularName: \"tile\", visibility: \"hidden\" }\n\t\t},\n\t\tevents: {\n\t\t\thandleHidePanel: {\n\t\t\t\tparameters: {}\n\t\t\t},\n\t\t\thandleUnhidePanel: {\n\t\t\t\tparameters: {}\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Initializes the Tiles Panel.\n\t *\n\t * @private\n\t * @override\n\t */\n\tinit() {\n\t\tsuper.init();\n\t\tthis._controlMap = new Map();\n\t\t//Initialise Tiles Model\n\t\tthis._oData = {\n\t\t\ttiles: [] as ICustomVisualization[],\n\t\t\tactivateInsightsTiles: true,\n\t\t\tactivateInsightsTilesOnPhone: false,\n\t\t\tactivateInsightsTilesOnDesktop: false\n\t\t};\n\t\tthis._controlModel = new JSONModel(this._oData);\n\t\tthis.appManagerInstance = AppManager.getInstance();\n\t\tthis.setProperty(\"key\", \"tiles\");\n\t\tthis.setProperty(\"enableFullScreen\", true);\n\t\tconst refreshMenuItem = this._createRefreshMenuItem(tilesMenuItems.REFRESH, \"tilesRefresh\");\n\t\tconst editTilesMenuItem = this._createEditTilesMenuItem(tilesMenuItems.EDIT_TILES, \"manageTiles\");\n\n\t\tconst menuItems = [refreshMenuItem, editTilesMenuItem];\n\t\tmenuItems.forEach((menuItem) => this.addAggregation(\"menuItems\", menuItem));\n\t\tthis._sortMenuItems(sortedMenuItems);\n\n\t\tconst addTilesButton = this._createAddTilesButton(tilesActionButtons.ADD_TILES, \"addTiles\");\n\n\t\tconst actionButtons = [addTilesButton];\n\t\tactionButtons.forEach((actionButton) => this.addAggregation(\"actionButtons\", actionButton));\n\n\t\tthis._createTilesFlexWrapper();\n\t\tContainer.getServiceAsync<VisualizationInstantiation>(\"VisualizationInstantiation\")\n\t\t\t.then((VizInstantiationService) => {\n\t\t\t\tthis.VizInstantiationService = VizInstantiationService;\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tLog.error(error instanceof Error ? error.message : String(error));\n\t\t\t});\n\n\t\tthis.oEventBus = EventBus.getInstance();\n\t\t// Subscribe to the event\n\t\tthis.oEventBus.subscribe(\n\t\t\t\"importChannel\",\n\t\t\t\"tilesImport\",\n\t\t\tasync (sChannelId?: string, sEventId?: string, oData?) => {\n\t\t\t\tawait this.appManagerInstance.createInsightSection(this._i18nBundle.getText(\"insightsTiles\") as string);\n\t\t\t\tawait this._addSectionViz(oData as IVisualization[], MYINSIGHT_SECTION_ID);\n\t\t\t\tawait this.refreshData();\n\t\t\t\tthis._adjustLayout();\n\t\t\t\tthis._importdone();\n\t\t\t},\n\t\t\tthis\n\t\t);\n\n\t\t// Toggles the activity of tiles\n\t\tthis._toggleTileActivity();\n\t}\n\n\t/**\n\t * Toggles the activity of tiles on route change.\n\t *\n\t * @private\n\t * @returns {void}\n\t */\n\tprivate _toggleTileActivity(): void {\n\t\tconst toggleUserActions = async (event: Event<{ isMyHomeRoute: boolean }>) => {\n\t\t\tconst show = event.getParameter(\"isMyHomeRoute\");\n\t\t\tthis._controlModel.setProperty(\"/activateInsightsTiles\", show);\n\t\t\tif (show) {\n\t\t\t\tif (this._appSwitched) {\n\t\t\t\t\tawait this.refreshData(true);\n\t\t\t\t\tthis._appSwitched = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._appSwitched = true;\n\t\t\t}\n\t\t};\n\n\t\ttry {\n\t\t\tS4MyHome.attachRouteMatched({}, toggleUserActions, this);\n\t\t} catch (error) {\n\t\t\tLog.warning(error instanceof Error ? error.message : String(error));\n\t\t}\n\t}\n\n\t/**\n\t * Takes the visualizations and add it to the provided section id\n\t * @param {IVisualization[]} aSectionViz - array of visualizations\n\t * @param {string} sSectionId - section id where the visualizations to be added\n\t * @returns {any}\n\t */\n\tprivate _addSectionViz(aSectionViz: IVisualization[], sSectionId: string) {\n\t\treturn aSectionViz.reduce((promiseChain, oViz) => {\n\t\t\treturn promiseChain.then(() => {\n\t\t\t\tif (oViz.isBookmark) {\n\t\t\t\t\treturn this.appManagerInstance.addBookMark(oViz);\n\t\t\t\t} else {\n\t\t\t\t\treturn sSectionId\n\t\t\t\t\t\t? this.appManagerInstance.addVisualization(oViz.vizId, sSectionId)\n\t\t\t\t\t\t: this.appManagerInstance.addVisualization(oViz.vizId);\n\t\t\t\t}\n\t\t\t});\n\t\t}, Promise.resolve());\n\t}\n\n\t/**\n\t * Handles the completion of the import process.\n\t *\n\t * @private\n\t * @returns {void}\n\t */\n\tprivate _importdone() {\n\t\tconst stateData = { status: true };\n\t\tthis.oEventBus.publish(\"importChannel\", \"tilesImported\", stateData);\n\t}\n\n\t/**\n\t * Displays placeholder tiles while loading.\n\t *\n\t * @private\n\t * @returns {void}\n\t */\n\tprivate _showPlaceHolders() {\n\t\tconst placeholderArray = new Array(this._calculatePlaceholderTileCount()).fill(LoadState.Loading) as LoadState[];\n\t\tthis.aInsightsApps = placeholderArray.map((tileState: LoadState, index: number) => {\n\t\t\treturn new GenericTile(recycleId(`${this.getId()}--placeHolderTile--${index}`), {\n\t\t\t\tsizeBehavior: \"Responsive\",\n\t\t\t\tstate: tileState,\n\t\t\t\tframeType: \"OneByOne\",\n\t\t\t\tmode: \"IconMode\",\n\t\t\t\tvisible: true,\n\t\t\t\trenderOnThemeChange: true,\n\t\t\t\tariaRole: \"listitem\",\n\t\t\t\tdropAreaOffset: 8\n\t\t\t}).setLayoutData?.(\n\t\t\t\tnew GridContainerItemLayoutData(recycleId(`${this.getId()}--placeHolderTileLayoutData--${index}`), {\n\t\t\t\t\tcolumns: 2\n\t\t\t\t})\n\t\t\t);\n\t\t});\n\t\tthis._controlModel.setProperty(\"/tiles\", this.aInsightsApps);\n\t}\n\n\t/**\n\t * Clears the placeholder tiles.\n\t *\n\t * @private\n\t * @returns {void}\n\t */\n\tprivate _clearPlaceHolders() {\n\t\tthis._controlModel.setProperty(\"/tiles\", []);\n\t}\n\n\t/**\n\t * Renders the panel.\n\t *\n\t * @private\n\t * @returns {Promise<void>} A promise that resolves when the panel is rendered.\n\t */\n\tpublic async renderPanel(): Promise<void> {\n\t\ttry {\n\t\t\tconst container = this.getParent() as BaseContainer;\n\t\t\tif (checkPanelExists(container, appsConatinerlName, favAppPanelName)) {\n\t\t\t\tconst addFromFavAppMenuItem = this._createAddFromFavMenuItem(tilesMenuItems.ADD_APPS, \"smartAppsDialog\");\n\t\t\t\tthis.addAggregation(\"menuItems\", addFromFavAppMenuItem);\n\t\t\t\tthis._sortMenuItems(sortedMenuItems);\n\t\t\t}\n\t\t\treturn await this.refreshData();\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t\tthis.fireHandleHidePanel();\n\t\t} finally {\n\t\t\tthis.fireEvent(\"loaded\");\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Sorts the menu items based on the provided order.\n\t *\n\t * @private\n\t * @param {string[]} menuItems - The order of the menu items.\n\t */\n\tprivate _sortMenuItems(menuItems: string[]) {\n\t\tconst panelMenuItems = this.getAggregation(\"menuItems\") as MenuItem[];\n\t\tlet sortedMenuItems = sortMenuItems(menuItems, panelMenuItems);\n\t\tthis.removeAllAggregation(\"menuItems\");\n\t\tsortedMenuItems?.forEach((menuItem) => this.addAggregation(\"menuItems\", menuItem));\n\t}\n\n\t/**\n\t * Refreshes the data in the panel.\n\t *\n\t * @private\n\t * @param {boolean} [refreshTiles=false] - Whether to refresh the tiles.\n\t * @returns {Promise<void>} A promise that resolves when the data is refreshed.\n\t */\n\tpublic async refreshData(refreshTiles: boolean = false) {\n\t\tconst panelName = this.getMetadata().getName();\n\t\tthis.aInsightsApps = await this.appManagerInstance.fetchInsightApps(true, this._insightsSectionTitle);\n\t\tconst bIsSmartBusinessTilePresent = this.aInsightsApps.some((oApp) => oApp.isSmartBusinessTile);\n\t\tif (bIsSmartBusinessTilePresent) {\n\t\t\tawait Lib.load({ name: \"sap.cloudfnd.smartbusiness.lib.reusetiles\" });\n\t\t}\n\t\tthis._clearPlaceHolders();\n\t\tthis._controlModel.setProperty(\"/tiles\", this.aInsightsApps);\n\t\tif (this.aInsightsApps?.length) {\n\t\t\tthis.fireHandleUnhidePanel();\n\t\t\tif (refreshTiles) {\n\t\t\t\tconst isMobile = this.getDeviceType() === DeviceType.Mobile;\n\t\t\t\tconst container = isMobile ? this.tilesMobileContainer : this.tilesContainer;\n\t\t\t\tconst sDefaultAggreName = container.getMetadata().getDefaultAggregationName();\n\t\t\t\tconst dynamicTiles = (container.getAggregation(sDefaultAggreName) as ManagedObject[]) || [];\n\t\t\t\tdynamicTiles.forEach((tiles) => (tiles as ICustomVisualization).refresh?.());\n\t\t\t}\n\t\t\tthis._getInsightsContainer().updatePanelsItemCount(this.aInsightsApps.length, panelName);\n\t\t\tif (this._headerVisible) {\n\t\t\t\tthis.setProperty(\n\t\t\t\t\t\"title\",\n\t\t\t\t\t`${this._i18nBundle?.getText(\"insights\")} ${this._i18nBundle.getText(\"insightsTilesTitle\")} (${this.aInsightsApps.length})`\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fireHandleHidePanel();\n\t\t}\n\t}\n\n\t/**\n\t * Generates the wrapper for the tiles container, if it doesn't already exist\n\t *\n\t * @private\n\t * @override\n\t * @returns {sap.m.VBox} The tiles Vbox wrapper.\n\t */\n\tprivate _createTilesFlexWrapper() {\n\t\tif (!this._tilesWrapper) {\n\t\t\tthis._tilesWrapper = new VBox(`${this.getId()}-tilesWrapper`, {\n\t\t\t\trenderType: \"Bare\",\n\t\t\t\twidth: \"100%\",\n\t\t\t\titems: [this._createMobileFlexWrapper(), this._createWrapperFlexBox()]\n\t\t\t});\n\t\t\tthis._showPlaceHolders();\n\t\t\tthis._tilesWrapper.setModel(this._controlModel);\n\t\t\tthis._addContent(this._tilesWrapper);\n\t\t}\n\t}\n\n\t/**\n\t * Generates wrapper for displaying tiles in mobile mode.\n\t * @private\n\t * @returns {sap.m.HeaderContainer} The generated tiles wrapper.\n\t */\n\n\tprivate _createMobileFlexWrapper(): HeaderContainer {\n\t\t// Check if the mobile container already exists\n\t\tif (!this.tilesMobileContainer) {\n\t\t\t// Create the HeaderContainer with required properties\n\t\t\tthis.tilesMobileContainer = new HeaderContainer(`${this.getId()}-insightsTilesMobileContainer`, {\n\t\t\t\tscrollStep: 0,\n\t\t\t\tscrollStepByItem: 1,\n\t\t\t\tgridLayout: true,\n\t\t\t\tscrollTime: 1000,\n\t\t\t\tshowDividers: false,\n\t\t\t\tvisible: \"{/isPhone}\"\n\t\t\t}).addStyleClass(\"sectionMarginTopTilesInsight sapMHeaderContainerAlign sapMHeaderContainerMarginBottom tilesBoxShadow\");\n\n\t\t\t// Attach aggregation to the container\n\t\t\tthis._attachAggregationToContainer(this.tilesMobileContainer);\n\t\t}\n\t\t// Return the existing or newly created container\n\t\treturn this.tilesMobileContainer;\n\t}\n\n\t/**\n\t * Generates app wrapper (GridContainer) for displaying tiles.\n\t * @private\n\t * @returns {sap.m.GridContainer} The generated tiles wrapper.\n\t */\n\n\tprivate _createWrapperFlexBox(): GridContainer {\n\t\t// Check if the tilesContainer already exists\n\t\tif (!this.tilesContainer) {\n\t\t\t// Create the GridContainer with required properties\n\t\t\tthis.tilesContainer = new GridContainer(`${this.getId()}-insightsTilesContainer`, {\n\t\t\t\tvisible: \"{= !${/isPhone}}\"\n\t\t\t}).addStyleClass(\"insightTiles sapUiSmallMarginTop sapUiSmallMarginBottom\");\n\t\t\t// Attach aggregation to the container\n\t\t\tthis._attachAggregationToContainer(this.tilesContainer);\n\t\t}\n\t\t// Return the existing or newly created container\n\t\treturn this.tilesContainer;\n\t}\n\n\t/**\n\t * Updates the activation flags for Insights Tiles based on the device type and viewport.\n\t *\n\t *\n\t * @private\n\t * @returns {void}\n\t */\n\tprivate _updateTilesActivity(): void {\n\t\t// Activate Insights Tiles based on container in viewport\n\t\tconst isPhoneScreen: boolean = this.getDeviceType() === DeviceType.Mobile;\n\t\t// Explicitly type the property being retrieved\n\t\tconst bActivateInsightsTiles: boolean = Boolean(this._controlModel.getProperty(\"/activateInsightsTiles\"));\n\t\tthis._controlModel.setProperty(\"/activateInsightsTilesOnPhone\", bActivateInsightsTiles && isPhoneScreen);\n\t\tthis._controlModel.setProperty(\"/activateInsightsTilesOnDesktop\", bActivateInsightsTiles && !isPhoneScreen);\n\t}\n\t/**\n\t * Attaches necessary aggregations and configurations to the provided container.\n\t *\n\t * @private\n\t * @param {GridContainer | HeaderContainer} tilesContainer - The container to which the aggregation and events are to be attached.\n\t * @returns {void}\n\t *\n\t */\n\tprivate _attachAggregationToContainer(tilesContainer: GridContainer | HeaderContainer) {\n\t\ttilesContainer.setModel(this._controlModel);\n\t\tconst sDefaultAggreName = tilesContainer.getMetadata().getDefaultAggregationName();\n\t\tconst isPhoneScreen = this.getDeviceType() === DeviceType.Mobile;\n\t\ttilesContainer.bindAggregation(sDefaultAggreName, {\n\t\t\tpath: \"/tiles\",\n\t\t\tfactory: (id: string, context: Context): ManagedObject => {\n\t\t\t\tconst oApp = context.getObject() as ICustomVisualization;\n\t\t\t\tif (oApp instanceof GenericTile) {\n\t\t\t\t\treturn oApp;\n\t\t\t\t}\n\t\t\t\tconst oVisualization = this.VizInstantiationService.instantiateVisualization(oApp.visualization) as ICustomVisualization;\n\t\t\t\toVisualization.setLayoutData?.(\n\t\t\t\t\tnew GridContainerItemLayoutData(`${this.getId()}-itemLayoutData-${id}`, {\n\t\t\t\t\t\tminRows: 2,\n\t\t\t\t\t\tcolumns: oVisualization.getDisplayFormat?.() === DisplayFormat.Standard ? 2 : 4\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\toVisualization?.bindProperty?.(\n\t\t\t\t\t\"active\",\n\t\t\t\t\tisPhoneScreen ? \"/activateInsightsTilesOnPhone\" : \"/activateInsightsTilesOnDesktop\"\n\t\t\t\t);\n\t\t\t\tthis._setDropAreaRectFunction(oVisualization as ManagedObject);\n\t\t\t\treturn oVisualization as ManagedObject;\n\t\t\t}\n\t\t});\n\t\tthis.addDragDropConfigTo(tilesContainer, (oEvent) => this._handleTilesDnd(oEvent));\n\t}\n\n\t/**\n\t * Sets the drop area rectangle function for the given visualization.\n\t *\n\t * @private\n\t * @param {ManagedObject} oVisualization - The visualization object to set the drop area rectangle function.\n\t */\n\tprivate _setDropAreaRectFunction(oVisualization: ManagedObject) {\n\t\tconst tilesDropAreaOffset = 8;\n\t\tObject.defineProperty(oVisualization, \"getDropAreaRect\", {\n\t\t\tvalue: function (this: Control) {\n\t\t\t\tconst domRef = this.getDomRef();\n\t\t\t\tif (!domRef) return null;\n\t\t\t\tconst mDropRect = domRef.getBoundingClientRect();\n\t\t\t\treturn {\n\t\t\t\t\tleft: mDropRect.left - tilesDropAreaOffset,\n\t\t\t\t\tright: mDropRect.right + tilesDropAreaOffset,\n\t\t\t\t\ttop: mDropRect.top,\n\t\t\t\t\tbottom: mDropRect.bottom,\n\t\t\t\t\twidth: mDropRect.width,\n\t\t\t\t\theight: mDropRect.height\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Handles the drag and drop of tiles.\n\t *\n\t * @private\n\t * @param {Event<DropInfo$DropEventParameters>} oEvent - The drop event parameters.\n\t */\n\tprivate _handleTilesDnd(oEvent: Event<DropInfo$DropEventParameters>) {\n\t\tconst sInsertPosition = oEvent.getParameter?.(\"dropPosition\"),\n\t\t\toDragItem = oEvent?.getParameter?.(\"draggedControl\") as Control,\n\t\t\toDropItem = oEvent.getParameter(\"droppedControl\") as Control,\n\t\t\tiDragItemIndex = (oDragItem.getParent() as FlexBox)?.indexOfItem(oDragItem);\n\t\tlet iDropItemIndex = (oDragItem.getParent() as FlexBox)?.indexOfItem(oDropItem);\n\n\t\tif (sInsertPosition === \"Before\" && iDragItemIndex === iDropItemIndex - 1) {\n\t\t\tiDropItemIndex--;\n\t\t} else if (sInsertPosition === \"After\" && iDragItemIndex === iDropItemIndex + 1) {\n\t\t\tiDropItemIndex++;\n\t\t}\n\n\t\tif (iDragItemIndex !== iDropItemIndex) {\n\t\t\tvoid this._DragnDropTiles(iDragItemIndex, iDropItemIndex, sInsertPosition as string);\n\t\t}\n\t}\n\n\t/**\n\t * Handles the drag and drop of tiles asynchronously.\n\t *\n\t * @private\n\t * @param {number} iDragItemIndex - The index of the dragged item.\n\t * @param {number} iDropItemIndex - The index of the dropped item.\n\t * @param {string} sInsertPosition - The position to insert the item.\n\t * @returns {Promise<void>} A promise that resolves when the drag and drop operation is complete.\n\t */\n\tprivate async _DragnDropTiles(iDragItemIndex: number, iDropItemIndex: number, sInsertPosition: string) {\n\t\tif (sInsertPosition === \"Before\" && iDragItemIndex < iDropItemIndex) {\n\t\t\tiDropItemIndex--;\n\t\t} else if (sInsertPosition === \"After\" && iDragItemIndex > iDropItemIndex) {\n\t\t\tiDropItemIndex++;\n\t\t}\n\t\tconst oDisplacedItem = this.aInsightsApps[iDropItemIndex] as ICustomVisualization,\n\t\t\toItemMoved = this.aInsightsApps.splice(iDragItemIndex, 1)[0] as ICustomVisualization;\n\t\tthis.aInsightsApps.splice(iDropItemIndex, 0, oItemMoved);\n\t\tconst moveConfigs = {\n\t\t\tpageId: MYHOME_PAGE_ID,\n\t\t\tsourceSectionIndex: oItemMoved.persConfig?.sectionIndex as number,\n\t\t\tsourceVisualizationIndex: oItemMoved.persConfig?.visualizationIndex as number,\n\t\t\ttargetSectionIndex: oDisplacedItem.persConfig?.sectionIndex as number,\n\t\t\ttargetVisualizationIndex: oDisplacedItem.persConfig?.visualizationIndex as number\n\t\t};\n\t\tthis._controlModel.setProperty(\"/tiles\", this.aInsightsApps);\n\t\tawait this.appManagerInstance.moveVisualization(moveConfigs);\n\t\tawait this.refreshData(true);\n\t\t// Ensures focus on tile after Panel refresh during DnD.\n\t\tsetTimeout(() => {\n\t\t\tfocusDraggedItem(this.tilesContainer, iDropItemIndex);\n\t\t}, 0);\n\t}\n\n\t/**\n\t * Handles the edit tiles event.\n\t *\n\t * @param {Event} event - The event object.\n\t */\n\tprivate handleEditTiles(event: Event) {\n\t\t/* If called from Panel Header event.source() will return TilesPanel, if called from Insights Container event.source() will return InsightsContainer.\n\t\t_getLayout is available at Container Level*/\n\t\tlet parent: ManagedObject = event.getSource<TilesPanel>().getParent() || this;\n\t\tif (parent?.isA(\"sap.cux.home.TilesPanel\")) {\n\t\t\tparent = parent.getParent() as ManagedObject;\n\t\t}\n\t\t(parent as InsightsContainer)?._getLayout().openSettingsDialog(SETTINGS_PANELS_KEYS.INSIGHTS_TILES);\n\t}\n\n\t/**\n\t * Hides the header of the tiles panel.\n\t * @private\n\t */\n\tpublic handleHideHeader() {\n\t\tthis._headerVisible = false;\n\t\tthis.setProperty(\"title\", \"\");\n\t\tthis._toggleHeaderActions(false);\n\t}\n\n\t/**\n\t * Adds the header to the tiles panel.\n\t * @private\n\t */\n\tpublic handleAddHeader() {\n\t\tthis._headerVisible = true;\n\t\tthis.setProperty(\n\t\t\t\"title\",\n\t\t\t`${this._i18nBundle?.getText(\"insights\")} ${this._i18nBundle.getText(\"insightsTilesTitle\")} (${this.aInsightsApps.length})`\n\t\t);\n\t\tthis._toggleHeaderActions(true);\n\t}\n\n\t/**\n\t * Closes the \"Add from Favorites\" dialog.\n\t *\n\t * @private\n\t */\n\tprivate _closeAddFromFavDialog() {\n\t\tconst list = this._controlMap.get(`${this._addFromFavDialogId}-list`) as List;\n\t\tlist?.removeSelections();\n\t\t(this._controlMap.get(this._addFromFavDialogId) as Dialog)?.close();\n\t}\n\n\t/**\n\t * Navigates to the App Finder with optional group Id.\n\t * @async\n\t * @private\n\t * @param {string} [groupId] - Optional group Id\n\t */\n\tprivate async navigateToAppFinder(groupId?: string) {\n\t\tconst navigationService = await Container.getServiceAsync<Navigation>(\"Navigation\");\n\t\tconst navigationObject: { pageID: string; sectionID?: string } = {\n\t\t\tpageID: MYHOME_PAGE_ID,\n\t\t\tsectionID: MYINSIGHT_SECTION_ID\n\t\t};\n\t\tif (groupId) {\n\t\t\tnavigationObject.sectionID = groupId;\n\t\t}\n\t\tawait navigationService.navigate({\n\t\t\ttarget: {\n\t\t\t\tshellHash: `Shell-appfinder?&/catalog/${JSON.stringify(navigationObject)}`\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Retrieves the key of the legend color based on the provided color value.\n\t * @param {string} color - The color value for which to retrieve the legend color key.\n\t * @returns {string} The legend color key corresponding to the provided color value, or the default background color key if not found.\n\t * @private\n\t */\n\tprivate _getLegendColor(color: string) {\n\t\treturn END_USER_COLORS().find((oColor) => oColor.value === color) || DEFAULT_BG_COLOR();\n\t}\n\n\t/**\n\t * Handles the addition of tiles from favorite apps.\n\t * @returns {Promise<void>} A Promise that resolves when the operation is complete.\n\t * @private\n\t */\n\tprivate async _handleAddFromFavApps() {\n\t\tconst appsToAdd = await this._getFavToAdd();\n\t\tconst dialog = this._generateAddFromFavAppsDialog();\n\t\t(this._controlMap.get(`${this._addFromFavDialogId}-errorMessage`) as IllustratedMessage)?.setVisible(appsToAdd.length === 0);\n\t\tthis._generateAddFromFavAppsListItems(appsToAdd);\n\t\tdialog.open();\n\t}\n\n\t/**\n\t * Retrieves the favorite visualizations to be added.\n\t *\n\t * @private\n\t * @async\n\t * @returns {Promise<ISectionAndVisualization[]>} A promise that resolves to an array of favorite visualizations to be added.\n\t */\n\tprivate async _getFavToAdd(): Promise<ISectionAndVisualization[]> {\n\t\tconst aFavApps: ISectionAndVisualization[] = await this.appManagerInstance.fetchFavVizs(false, true);\n\t\tconst aDynamicApps = aFavApps.filter(function (oDynApp) {\n\t\t\treturn oDynApp.isCount || oDynApp.isSmartBusinessTile;\n\t\t});\n\n\t\tconst aFilteredFavApps = aDynamicApps.filter((oDynApp) => {\n\t\t\tconst iAppIndex = this.aInsightsApps.findIndex(function (oInsightApps) {\n\t\t\t\treturn (\n\t\t\t\t\t(!oDynApp.visualization?.isBookmark &&\n\t\t\t\t\t\t(oInsightApps as ICustomVisualization).visualization?.vizId === oDynApp.visualization?.vizId) ||\n\t\t\t\t\t(oDynApp.visualization?.isBookmark &&\n\t\t\t\t\t\t(oInsightApps as ICustomVisualization).visualization?.targetURL === oDynApp.visualization?.targetURL)\n\t\t\t\t);\n\t\t\t});\n\t\t\treturn iAppIndex === -1;\n\t\t});\n\n\t\treturn aFilteredFavApps;\n\t}\n\n\t/**\n\t * Retrieves the selected Apps from the dialog.\n\t * @returns {sap.m.ListItemBase[]} An array of selected Apps.\n\t * @private\n\t */\n\tprivate _getSelectedInsights() {\n\t\tconst list = this._controlMap.get(`${this._addFromFavDialogId}-list`) as List;\n\t\treturn list.getSelectedItems() || [];\n\t}\n\n\t/**\n\t * Generates list items for the \"Add from Favorites\" dialog.\n\t *\n\t * @private\n\t * @param {ISectionAndVisualization[]} appsToAdd - An array of favorite visualizations to be added.\n\t */\n\tprivate _generateAddFromFavAppsListItems(appsToAdd: ISectionAndVisualization[]) {\n\t\tconst id = this._addFromFavDialogId;\n\t\tconst list = this._controlMap.get(`${id}-list`) as List;\n\t\tif (appsToAdd.length) {\n\t\t\tlist.destroyItems();\n\t\t\tconst listItems = appsToAdd.map(\n\t\t\t\t(app, index) =>\n\t\t\t\t\tnew CustomListItem({\n\t\t\t\t\t\tid: `${id}-listItem-${index}`,\n\t\t\t\t\t\tcontent: [\n\t\t\t\t\t\t\tnew HBox({\n\t\t\t\t\t\t\t\tid: `${id}-listItem-${index}-content`,\n\t\t\t\t\t\t\t\talignItems: \"Center\",\n\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\tnew Icon({\n\t\t\t\t\t\t\t\t\t\tid: `${id}-listItem-${index}-content-icon`,\n\t\t\t\t\t\t\t\t\t\tsrc: app.icon,\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: this._getLegendColor(\n\t\t\t\t\t\t\t\t\t\t\ttypeof app.BGColor === \"object\" ? app.BGColor.key : (app.BGColor ?? \"\")\n\t\t\t\t\t\t\t\t\t\t).value,\n\t\t\t\t\t\t\t\t\t\tcolor: \"white\",\n\t\t\t\t\t\t\t\t\t\twidth: \"2.25rem\",\n\t\t\t\t\t\t\t\t\t\theight: \"2.25rem\",\n\t\t\t\t\t\t\t\t\t\tsize: \"1.25rem\"\n\t\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiRoundedBorder sapUiTinyMargin\"),\n\t\t\t\t\t\t\t\t\tnew ObjectIdentifier({\n\t\t\t\t\t\t\t\t\t\tid: `${id}-listItem-${index}-content-identifier`,\n\t\t\t\t\t\t\t\t\t\ttitle: app.title,\n\t\t\t\t\t\t\t\t\t\ttext: app.subtitle,\n\t\t\t\t\t\t\t\t\t\ttooltip: app.title\n\t\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMargin\")\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t})\n\t\t\t\t\t\t.addStyleClass(\"sapUiContentPadding\")\n\t\t\t\t\t\t.data(\"app\", app) as CustomListItem\n\t\t\t);\n\t\t\tlistItems.forEach((item) => list.addItem(item));\n\t\t}\n\t\tlist?.setVisible(appsToAdd.length !== 0);\n\t}\n\n\t/**\n\t * Generates the \"Add from Favorites\" dialog.\n\t *\n\t * @private\n\t * @returns {Dialog} The generated dialog.\n\t */\n\tprivate _generateAddFromFavAppsDialog(): Dialog {\n\t\tconst id = this._addFromFavDialogId;\n\t\tconst setAddBtnEnabled = () => {\n\t\t\tconst selectedItems = this._getSelectedInsights();\n\t\t\t(this._controlMap.get(`${id}-addBtn`) as Button).setEnabled(selectedItems.length > 0);\n\t\t};\n\t\tif (!this._controlMap.get(id)) {\n\t\t\tconst getAppFinderBtn = (id: string, btnType?: ButtonType) => {\n\t\t\t\tconst appFinderBtn = new Button(id, {\n\t\t\t\t\ticon: \"sap-icon://action\",\n\t\t\t\t\ttext: this._i18nBundle.getText(\"appFinderBtn\"),\n\t\t\t\t\tpress: () => {\n\t\t\t\t\t\tthis._closeAddFromFavDialog();\n\t\t\t\t\t\tvoid this.navigateToAppFinder();\n\t\t\t\t\t},\n\t\t\t\t\tvisible: _showAddApps(),\n\t\t\t\t\ttype: btnType ?? ButtonType.Default\n\t\t\t\t});\n\t\t\t\taddFESRSemanticStepName(appFinderBtn, FESR_EVENTS.PRESS, \"tilesAppFinder\");\n\t\t\t\treturn appFinderBtn;\n\t\t\t};\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-list`,\n\t\t\t\tnew List({\n\t\t\t\t\tid: `${id}-list`,\n\t\t\t\t\tmode: \"MultiSelect\",\n\t\t\t\t\tselectionChange: setAddBtnEnabled\n\t\t\t\t})\n\t\t\t);\n\t\t\tconst addButton = new Button({\n\t\t\t\tid: `${id}-addBtn`,\n\t\t\t\ttext: this._i18nBundle.getText(\"addBtn\"),\n\t\t\t\ttype: \"Emphasized\",\n\t\t\t\tpress: () => {\n\t\t\t\t\tvoid this._addFromFavApps();\n\t\t\t\t},\n\t\t\t\tenabled: false\n\t\t\t});\n\t\t\taddFESRSemanticStepName(addButton, FESR_EVENTS.PRESS, \"addSmartApps\");\n\t\t\tthis._controlMap.set(`${id}-addBtn`, addButton);\n\t\t\tthis._controlMap.set(\n\t\t\t\t`${id}-errorMessage`,\n\t\t\t\tnew IllustratedMessage({\n\t\t\t\t\tid: `${id}-errorMessage`,\n\t\t\t\t\tillustrationSize: IllustratedMessageSize.Small,\n\t\t\t\t\tillustrationType: IllustratedMessageType.AddDimensions,\n\t\t\t\t\ttitle: this._i18nBundle.getText(\"noAppsTitle\"),\n\t\t\t\t\tdescription: this._i18nBundle.getText(\"tilesSectionNoDataDescription\"),\n\t\t\t\t\tvisible: true\n\t\t\t\t}).addStyleClass(\"sapUiLargeMarginTop\")\n\t\t\t);\n\t\t\tthis._controlMap.set(\n\t\t\t\tid,\n\t\t\t\tnew Dialog(id, {\n\t\t\t\t\ttitle: this._i18nBundle.getText(\"addSmartApps\"),\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew Label({\n\t\t\t\t\t\t\tid: `${id}-label`,\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"suggTileDialogLabel\"),\n\t\t\t\t\t\t\twrapping: true\n\t\t\t\t\t\t}).addStyleClass(\"sapMTitleAlign sapUiTinyMarginTopBottom sapUiSmallMarginBeginEnd\"),\n\t\t\t\t\t\tnew HBox({\n\t\t\t\t\t\t\tid: `${id}-textContainer`,\n\t\t\t\t\t\t\tjustifyContent: \"SpaceBetween\",\n\t\t\t\t\t\t\talignItems: \"Center\",\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\tnew Title({\n\t\t\t\t\t\t\t\t\tid: `${id}-text`,\n\t\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"suggTileDialogTitle\")\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tgetAppFinderBtn(`${id}-addAppsBtn`, ButtonType.Transparent)\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginTop dialogHeader sapUiSmallMarginBeginEnd\"),\n\t\t\t\t\t\tthis._controlMap.get(`${id}-list`) as List,\n\t\t\t\t\t\tthis._controlMap.get(`${id}-errorMessage`) as IllustratedMessage\n\t\t\t\t\t],\n\t\t\t\t\tcontentWidth: \"42.75rem\",\n\t\t\t\t\tcontentHeight: \"32.5rem\",\n\t\t\t\t\tendButton: new Button({\n\t\t\t\t\t\tid: `${id}-addFromFavDialogCloseBtn`,\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"closeBtn\"),\n\t\t\t\t\t\tpress: this._closeAddFromFavDialog.bind(this)\n\t\t\t\t\t}),\n\t\t\t\t\tescapeHandler: this._closeAddFromFavDialog.bind(this),\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tthis._controlMap.get(`${id}-addBtn`) as Button,\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\tid: `${id}-cancelBtn`,\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"cancelBtn\"),\n\t\t\t\t\t\t\tpress: this._closeAddFromFavDialog.bind(this)\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}).addStyleClass(\"sapContrastPlus sapCuxAddFromInsightsDialog\")\n\t\t\t);\n\t\t}\n\t\tsetAddBtnEnabled();\n\t\treturn this._controlMap.get(id) as Dialog;\n\t}\n\n\t/**\n\t * Handles the addition of tiles from favorite apps.\n\t *\n\t * @private\n\t * @async\n\t * @returns {Promise<void>} A promise that resolves when the operation is complete.\n\t */\n\tprivate async _addFromFavApps() {\n\t\tconst dialog = this._controlMap.get(this._addFromFavDialogId) as Dialog;\n\t\tdialog.setBusy(true);\n\t\tconst selectedItems = this._getSelectedInsights();\n\t\tawait selectedItems.reduce(async (promise, oApp) => {\n\t\t\tawait promise;\n\t\t\tconst app = oApp.data(\"app\") as ISectionAndVisualization;\n\t\t\tconst oMovingConfig = {\n\t\t\t\tpageId: MYHOME_PAGE_ID,\n\t\t\t\tsourceSectionIndex: app.persConfig?.sectionIndex as number,\n\t\t\t\tsourceVisualizationIndex: app.persConfig?.visualizationIndex as number,\n\t\t\t\ttargetSectionIndex: this.appManagerInstance.insightsSectionIndex,\n\t\t\t\ttargetVisualizationIndex: -1\n\t\t\t};\n\t\t\tif (app.visualization?.displayFormatHint !== \"standard\" && app.visualization?.displayFormatHint !== \"standardWide\") {\n\t\t\t\tif (app.visualization?.supportedDisplayFormats?.includes(\"standard\")) {\n\t\t\t\t\tapp.visualization.displayFormatHint = \"standard\";\n\t\t\t\t} else if (app.visualization?.supportedDisplayFormats?.includes(\"standardWide\")) {\n\t\t\t\t\tapp.visualization.displayFormatHint = \"standardWide\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Add Selected App to Insights Section\n\t\t\tif (!app.visualization?.vizId) {\n\t\t\t\t(app.visualization as IVisualization).vizId = app.visualization?.targetURL ?? \"\";\n\t\t\t}\n\t\t\tif (app.visualization?.isBookmark === true) {\n\t\t\t\tawait this.appManagerInstance.addBookMark(app.visualization, oMovingConfig);\n\t\t\t} else {\n\t\t\t\tawait this.appManagerInstance.addVisualization(app.visualization?.vizId as string, MYINSIGHT_SECTION_ID);\n\t\t\t}\n\t\t}, Promise.resolve());\n\n\t\tawait this.refreshData();\n\t\tdialog.setBusy(false);\n\t\tdialog.close();\n\t}\n\n\t/**\n\t * Calculates the number of visible tiles that can fit within the available width of the parent container.\n\t *\n\t * @private\n\t * @param {ICustomVisualization[]} insightsApps - An array of custom visualizations to be displayed as tiles.\n\t * @returns {number} - The number of visible tiles.\n\t */\n\tprivate _calculateVisibleTileCount(insightsApps: ICustomVisualization[]): number {\n\t\tconst layout = this._getInsightsContainer()?._getLayout();\n\t\tconst layoutDomRef = layout?.getDomRef();\n\t\tconst apps = insightsApps || [];\n\t\tlet count = 0;\n\n\t\tif (layoutDomRef && apps.length) {\n\t\t\tconst isHeaderVisible = layout.getProperty(\"showHeader\") as boolean;\n\t\t\tconst sectionNodeIndex = isHeaderVisible ? 1 : 0;\n\t\t\tconst sectionDomRef = layoutDomRef.childNodes[sectionNodeIndex] as Element;\n\t\t\tconst domProperties = fetchElementProperties(sectionDomRef, [\"width\", \"padding-left\", \"padding-right\"]);\n\t\t\tlet availableWidth = domProperties.width - domProperties[\"padding-left\"] - domProperties[\"padding-right\"];\n\t\t\tconst widthMap = {} as Record<DisplayFormat, number>;\n\n\t\t\twidthMap[DisplayFormat.Standard] = StandardTileWidth + Gap;\n\t\t\twidthMap[DisplayFormat.StandardWide] = StandardWideTileWidth + Gap;\n\n\t\t\tlet nextTileWidth = widthMap[(apps[count].visualization?.displayFormatHint ?? DisplayFormat.Standard) as DisplayFormat];\n\t\t\tdo {\n\t\t\t\tavailableWidth -= nextTileWidth;\n\t\t\t\t++count;\n\t\t\t\tnextTileWidth = widthMap[(apps[count]?.visualization?.displayFormatHint ?? DisplayFormat.Standard) as DisplayFormat];\n\t\t\t} while (availableWidth > nextTileWidth);\n\t\t}\n\n\t\treturn count || 1;\n\t}\n\n\tprivate _calculatePlaceholderTileCount(): number {\n\t\tconst layoutDomRef = this._getInsightsContainer()?._getLayout()?.getDomRef();\n\t\tlet count = 0;\n\t\tif (layoutDomRef) {\n\t\t\tconst sectionDomRef = layoutDomRef.childNodes[0] as Element;\n\t\t\tconst domProperties = fetchElementProperties(sectionDomRef, [\"width\", \"padding-left\", \"padding-right\"]);\n\t\t\tlet availableWidth = domProperties.width - domProperties[\"padding-left\"] - domProperties[\"padding-right\"];\n\t\t\tconst width = StandardTileWidth + Gap;\n\n\t\t\tcount = Math.floor(availableWidth / width);\n\t\t}\n\n\t\treturn count || 1;\n\t}\n\n\t/**\n\t * Adjusts the layout of the tiles panel based on the current layout and device type.\n\t *\n\t * @private\n\t * @override\n\t */\n\tpublic _adjustLayout() {\n\t\tconst layout = this._getInsightsContainer()?._getLayout();\n\t\tconst isMobileDevice = this.getDeviceType() === DeviceType.Mobile;\n\n\t\tif (layout) {\n\t\t\tconst visibleTileCount = isMobileDevice\n\t\t\t\t? this.aInsightsApps?.length\n\t\t\t\t: this._calculateVisibleTileCount(this.aInsightsApps as ICustomVisualization[]);\n\t\t\tconst isElementExpanded = layout._getCurrentExpandedElementName() === this.getProperty(\"fullScreenName\");\n\t\t\tthis._controlModel.setProperty(\n\t\t\t\t\"/tiles\",\n\t\t\t\tisElementExpanded ? this.aInsightsApps : this.aInsightsApps?.slice(0, visibleTileCount)\n\t\t\t);\n\t\t\tthis._controlModel.setProperty(\"/isPhone\", isMobileDevice);\n\t\t\tthis._updateTilesActivity();\n\t\t\t//Show/Hide Full Screen Button if panel header is visible otherwise update visibility of container Full Screen Button\n\t\t\tconst showFullScreenButton = isElementExpanded || this.aInsightsApps.length > visibleTileCount;\n\t\t\tif (this._headerVisible) {\n\t\t\t\tif (!isMobileDevice) {\n\t\t\t\t\t(this.getAggregation(\"actionButtons\") as Button[])?.forEach((actionButton) => {\n\t\t\t\t\t\tif (actionButton.getId().includes(tilesActionButtons.ADD_TILES)) {\n\t\t\t\t\t\t\tthis._getInsightsContainer().toggleActionButton(actionButton, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis._getInsightsContainer()?.toggleFullScreenElements(this, showFullScreenButton);\n\t\t\t} else {\n\t\t\t\tconst fullScreenButton = getAssociatedFullScreenMenuItem(this);\n\t\t\t\tconst fullScreenText = fullScreenButton?.getTitle() ?? \"\";\n\t\t\t\tthis._getInsightsContainer()?.updateMenuItem(\n\t\t\t\t\tthis._controlMap.get(`${this.getId()}-${tilesContainerMenuItems.SHOW_MORE}`) as MenuItem,\n\t\t\t\t\tshowFullScreenButton,\n\t\t\t\t\tfullScreenText\n\t\t\t\t);\n\t\t\t\tthis._getInsightsContainer()?.updateActionButton(\n\t\t\t\t\tthis._controlMap.get(`${this.getId()}-${tilesContainerActionButtons.SHOW_MORE}`) as Button,\n\t\t\t\t\tshowFullScreenButton,\n\t\t\t\t\tfullScreenText\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves the InsightsContainer instance associated with this TilesPanel.\n\t *\n\t * @private\n\t * @returns {InsightsContainer} The InsightsContainer instance.\n\t */\n\tprivate _getInsightsContainer(): InsightsContainer {\n\t\tif (!this.insightsContainer) {\n\t\t\tthis.insightsContainer = this.getParent() as InsightsContainer;\n\t\t}\n\t\treturn this.insightsContainer;\n\t}\n\n\t/**\n\t * Retrieves the menu items for the container.\n\t *\n\t * @private\n\t * @returns {MenuItem[]} An array of MenuItem instances.\n\t */\n\tpublic getContainerMenuItems(): MenuItem[] {\n\t\tif (!this._containerMenuItems) {\n\t\t\tconst containerRefresh = this._createRefreshMenuItem(tilesContainerMenuItems.REFRESH, \"containerTilesRefresh\");\n\t\t\tconst containerEditTiles = this._createEditTilesMenuItem(tilesContainerMenuItems.EDIT_TILES, \"containerManageTiles\");\n\t\t\tconst containerShowMore = createShowMoreMenuItem(this, tilesContainerMenuItems.SHOW_MORE, \"containerTilesShowMore\");\n\t\t\tconst container = this.getParent() as BaseContainer;\n\t\t\tthis._controlMap.set(`${this.getId()}-${tilesContainerMenuItems.SHOW_MORE}`, containerShowMore);\n\t\t\tthis._containerMenuItems = [containerRefresh, containerEditTiles, containerShowMore];\n\t\t\tif (checkPanelExists(container, appsConatinerlName, favAppPanelName)) {\n\t\t\t\tconst containerAddFromFav = this._createAddFromFavMenuItem(tilesContainerMenuItems.ADD_APPS, \"containerSmartAppsDialog\");\n\t\t\t\tthis._containerMenuItems.splice(1, 0, containerAddFromFav);\n\t\t\t}\n\t\t}\n\t\treturn this._containerMenuItems;\n\t}\n\n\t/**\n\t * Retrieves the action buttons for the container.\n\t *\n\t * @private\n\t * @returns {Button[]} An array of Button instances.\n\t */\n\tpublic getContainerActionButtons(): Button[] {\n\t\tif (!this._containerActionButtons) {\n\t\t\tthis._containerActionButtons = [];\n\t\t\tthis._containerActionButtons.push(\n\t\t\t\tthis._createAddTilesButton(tilesContainerActionButtons.ADD_TILES, \"containerSmartAppsDialog\")\n\t\t\t);\n\n\t\t\tconst containerFullScreenActionButton = createShowMoreActionButton(\n\t\t\t\tthis,\n\t\t\t\ttilesContainerActionButtons.SHOW_MORE,\n\t\t\t\t\"containerTilesShowMore\"\n\t\t\t);\n\t\t\tif (containerFullScreenActionButton) {\n\t\t\t\tthis._controlMap.set(`${this.getId()}-${tilesContainerActionButtons.SHOW_MORE}`, containerFullScreenActionButton);\n\t\t\t\tthis._containerActionButtons.push(containerFullScreenActionButton);\n\t\t\t}\n\t\t}\n\t\treturn this._containerActionButtons;\n\t}\n\n\t/**\n\t * Creates a refresh menu item.\n\t *\n\t * @private\n\t * @param {string} id - The ID of the menu item.\n\t * @param {string} [fesrId] - The FESR ID for the menu item.\n\t * @returns {MenuItem} The created MenuItem instance.\n\t */\n\tprivate _createRefreshMenuItem(id: string, fesrId?: string): MenuItem {\n\t\tconst menuItem = new MenuItem(`${this.getId()}-${id}`, {\n\t\t\ttitle: this._i18nBundle.getText(\"refresh\"),\n\t\t\ticon: \"sap-icon://refresh\",\n\t\t\tvisible: false,\n\t\t\tpress: () => void this.refreshData(true)\n\t\t});\n\t\tthis._controlMap.set(`${this.getId()}-${id}`, menuItem);\n\t\tif (fesrId) {\n\t\t\taddFESRId(menuItem, fesrId);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\t/**\n\t * Creates an \"Add from Favorites\" menu item.\n\t *\n\t * @private\n\t * @param {string} id - The ID of the menu item.\n\t * @param {string} [fesrId] - The FESR ID for the menu item.\n\t * @returns {MenuItem} The created MenuItem instance.\n\t */\n\tprivate _createAddFromFavMenuItem(id: string, fesrId?: string): MenuItem {\n\t\tif (!this._controlMap.get(`${this.getId()}-${id}`)) {\n\t\t\tconst menuItem = new MenuItem(`${this.getId()}-${id}`, {\n\t\t\t\ttitle: this._i18nBundle.getText(\"addSmartApps\"),\n\t\t\t\ticon: \"sap-icon://duplicate\",\n\t\t\t\tvisible: false,\n\t\t\t\tpress: () => void this._handleAddFromFavApps()\n\t\t\t});\n\t\t\tthis._controlMap.set(`${this.getId()}-${id}`, menuItem);\n\t\t\tif (fesrId) {\n\t\t\t\taddFESRId(menuItem, fesrId);\n\t\t\t}\n\t\t}\n\t\treturn this._controlMap.get(`${this.getId()}-${id}`) as MenuItem;\n\t}\n\n\t/**\n\t * Creates an \"Edit Tiles\" menu item.\n\t *\n\t * @private\n\t * @param {string} id - The ID of the menu item.\n\t * @param {string} [fesrId] - The FESR ID for the menu item.\n\t * @returns {MenuItem} The created MenuItem instance.\n\t */\n\tprivate _createEditTilesMenuItem(id: string, fesrId?: string): MenuItem {\n\t\tconst menuItem = new MenuItem(`${this.getId()}-${id}`, {\n\t\t\ttitle: this._i18nBundle.getText(\"editLinkTiles\"),\n\t\t\ticon: \"sap-icon://edit\",\n\t\t\tvisible: false,\n\t\t\tpress: (event: Event) => this.handleEditTiles(event)\n\t\t});\n\t\tthis._controlMap.set(`${this.getId()}-${id}`, menuItem);\n\t\tif (fesrId) {\n\t\t\taddFESRId(menuItem, fesrId);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\t/**\n\t * Creates an \"Add Tiles\" button.\n\t *\n\t * @private\n\t * @param {string} id - The ID of the button.\n\t * @param {string} [fesrId] - The FESR ID for the button.\n\t * @returns {Button} The created Button instance.\n\t */\n\tprivate _createAddTilesButton(id: string, fesrId?: string): Button {\n\t\tconst actionButton = new Button(`${this.getId()}-${id}`, {\n\t\t\ttext: this._i18nBundle.getText(\"appFinderLink\"),\n\t\t\tpress: async () => {\n\t\t\t\tconst container = this.getParent() as BaseContainer;\n\t\t\t\tif (checkPanelExists(container, appsConatinerlName, favAppPanelName)) {\n\t\t\t\t\t// Favorite App Panel is visible, proceed as usual\n\t\t\t\t\tvoid this._handleAddFromFavApps();\n\t\t\t\t} else {\n\t\t\t\t\t// Favorite App Panel is NOT visible, navigate to App Finder\n\t\t\t\t\tawait this.navigateToAppFinder();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._controlMap.set(`${this.getId()}-${id}`, actionButton);\n\t\tif (fesrId) {\n\t\t\taddFESRId(actionButton, fesrId);\n\t\t}\n\n\t\treturn actionButton;\n\t}\n\n\t/**\n\t * Toggles the visibility of the header actions.\n\t *\n\t * @param {boolean} bShow - Whether to show or hide the header actions.\n\t * @private\n\t */\n\tprivate _toggleHeaderActions(bShow: boolean) {\n\t\t(this.getAggregation(\"menuItems\") as MenuItem[])?.forEach((menuItem) => {\n\t\t\tthis._getInsightsContainer()?.toggleMenuListItem(menuItem, bShow);\n\t\t});\n\t\t(this.getAggregation(\"actionButtons\") as Button[])?.forEach((actionButton) =>\n\t\t\tthis._getInsightsContainer()?.toggleActionButton(actionButton, bShow)\n\t\t);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}