/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["./BaseContainer","./CardsPanel","./ErrorPanel","./InsightsContainerGenericPlaceholder","./TilesPanel","./utils/Device","./utils/InsightsUtils"],function(t,e,n,i,s,o,a){"use strict";function d(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const l=d(t);const h=d(e);const r=e["cardsContainerActionButtons"];const c=e["cardsContainerMenuItems"];const u=d(n);const g=i["getInsightsPlaceholder"];const f=d(s);const m=s["tilesContainerActionButtons"];const _=s["tilesContainerMenuItems"];const p=o["DeviceType"];const C=a["sortMenuItems"];const P="sap.cux.home.TilesPanel";const H="sap.cux.home.CardsPanel";const E=[_.REFRESH,c.REFRESH,_.ADD_APPS,_.EDIT_TILES,c.EDIT_CARDS,c.AI_INSIGHT_CARD,_.SHOW_MORE,c.SHOW_MORE,"settings"];const I=l.extend("sap.cux.home.InsightsContainer",{renderer:{...l.renderer,apiVersion:2},constructor:function t(e,n){l.prototype.constructor.call(this,e,n);this._isInitialRender=true},init:function t(){l.prototype.init.call(this);this.setProperty("title",this._i18nBundle?.getText("insights"));this.setProperty("enableSettings",true);this.setProperty("orientation","Vertical");this.panelLoaded={[P]:{loaded:undefined,count:0},[H]:{loaded:undefined,count:0}};this.panelContext={};this.setTooltip(String(this._i18nBundle.getText("insights")));this.addCustomSetting("title",this._i18nBundle.getText("insightLayoutSectionTitle"));this.setTooltip(String(this._i18nBundle.getText("insightLayoutSectionTitle")))},load:function t(){if(this._isInitialRender){const t=this.getContent();t.forEach(t=>{this.panelContext[t.getMetadata().getName()]=t;this.addCommonMenuItems(t.getContainerMenuItems?.());this.addCommonActionButtons(t.getContainerActionButtons?.())});this._addContainerHeader();t.forEach(t=>{const e=t;e.handleHideHeader();e.attachHandleHidePanel(()=>this.handleHidePanel(e));e.attachHandleUnhidePanel(()=>this.unhidePanelIfHidden(e));void e.renderPanel()});this._isInitialRender=false}},handleHidePanel:function t(e){this.removeContent(e);const n=e.getMetadata().getName();this.handlePanelLoad(n,{loaded:false,count:0});const i=this._getLoadedPanelNames()||[];const s=this.getVisibleOrPendingPanels()||[];const o=i?.length;this._addContainerHeader();if(s.length===0){if(!this._errorPanel){this._errorPanel=new u(`${this.getId()}-errorPanel`,{messageTitle:this._i18nBundle.getText("noAppsTitle"),messageDescription:this._i18nBundle.getText("noInsightsMsg")});this._errorPanel.getData()}this.addAggregation("content",this._errorPanel)}else if(o===1){const t=this.getContent()[0];if(t&&!(t instanceof u)){t?.handleHideHeader()}}},_addContainerHeader:function t(){const e=this._getLoadedPanelNames();let n=[];let i=[];this.setProperty("title",this._i18nBundle?.getText("insights"));if(e.length===0||this.getContent()[0]instanceof u){n=[_.REFRESH,c.REFRESH,_.SHOW_MORE,c.SHOW_MORE];this._hideMenuItems(n);i=[m.SHOW_MORE,r.SHOW_MORE];this._hideActionButtons(i)}else if(e.length===1){const t=e[0];this.setProperty("title",`${this._i18nBundle?.getText("insights")} (${this.panelLoaded[t].count||0})`);if(this.panelContext[e[0]]instanceof f){n=[c.REFRESH,c.SHOW_MORE];i=[r.SHOW_MORE]}if(this.panelContext[e[0]]instanceof h){n=[_.REFRESH,_.SHOW_MORE];i=[m.SHOW_MORE]}this._hideMenuItems(n);this._hideActionButtons(i)}},_removeContainerHeader:function t(){this.setProperty("title","");this.getAggregation("menuItems")?.forEach(t=>this.toggleMenuListItem(t,false));this.getAggregation("actionButtons")?.forEach(t=>this.toggleActionButton(t,false));const e=this._getLoadedPanelNames();e.forEach(t=>{this.panelContext[t]?.handleAddHeader?.()})},_hideMenuItems:function t(e){const n=this.getAggregation("menuItems");n?.forEach(t=>{const n=e.some(e=>t.getId().includes(e));this.toggleMenuListItem(t,!n)})},_hideActionButtons:function t(e){const n=this.getAggregation("actionButtons");n?.forEach(t=>{const n=e.some(e=>t.getId().includes(e));this.toggleActionButton(t,!n)})},updatePanelsItemCount:function t(e,n){this.panelLoaded[n].count=e;const i=this._getLoadedPanelNames();if(i.length===1){this.setProperty("title",`${this._i18nBundle?.getText("insights")} (${e||0})`)}},unhidePanelIfHidden:function t(e){const n=this._getLayout();const i=n._getCurrentExpandedElementName();if(this._errorPanel){this.removeContent(this._errorPanel)}const s=(t,s)=>{const o=this._getPanelContentWrapper(e);if(!i||i===e.getProperty("fullScreenName")){if(this.panelLoaded[t].loaded===false){s();if(o.hasStyleClass("sapCuxHidden")){o.removeStyleClass("sapCuxHidden")}}this.handlePanelLoad(t,{loaded:true,count:this.panelLoaded[t].count})}else{const e=()=>{s();if(o.hasStyleClass("sapCuxHidden")){o.removeStyleClass("sapCuxHidden")}n.detachOnCollapse(e)};this.handlePanelLoad(t,{loaded:true,count:this.panelLoaded[t].count});n.attachOnCollapse(e)}};if(e instanceof f&&!this.panelLoaded[P].loaded){s(P,()=>this.insertContent(this.panelContext[P],0))}if(e instanceof h&&!this.panelLoaded[H].loaded){s(H,()=>this.addContent(this.panelContext[H]))}},_updateHeaderElements:function t(e){const n=this._getLoadedPanelNames();if(n.length>1){this._removeContainerHeader()}else{this._addContainerHeader();e.handleHideHeader()}},adjustLayout:function t(){if(this.getDeviceType()===p.Mobile){this.toggleActionButtons(false)}else{const t=this._getLoadedPanelNames();if(t.length<2){this.getAggregation("actionButtons")?.forEach(t=>{if(t.getId().includes(m.ADD_TILES)){this.toggleActionButton(t,true)}})}}this.getContent().forEach(t=>t._adjustLayout?.())},addCommonMenuItems:function t(e){e.forEach(t=>this.addAggregation("menuItems",t));this._sortMenuItems(E)},addCommonActionButtons:function t(e){e.forEach(t=>this.addAggregation("actionButtons",t))},handlePanelLoad:function t(e,n){if(this.panelLoaded[e].loaded!==n.loaded){this.panelLoaded[e]=n;this._updateHeaderElements(this.panelContext[e])}this.adjustLayout()},updateActionButton:function t(e,n,i){if(e?.getVisible()!==n||e?.getText()!==i){this.toggleActionButton(e,n);e?.setText(i);this._updateContainerHeader(this)}},updateMenuItem:function t(e,n,i){if(e?.getVisible()!==n||e?.getTitle()!==i){this.toggleMenuListItem(e,n);e?.setTitle(i);this._updateContainerHeader(this)}},_getLoadedPanelNames:function t(){return Object.keys(this.panelLoaded).filter(t=>this.panelLoaded[t].loaded)},getVisibleOrPendingPanels:function t(){return Object.keys(this.panelLoaded).filter(t=>this.panelLoaded[t].loaded!==false)},_sortMenuItems:function t(e){const n=this.getAggregation("menuItems");let i=C(e,n);this.removeAllAggregation("menuItems");i?.forEach(t=>this.addAggregation("menuItems",t))},getGenericPlaceholderContent:function t(){return g()}});return I});
//# sourceMappingURL=InsightsContainer.js.map