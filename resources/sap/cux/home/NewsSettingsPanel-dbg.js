/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/m/HBox","sap/m/Label","sap/m/List","sap/m/StandardListItem","sap/m/Switch","sap/m/Text","sap/m/Title","sap/m/VBox","./BaseSettingsPanel","./utils/Accessibility","./utils/Constants","./utils/FESRUtil","./utils/PersonalisationUtils","./utils/UshellPersonalizer"],function(e,t,s,i,n,o,a,l,r,d,h,w,u,c){"use strict";function g(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const S=g(r);const m=d["getInvisibleText"];const N=h["SETTINGS_PANELS_KEYS"];const f=w["addFESRSemanticStepName"];const C=w["FESR_EVENTS"];const p=g(u);const F=g(c);const P=S.extend("sap.cux.home.NewsSettingsPanel",{init:function e(){S.prototype.init.call(this);this.setProperty("key",N.NEWS);this.setProperty("title",this._i18nBundle.getText("news"));this.setProperty("icon","sap-icon://newspaper");this.addAggregation("content",this.getContent());this.attachPanelNavigated(()=>{void this.loadNewsFeedSettings()});this.aFavNewsFeed=[]},getContent:function e(){const t=this.setHeader();const s=this.setTitleMessage();const i=new l(this.getId()+"--idNewsPageOuterVBoX",{alignItems:"Start",justifyContent:"SpaceBetween",items:[t,s,this.setNewsList()]});return i},getPersonalization:function e(){try{const t=this;function s(){return t.oPersonalizer}const i=function(){if(!t.oPersonalizer){return Promise.resolve(F.getInstance(p.getPersContainerId(t._getPanel()),p.getOwnerComponent(t._getPanel()))).then(function(e){t.oPersonalizer=e})}}();return Promise.resolve(i&&i.then?i.then(s):s(i))}catch(n){return Promise.reject(n)}},setHeader:function e(){this.headerText=new o(this.getId()+"--idCustNewsFeedSettingsText",{text:this._i18nBundle.getText("newsFeedSettingsText")});const t=new l(this.getId()+"--idCustNewsFeedSettingsTextContainer",{alignItems:"Start",justifyContent:"SpaceBetween",items:[this.headerText]}).addStyleClass("sapUiSmallMarginTop sapUiSmallMarginBegin");return t},setTitleMessage:function t(){this.title=new a(this.getId()+"--idCustNewsFeedSettignsTitle",{text:this._i18nBundle.getText("newsFeedSettingsHeading"),titleStyle:"H5"});const s=new e(this.getId()+"--idCustNewsFeedSettingsTitleContainer",{alignItems:"Center",justifyContent:"SpaceBetween",items:[this.title]});const i=new l(this.getId()+"--idCustNewsFeedSettingsTitleVBox",{alignItems:"Start",justifyContent:"SpaceBetween",items:[s]}).addStyleClass("sapUiSmallMarginTop sapUiSmallMarginBegin");return i},setNewsList:function i(){const o=new t(this.getId()+"--idShowAllCustNewsSwitchLabel",{text:this._i18nBundle.getText("showAllPreparationRequiredSwitchLabel")});this.oShowSwitch=new n(`${this.getId()}-showSwitch`,{customTextOn:" ",customTextOff:" ",change:()=>{void this.saveNewsFeedSettings()},state:false,ariaLabelledBy:[`${this.getId()}--idShowAllCustNewsSwitchLabel`]});f(this.oShowSwitch,C.CHANGE,"showPrepRequire");this.oCustNewsSwitchContainer=new e(this.getId()+"--idShowAllCustNewsSwitchContainer",{alignItems:"Center",items:[o,this.oShowSwitch],width:"94%"}).addStyleClass("sapUiSmallMarginTop");const a=new l(this.getId()+"--idShowAllCustNewsSwitchVBox",{items:[this.oCustNewsSwitchContainer],width:"94%"}).addStyleClass("sapUiSmallMarginTop");const r=m(`${this.getId()}--newsTitleText`,this._i18nBundle.getText("newsTitle"));this.oList=new s(this.getId()+"--idCustNewsFeedList",{mode:"MultiSelect",selectionChange:()=>{void this.saveNewsFeedSettings()},ariaLabelledBy:[r.getId(),`${this.getId()}--idCustNewsFeedSettingsText`,`${this.getId()}--idCustNewsFeedSettignsTitle`]});const d=new l(this.getId()+"--idCustNewsFeedListContainer",{direction:"Column",items:[this.oList,a,r],width:"96%"}).addStyleClass("sapUiSmallMarginTop sapUiSmallMarginBegin");return d},isCSVFileFormat:function e(t){return t.split(".").pop()?.toLowerCase()==="csv"},saveNewsFeedSettings:function e(){try{const e=this;const t=e.oList.getSelectedItems().map(e=>e.getTitle());const s=e.oNewsPanel.getCustomFeedKey();const i=e.oNewsPanel.getProperty("customFileName");let n;if(s){n={items:t,showAllPreparationRequired:e.isCSVFileFormat(i)?false:e.oShowSwitch.getState()}}else{n={items:t}}return Promise.resolve(e.getPersonalization()).then(function(t){return Promise.resolve(t.read()).then(function(i){if(s){i.favNewsFeed=n}else{i.defaultNewsFeed=n}return Promise.resolve(t.write(i)).then(function(){e.oShowSwitch.setState(n.showAllPreparationRequired);return Promise.resolve(e.oNewsPanel.setCustomNewsFeed(s)).then(function(){})})})})}catch(e){return Promise.reject(e)}},setItems:function e(t){this.oList.destroyAggregation("items",true);(t||[]).forEach((e,t)=>{const s=new i(this.getId()+"--idCustNewsFeedItem"+"--"+t,{title:e.title,selected:e.selected});this.oList.addItem(s)})},loadNewsFeedSettings:function e(){try{const e=this;e.oNewsPanel=e._getPanel();const t=e.oNewsPanel.getCustomFeedKey();return Promise.resolve(e.getPersonalization()).then(function(s){return Promise.resolve(s.read()).then(function(s){const i=t?s?.["favNewsFeed"]:s?.["defaultNewsFeed"];let n=false;n=i?.showAllPreparationRequired??!i;const o=e.oNewsPanel.getProperty("customFileName");let a=[];if(e.isCSVFileFormat(o)||!t){e.oCustNewsSwitchContainer.setVisible(false)}return Promise.resolve(e.oNewsPanel.getCustomNewsFeed(t,false)).then(function(s){if(!t){e.headerText.setText(e._i18nBundle.getText("defaultNewsSettingsText"));e.title.setText(e._i18nBundle.getText("defaultNewsSettingsHeading"));a=e.oNewsPanel.getMandatoryDefaultNewsFeed()}else{e.headerText.setText(e._i18nBundle.getText("newsFeedSettingsText"));e.title.setText(e._i18nBundle.getText("newsFeedSettingsHeading"))}if(s&&s.length>0){e.aFavNewsFeed=i&&i.items||s;let t=e.aFavNewsFeed;s=s.map(e=>{const s=t.find(t=>t===e.title)?true:false;e.selected=!i?true:s;e.blocked=!!a.find(t=>t===e.title);return e});e.aFavNewsFeed=s;e.setItems(e.aFavNewsFeed);e.oShowSwitch.setState(!!n);return s}})})})}catch(e){return Promise.reject(e)}}});return P});
//# sourceMappingURL=NewsSettingsPanel-dbg.js.map