{"version":3,"file":"KeyUserNewsSettingsPanel.js","names":["sap","ui","define","Button","CheckBox","Input","Label","MessageBox","MessageStrip","MessageToast","Toolbar","VBox","Library","EventBus","MessageType","SimpleForm","FileUploader","Container","__BaseSettingsPanel","___flexibility_Layoutflexibility","___utils_Constants","__HttpHelper","_interopRequireDefault","obj","__esModule","default","_catch","body","recover","result","e","then","BaseSettingsPanel","CHANGE_TYPES","KEYUSER_SETTINGS_PANELS_KEYS","HttpHelper","Constants","NEWS_FEED_POST_API","KeyUserNewsSettingsPanel","extend","metadata","library","init","_init","BaseSettingsPanel.prototype.init.call","this","controlMap","Map","setProperty","NEWS","_i18nBundle","getText","addAggregation","getContent","attachPanelNavigated","loadSettings","_eventBus","getInstance","subscribe","channelId","eventId","data","showError","showMessageStrip","Warning","validChanges","getMessageStrip","setVisible","getCurrentKeyUserChange","_getCurrentKeyUserChange","keyUserChanges","getKeyUserChanges","existingChange","find","change","changeSpecificData","changeType","NEWS_FEED_URL","content","_getContent","wrapperVBoxId","getId","wrapperVBox","set","isValidChanges","_isValidChanges","newsVisible","_this","_temp4","fileUploader","getFileUploader","keyUserChangeContent","showCustom","customNewsVisibility","undefined","Boolean","_getPanel","getProperty","_temp3","getNewsFeedUploadBtn","getEnabled","error","String","setValue","customNewsFeedFileName","_temp2","getValue","Error","_temp","getVisible","newsUrl","newsFeedURL","Promise","resolve","setURL","reject","clearNewsPanelChanges","_clearNewsPanelChanges","newsPanel","newsUrlInput","get","setEnabled","setSelected","clearKeyUserChanges","addMessageStrip","_addMessageStrip","keyUserNewsPanelToolbarId","keyUserNewsPanelToolbar","height","messageStripWrapper","width","messageStripId","messsageStrip","showIcon","visible","addItem","addContent","handleSelectCustomNewsFeed","_handleSelectCustomNewsFeed","oEvent","getSource","getSelected","newsPageContainer","getParent","layout","addKeyUserChanges","selectorControl","oldNewsFeedUrl","oldShowCustomNewsFeed","oldCustomNewsFeedKey","showCustomNewsFeed","customNewsFeedKey","publish","changes","removeUrlMesageStrip","disable","date","Date","addCustomNewsFeedCheckBox","_addCustomNewsFeedCheckBox","customNewsFeedCheckBoxId","customNewsFeedCheckBox","text","selected","select","bind","addStyleClass","onNewsUrlChange","_onNewsUrlChange","getParameter","keyUserContent","validUrl","getValidURL","_showMessageStrip","bShow","type","textKey","setType","setText","_getValidURL","urlString","url","URL","href","_removeUrlMesageStrip","onUrlLiveChange","_onUrlLiveChange","sNewValue","_getMessageStrip","addNewsURLSimpleForm","_addNewsURLSimpleForm","newsFeedURLSimpleFormId","newsFeedURLSimpleForm","newsFeedURLInputId","newsFeedURLInput","value","InputType","Url","liveChange","enabled","handleFileChange","_handleFileChange","setNewsFeedEnabled","_setNewsFeedEnabled","bEnabled","newsFeedUploadBtn","_getNewsFeedUploadBtn","customNewsUploadFileUploaderButtonId","handleFileUploadError","_handleFileUploadError","iMaxFileSize","getMaximumFileSize","handleFileDialogClose","_handleFileDialogClose","event","fileName","handleNewsFeedFileUpload","_handleNewsFeedFileUpload","_this2","errorMsg","all","getUploadedFile","getServiceAsync","response","fileData","userInfo","userId","payload","changeId","now","toString","attachment","documentType","Post","oResponse","message","includes","customKey","show","oErr","_getUploadedFile","file","oFileUpload","files","reader","FileReader","onload","fileContent","base64String","window","btoa","encodeURIComponent","replace","match","p1","fromCharCode","parseInt","readAsText","readAsDataURL","_getFileUploader","customNewsUploadFileUploader","addCustomNewsUploadSimpleForm","_addCustomNewsUploadSimpleForm","customNewsUploadSimpleFormId","customNewsUploadSimpleForm","customNewsUploadVBox","customNewsUploadFileUploaderControl","name","tooltip","fileType","maximumFileSize","fileSizeExceed","sameFilenameAllowed","afterDialogClose","customNewsUploadFileUploaderButton","press","_loadSettings","removeAllItems"],"sources":["KeyUserNewsSettingsPanel.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\n\nimport Button from \"sap/m/Button\";\nimport CheckBox, { CheckBox$SelectEvent } from \"sap/m/CheckBox\";\nimport Input, { Input$LiveChangeEvent } from \"sap/m/Input\";\nimport { InputBase$ChangeEvent } from \"sap/m/InputBase\";\nimport Label from \"sap/m/Label\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport MessageStrip from \"sap/m/MessageStrip\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport Toolbar from \"sap/m/Toolbar\";\nimport VBox from \"sap/m/VBox\";\nimport Library from \"sap/m/library\";\nimport Event from \"sap/ui/base/Event\";\nimport Control from \"sap/ui/core/Control\";\nimport type { MetadataOptions } from \"sap/ui/core/Element\";\nimport EventBus from \"sap/ui/core/EventBus\";\nimport MessageType from \"sap/ui/core/message/MessageType\";\nimport SimpleForm from \"sap/ui/layout/form/SimpleForm\";\nimport FileUploader, { FileUploader$ChangeEvent, FileUploader$FileSizeExceedEvent } from \"sap/ui/unified/FileUploader\";\nimport Container from \"sap/ushell/Container\";\nimport UserInfo from \"sap/ushell/services/UserInfo\";\nimport BaseLayout from \"./BaseLayout\";\nimport BaseSettingsPanel from \"./BaseSettingsPanel\";\nimport NewsAndPagesContainer from \"./NewsAndPagesContainer\";\nimport NewsPanel, { FileFormat } from \"./NewsPanel\";\nimport { CHANGE_TYPES } from \"./flexibility/Layout.flexibility\";\nimport { INewsPersData } from \"./interface/KeyUserInterface\";\nimport { KEYUSER_SETTINGS_PANELS_KEYS } from \"./utils/Constants\";\nimport HttpHelper from \"./utils/HttpHelper\";\n\nconst Constants = {\n\tNEWS_FEED_POST_API: \"/sap/opu/odata4/ui2/insights_srv/srvd/ui2/\" + \"insights_repo_srv/0001/\" + \"NEWS_FEED\"\n};\n\ninterface ShowError {\n\tshowError: boolean;\n\tdate: Date;\n}\n\ninterface UploadedFilePayload {\n\tchangeId: string;\n\tattachment: string | PromiseLike<string>;\n\tdocumentType?: string; // Optional\n}\n\ninterface FileMetaData {\n\ttype: string;\n\tcontent: string | PromiseLike<string>;\n}\n\n/**\n *\n * Class for News Settings Panel for KeyUser Settings Dialog.\n *\n * @extends BaseSettingsPanel\n *\n * @author SAP SE\n * @version 0.0.1\n * @since 1.121\n *\n * @internal\n * @experimental Since 1.121\n * @private\n *\n * @alias sap.cux.home.KeyUserNewsSettingsPanel\n */\nexport default class KeyUserNewsSettingsPanel extends BaseSettingsPanel {\n\tstatic readonly metadata: MetadataOptions = {\n\t\tlibrary: \"sap.cux.home\"\n\t};\n\n\tprivate controlMap!: Map<string, Control | Element>;\n\tprivate _eventBus!: EventBus;\n\tprivate customNewsVisibility!: boolean;\n\tprivate validChanges!: boolean;\n\n\t/**\n\t * Init lifecycle method\n\t *\n\t * @public\n\t * @override\n\t */\n\tpublic init(): void {\n\t\tsuper.init();\n\t\tthis.controlMap = new Map();\n\n\t\t//setup panel\n\t\tthis.setProperty(\"key\", KEYUSER_SETTINGS_PANELS_KEYS.NEWS);\n\t\tthis.setProperty(\"title\", this._i18nBundle.getText(\"editNewsFeed\"));\n\n\t\t// //setup layout content\n\t\tthis.addAggregation(\"content\", this.getContent());\n\n\t\t// fired every time on panel navigation\n\t\tthis.attachPanelNavigated(() => this.loadSettings());\n\n\t\tthis._eventBus = EventBus.getInstance();\n\t\tthis._eventBus.subscribe(\n\t\t\t\"KeyUserChanges\",\n\t\t\t\"newsFeedLoadFailed\",\n\t\t\t(channelId?: string, eventId?: string, data?: object) => {\n\t\t\t\t//errorstate is false when import is successful\n\t\t\t\tif ((data as unknown as ShowError)?.showError) {\n\t\t\t\t\tthis.showMessageStrip(true, MessageType.Warning, \"invalidNewsUrl\");\n\t\t\t\t\tthis.validChanges = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis.getMessageStrip().setVisible(false);\n\t\t\t\t\tthis.validChanges = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis\n\t\t);\n\t}\n\n\tprivate getCurrentKeyUserChange(): INewsPersData {\n\t\tconst keyUserChanges = this.getKeyUserChanges();\n\t\tconst existingChange = keyUserChanges.find((change) => {\n\t\t\treturn change.changeSpecificData.changeType === CHANGE_TYPES.NEWS_FEED_URL;\n\t\t});\n\t\treturn existingChange?.changeSpecificData.content as INewsPersData;\n\t}\n\n\t/**\n\t * Returns the content for the KeyUser news Settings Panel.\n\t *\n\t * @private\n\t * @returns {VBox} The control containing the KeyUser news Settings Panel content.\n\t */\n\tprivate getContent(): VBox {\n\t\tconst wrapperVBoxId = `${this.getId()}-wrapperVBox`;\n\t\tconst wrapperVBox = new VBox(wrapperVBoxId);\n\t\tthis.controlMap.set(wrapperVBoxId, wrapperVBox);\n\n\t\treturn wrapperVBox;\n\t}\n\n\tpublic async isValidChanges(newsVisible: boolean) {\n\t\tthis.validChanges = true;\n\t\tconst fileUploader = this.getFileUploader();\n\t\tconst keyUserChangeContent = this.getCurrentKeyUserChange();\n\t\tconst showCustom =\n\t\t\tthis.customNewsVisibility === undefined ? Boolean(this._getPanel().getProperty(\"showCustom\")) : this.customNewsVisibility;\n\t\tif (this.getNewsFeedUploadBtn().getEnabled()) {\n\t\t\tif (showCustom) {\n\t\t\t\tMessageBox.error(String(this._i18nBundle.getText(\"newsFeedSaveUploadChanges\")));\n\t\t\t\tthis.validChanges = false;\n\t\t\t} else {\n\t\t\t\tif (fileUploader) {\n\t\t\t\t\tfileUploader.setValue(\n\t\t\t\t\t\tkeyUserChangeContent.customNewsFeedFileName || String(this._getPanel().getProperty(\"customFileName\"))\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (showCustom && fileUploader.getValue() === \"\" && newsVisible) {\n\t\t\tthis.showMessageStrip(true, MessageType.Error, \"noNewsFileError\");\n\t\t\tthis.validChanges = false;\n\t\t} else if (!showCustom && newsVisible && !this.getMessageStrip().getVisible()) {\n\t\t\tconst newsUrl = keyUserChangeContent.newsFeedURL;\n\t\t\tawait (this._getPanel() as NewsPanel).setURL(String(newsUrl));\n\t\t}\n\t\treturn this.validChanges;\n\t}\n\n\tpublic clearNewsPanelChanges() {\n\t\tconst newsPanel = this._getPanel();\n\t\tthis.getMessageStrip().setVisible(false);\n\t\tconst newsUrlInput = this.controlMap.get(`${this.getId()}-newsFeedURLInput`) as Input;\n\t\tnewsUrlInput.setValue(String(newsPanel.getProperty(\"url\")));\n\t\tthis.customNewsVisibility = Boolean(newsPanel.getProperty(\"showCustom\"));\n\t\t(this.controlMap.get(`${this.getId()}-customNewsUploadFileUploader`) as FileUploader).setEnabled(this.customNewsVisibility);\n\t\t(this.controlMap.get(`${this.getId()}-newsFeedURLInput`) as Input).setEnabled(!this.customNewsVisibility);\n\t\t(this.controlMap.get(`${this.getId()}-customNewsFeedCheckBox`) as CheckBox).setSelected(this.customNewsVisibility);\n\t\tthis.getFileUploader().setValue(String(newsPanel.getProperty(\"customFileName\")));\n\t\tthis.clearKeyUserChanges();\n\t}\n\n\tprivate addMessageStrip(wrapperVBox: VBox): void {\n\t\tconst keyUserNewsPanelToolbarId = `${this.getId()}-keyUserNewsPanelToolbar`;\n\t\tif (!this.controlMap.get(keyUserNewsPanelToolbarId)) {\n\t\t\tconst keyUserNewsPanelToolbar = new Toolbar(keyUserNewsPanelToolbarId, { height: \"auto\" });\n\t\t\tconst messageStripWrapper = new VBox(`${this.getId()}-messageStripWrapper`, { width: \"100%\" });\n\t\t\tconst messageStripId = `${this.getId()}-messageStrip`;\n\t\t\tconst messsageStrip = new MessageStrip(messageStripId, {\n\t\t\t\tshowIcon: true,\n\t\t\t\tvisible: false\n\t\t\t});\n\t\t\tthis.controlMap.set(messageStripId, messsageStrip);\n\t\t\tmessageStripWrapper.addItem(messsageStrip);\n\t\t\tkeyUserNewsPanelToolbar.addContent(messageStripWrapper);\n\t\t\tthis.controlMap.set(keyUserNewsPanelToolbarId, keyUserNewsPanelToolbar);\n\t\t}\n\t\twrapperVBox.addItem(this.controlMap.get(keyUserNewsPanelToolbarId) as Toolbar);\n\t}\n\n\tprivate handleSelectCustomNewsFeed(oEvent: CheckBox$SelectEvent): void {\n\t\tthis.customNewsVisibility = oEvent.getSource().getSelected();\n\n\t\t(this.controlMap.get(`${this.getId()}-customNewsUploadFileUploader`) as FileUploader).setEnabled(this.customNewsVisibility);\n\t\t(this.controlMap.get(`${this.getId()}-newsFeedURLInput`) as Input).setEnabled(!this.customNewsVisibility);\n\n\t\tconst newsPanel = this._getPanel() as NewsPanel;\n\t\tconst newsPageContainer = newsPanel.getParent() as NewsAndPagesContainer;\n\t\tconst layout = newsPageContainer.getParent() as BaseLayout;\n\t\tconst keyUserChangeContent = this.getCurrentKeyUserChange();\n\t\tif (!keyUserChangeContent) {\n\t\t\tthis.addKeyUserChanges({\n\t\t\t\tselectorControl: layout,\n\t\t\t\tchangeSpecificData: {\n\t\t\t\t\tchangeType: CHANGE_TYPES.NEWS_FEED_URL,\n\t\t\t\t\tcontent: {\n\t\t\t\t\t\toldNewsFeedUrl: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\toldShowCustomNewsFeed: Boolean(this._getPanel().getProperty(\"showCustom\")),\n\t\t\t\t\t\toldCustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\tnewsFeedURL: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\tshowCustomNewsFeed: this.customNewsVisibility,\n\t\t\t\t\t\tcustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\tcustomNewsFeedFileName: String(this._getPanel().getProperty(\"customFileName\"))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._eventBus.publish(\"KeyUserChanges\", \"addNewsPagesChanges\", { changes: this.getKeyUserChanges() });\n\t\t} else if (keyUserChangeContent.showCustomNewsFeed !== this.customNewsVisibility) {\n\t\t\tkeyUserChangeContent.showCustomNewsFeed = this.customNewsVisibility;\n\t\t}\n\t\tthis.removeUrlMesageStrip();\n\t\tthis._eventBus.publish(\"KeyUserChanges\", \"disabledSaveBtn\", { disable: false, date: new Date() });\n\t}\n\n\t/**\n\t * Add CheckBox for Custom News Feed.\n\t *\n\t * @private\n\t */\n\tprivate addCustomNewsFeedCheckBox(wrapperVBox: VBox): void {\n\t\tconst customNewsFeedCheckBoxId = `${this.getId()}-customNewsFeedCheckBox`;\n\t\tif (!this.controlMap.get(customNewsFeedCheckBoxId)) {\n\t\t\tconst customNewsFeedCheckBox = new CheckBox(`${this.getId()}-customNewsFeedCheckBox`, {\n\t\t\t\ttext: this._i18nBundle.getText(\"selectCustomNewsFeed\"),\n\t\t\t\tselected: Boolean(this._getPanel().getProperty(\"showCustom\")),\n\t\t\t\tselect: this.handleSelectCustomNewsFeed.bind(this)\n\t\t\t}).addStyleClass(\"sapUiTinyMargin\");\n\t\t\tthis.controlMap.set(customNewsFeedCheckBoxId, customNewsFeedCheckBox);\n\t\t} else if (!this.getCurrentKeyUserChange()) {\n\t\t\t(this.controlMap.get(`${this.getId()}-customNewsFeedCheckBox`) as CheckBox).setSelected(\n\t\t\t\tBoolean(this._getPanel().getProperty(\"showCustom\"))\n\t\t\t);\n\t\t}\n\t\twrapperVBox.addItem(this.controlMap.get(customNewsFeedCheckBoxId) as CheckBox);\n\t}\n\n\tprivate onNewsUrlChange(oEvent: InputBase$ChangeEvent): void {\n\t\tconst newsPanel = this._getPanel() as NewsPanel;\n\t\tconst newsPageContainer = newsPanel.getParent() as NewsAndPagesContainer;\n\t\tconst layout = newsPageContainer.getParent() as BaseLayout;\n\t\tlet newsUrl = oEvent.getParameter(\"value\");\n\t\tconst keyUserContent = this.getCurrentKeyUserChange();\n\t\tconst validUrl = this.getValidURL(String(newsUrl));\n\t\tif (!validUrl) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tnewsUrl = validUrl;\n\t\t}\n\t\tif (!keyUserContent) {\n\t\t\tthis.addKeyUserChanges({\n\t\t\t\tselectorControl: layout,\n\t\t\t\tchangeSpecificData: {\n\t\t\t\t\tchangeType: CHANGE_TYPES.NEWS_FEED_URL,\n\t\t\t\t\tcontent: {\n\t\t\t\t\t\toldNewsFeedUrl: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\toldShowCustomNewsFeed: Boolean(this._getPanel().getProperty(\"showCustom\")),\n\t\t\t\t\t\toldCustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\tnewsFeedURL: newsUrl,\n\t\t\t\t\t\tshowCustomNewsFeed: false,\n\t\t\t\t\t\tcustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\tcustomNewsFeedFileName: String(this._getPanel().getProperty(\"customFileName\"))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._eventBus.publish(\"KeyUserChanges\", \"addNewsPagesChanges\", { changes: this.getKeyUserChanges() });\n\t\t} else if (keyUserContent.newsFeedURL !== newsUrl) {\n\t\t\tkeyUserContent.newsFeedURL = newsUrl;\n\t\t\tkeyUserContent.showCustomNewsFeed = false;\n\t\t}\n\t}\n\n\tprivate showMessageStrip(bShow: boolean, type: MessageType, textKey: string): void {\n\t\tthis.getMessageStrip().setType(type);\n\t\tthis.getMessageStrip().setVisible(bShow);\n\t\tthis.getMessageStrip().setText(String(this._i18nBundle.getText(textKey)));\n\t\tif (type === MessageType.Error) {\n\t\t\tthis._eventBus.publish(\"KeyUserChanges\", \"disabledSaveBtn\", { disable: bShow, date: new Date() });\n\t\t}\n\t}\n\n\tprivate getValidURL(urlString: string): string {\n\t\ttry {\n\t\t\tconst url = new URL(urlString);\n\t\t\treturn url.href;\n\t\t} catch {\n\t\t\treturn \"\";\n\t\t}\n\t}\n\n\tpublic removeUrlMesageStrip() {\n\t\tthis._eventBus.publish(\"KeyUserChanges\", \"disabledSaveBtn\", { disable: false, date: new Date() });\n\t\tthis.getMessageStrip().setVisible(false);\n\t\tconst newsUrlInput = this.controlMap.get(`${this.getId()}-newsFeedURLInput`) as Input;\n\t\tif (!this.getValidURL(newsUrlInput.getValue())) {\n\t\t\tnewsUrlInput.setValue(\"\");\n\t\t}\n\t}\n\n\tprivate onUrlLiveChange(oEvent: Input$LiveChangeEvent) {\n\t\tconst sNewValue = oEvent.getParameter(\"value\") || \"\";\n\t\tthis.showMessageStrip(!this.getValidURL(sNewValue), MessageType.Error, \"invalidNewsUrl\");\n\t}\n\n\tprivate getMessageStrip(): MessageStrip {\n\t\tconst messageStripId = `${this.getId()}-messageStrip`;\n\t\treturn this.controlMap.get(messageStripId) as MessageStrip;\n\t}\n\n\t/**\n\t * Add SimpleForm for News URL.\n\t *\n\t * @private\n\t */\n\tprivate addNewsURLSimpleForm(wrapperVBox: VBox): void {\n\t\tconst newsFeedURLSimpleFormId = `${this.getId()}-newsFeedURLSimpleForm`;\n\t\tif (!this.controlMap.get(newsFeedURLSimpleFormId)) {\n\t\t\tconst newsFeedURLSimpleForm = new SimpleForm(`${this.getId()}-newsFeedURLSimpleForm`, {\n\t\t\t\tcontent: [\n\t\t\t\t\tnew Label(`${this.getId()}-newsFeedURLLabel`, {\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"editNewsURL\")\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t}).addStyleClass(\"sapContrastPlus\");\n\t\t\tconst newsFeedURLInputId = `${this.getId()}-newsFeedURLInput`;\n\t\t\tconst newsFeedURLInput = new Input(newsFeedURLInputId, {\n\t\t\t\tvalue: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\ttype: Library.InputType.Url,\n\t\t\t\tchange: this.onNewsUrlChange.bind(this),\n\t\t\t\tliveChange: this.onUrlLiveChange.bind(this),\n\t\t\t\tenabled: !this._getPanel().getProperty(\"showCustom\")\n\t\t\t});\n\t\t\tthis.controlMap.set(newsFeedURLInputId, newsFeedURLInput);\n\t\t\tnewsFeedURLSimpleForm.addContent(newsFeedURLInput);\n\t\t\tthis.controlMap.set(newsFeedURLSimpleFormId, newsFeedURLSimpleForm);\n\t\t} else if (this.getCurrentKeyUserChange()) {\n\t\t\t(this.controlMap.get(`${this.getId()}-newsFeedURLInput`) as Input).setValue(String(this._getPanel().getProperty(\"url\")));\n\t\t}\n\t\twrapperVBox.addItem(this.controlMap.get(newsFeedURLSimpleFormId) as SimpleForm);\n\t}\n\n\tprivate handleFileChange(oEvent: FileUploader$ChangeEvent): void {\n\t\tconst fileUploader = oEvent.getSource();\n\t\tthis.getMessageStrip().setVisible(false);\n\t\tthis._eventBus.publish(\"KeyUserChanges\", \"disabledSaveBtn\", { disable: false, date: new Date() });\n\t\tthis.setNewsFeedEnabled(fileUploader.getValue() !== \"\");\n\t}\n\n\tprivate setNewsFeedEnabled(bEnabled: boolean): void {\n\t\tconst newsFeedUploadBtn = this.getNewsFeedUploadBtn();\n\t\tif (newsFeedUploadBtn) {\n\t\t\tnewsFeedUploadBtn.setEnabled(bEnabled);\n\t\t}\n\t}\n\n\tprivate getNewsFeedUploadBtn(): Button {\n\t\tconst customNewsUploadFileUploaderButtonId = `${this.getId()}-customNewsUploadFileUploaderButton`;\n\t\treturn this.controlMap.get(customNewsUploadFileUploaderButtonId) as Button;\n\t}\n\n\tprivate handleFileUploadError(oEvent: FileUploader$FileSizeExceedEvent): void {\n\t\tconst fileUploader = oEvent.getSource();\n\t\tconst iMaxFileSize = fileUploader.getMaximumFileSize();\n\t\tthis.setNewsFeedEnabled(false);\n\t\tMessageBox.error(String(this._i18nBundle.getText(\"newsFeedMaxFileSizeError\", [iMaxFileSize])));\n\t}\n\n\thandleFileDialogClose(event: Event): void {\n\t\tconst fileUploader = event.getSource<FileUploader>();\n\t\tlet fileName = fileUploader.getValue();\n\t\t// if file selection dialog is closed and no file is selected, set value as last uploaded file\n\n\t\tif (fileName === \"\") {\n\t\t\tfileName = this.getCurrentKeyUserChange()?.customNewsFeedFileName || String(this._getPanel().getProperty(\"customFileName\"));\n\t\t\tthis.setNewsFeedEnabled(false);\n\t\t}\n\t\tfileUploader.setValue(fileName);\n\t}\n\n\tprivate async handleNewsFeedFileUpload(): Promise<void> {\n\t\tlet errorMsg = this._i18nBundle.getText(\"newsFeedFileUploadError\");\n\t\ttry {\n\t\t\tconst response = await Promise.all([this.getUploadedFile(), Container.getServiceAsync<UserInfo>(\"UserInfo\")]);\n\t\t\tconst fileData = response[0];\n\t\t\tconst userInfo = response[1];\n\t\t\tconst userId = userInfo && userInfo.getId();\n\t\t\tconst payload: UploadedFilePayload = { changeId: userId + \"_\" + Date.now().toString(), attachment: fileData.content };\n\n\t\t\t//pass documentType if file is in csv format\n\t\t\t//if documentType is not passed by default document type is considered as excel.\n\t\t\tif (fileData.type) {\n\t\t\t\tpayload.documentType = fileData.type;\n\t\t\t}\n\t\t\tconst oResponse = await HttpHelper.Post(Constants.NEWS_FEED_POST_API, payload);\n\t\t\tconst keyUserChangeContent = this.getCurrentKeyUserChange();\n\t\t\tconst newsPanel = this._getPanel() as NewsPanel;\n\t\t\tconst newsPageContainer = newsPanel.getParent() as NewsAndPagesContainer;\n\t\t\tconst layout = newsPageContainer.getParent() as BaseLayout;\n\t\t\tif (oResponse && (oResponse as { error: { message: string } }).error) {\n\t\t\t\tthis.getFileUploader().setValue(\"\");\n\t\t\t\tif (keyUserChangeContent) {\n\t\t\t\t\tkeyUserChangeContent.customNewsFeedFileName = \"\";\n\t\t\t\t} else {\n\t\t\t\t\tthis.addKeyUserChanges({\n\t\t\t\t\t\tselectorControl: layout,\n\t\t\t\t\t\tchangeSpecificData: {\n\t\t\t\t\t\t\tchangeType: CHANGE_TYPES.NEWS_FEED_URL,\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\toldNewsFeedUrl: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\t\t\toldShowCustomNewsFeed: Boolean(this._getPanel().getProperty(\"showCustom\")),\n\t\t\t\t\t\t\t\toldCustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\t\t\tnewsFeedURL: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\t\t\tshowCustomNewsFeed: true,\n\t\t\t\t\t\t\t\tcustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\t\t\tcustomNewsFeedFileName: String(this._getPanel().getProperty(\"customFileName\"))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\terrorMsg = (oResponse as { error: { message: string } }).error.message.includes(\"NODATA\")\n\t\t\t\t\t? this._i18nBundle.getText(\"newsFeedEmptyFileError\")\n\t\t\t\t\t: errorMsg;\n\t\t\t\tthrow new Error(errorMsg);\n\t\t\t}\n\t\t\tconst customKey = (oResponse as { changeId: string }).changeId;\n\t\t\tif (keyUserChangeContent) {\n\t\t\t\tkeyUserChangeContent.customNewsFeedKey = customKey;\n\t\t\t\tkeyUserChangeContent.customNewsFeedFileName = this.getFileUploader().getValue();\n\t\t\t} else {\n\t\t\t\tthis.addKeyUserChanges({\n\t\t\t\t\tselectorControl: layout,\n\t\t\t\t\tchangeSpecificData: {\n\t\t\t\t\t\tchangeType: CHANGE_TYPES.NEWS_FEED_URL,\n\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\toldNewsFeedUrl: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\t\toldShowCustomNewsFeed: Boolean(this._getPanel().getProperty(\"showCustom\")),\n\t\t\t\t\t\t\toldCustomNewsFeedKey: String(this._getPanel().getProperty(\"customFeedKey\")),\n\t\t\t\t\t\t\tnewsFeedURL: String(this._getPanel().getProperty(\"url\")),\n\t\t\t\t\t\t\tshowCustomNewsFeed: true,\n\t\t\t\t\t\t\tcustomNewsFeedKey: customKey,\n\t\t\t\t\t\t\tcustomNewsFeedFileName: this.getFileUploader().getValue()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._eventBus.publish(\"KeyUserChanges\", \"addNewsPagesChanges\", { changes: this.getKeyUserChanges() });\n\t\t\t}\n\t\t\tMessageToast.show(String(this._i18nBundle.getText(\"customNewsFeedUploaded\")));\n\t\t\tthis.setNewsFeedEnabled(false);\n\t\t} catch (oErr) {\n\t\t\tMessageBox.error((oErr as { message: string }).message);\n\t\t\tthis.setNewsFeedEnabled(false);\n\t\t}\n\t}\n\n\tprivate getUploadedFile(): Promise<FileMetaData> {\n\t\treturn new Promise<FileMetaData>((resolve, reject) => {\n\t\t\tconst fileUploader = this.getFileUploader();\n\t\t\tlet errorMsg = this._i18nBundle.getText(\"newsFeedFileUploadError\");\n\t\t\tif (fileUploader && !fileUploader.getValue()) {\n\t\t\t\terrorMsg = this._i18nBundle.getText(\"noNewsFileError\");\n\t\t\t\treject(new Error(errorMsg));\n\t\t\t}\n\n\t\t\tconst file = fileUploader.oFileUpload.files[0];\n\t\t\tconst reader = new FileReader();\n\n\t\t\treader.onload = function () {\n\t\t\t\ttry {\n\t\t\t\t\tconst fileContent = reader.result as string;\n\t\t\t\t\tlet base64String;\n\t\t\t\t\tconst fileData: FileMetaData = { type: \"\", content: \"\" };\n\t\t\t\t\tif (file.type === \"text/csv\") {\n\t\t\t\t\t\tbase64String = window.btoa(\n\t\t\t\t\t\t\tencodeURIComponent(String(fileContent)).replace(/%([0-9A-F]{2})/g, function (match, p1: string) {\n\t\t\t\t\t\t\t\treturn String.fromCharCode(parseInt(p1, 16));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t\tfileData.type = \"CSV\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbase64String = fileContent.replace(\"data:\", \"\").replace(/^.+,/, \"\");\n\t\t\t\t\t}\n\t\t\t\t\tfileData.content = base64String;\n\t\t\t\t\tresolve(fileData);\n\t\t\t\t} catch {\n\t\t\t\t\treject(new Error(errorMsg));\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (file.type === \"text/csv\") {\n\t\t\t\treader.readAsText(file);\n\t\t\t} else {\n\t\t\t\treader.readAsDataURL(file);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate getFileUploader(): FileUploader {\n\t\tconst customNewsUploadFileUploader = `${this.getId()}-customNewsUploadFileUploader`;\n\t\treturn this.controlMap.get(customNewsUploadFileUploader) as FileUploader;\n\t}\n\n\t/**\n\t * Add SimpleForm for Custom News Upload Form.\n\t *\n\t * @private\n\t */\n\tprivate addCustomNewsUploadSimpleForm(wrapperVBox: VBox): void {\n\t\tconst customNewsUploadSimpleFormId = `${this.getId()}-customNewsUploadSimpleForm`;\n\t\tif (!this.controlMap.get(customNewsUploadSimpleFormId)) {\n\t\t\tconst customNewsUploadSimpleForm = new SimpleForm(`${this.getId()}-customNewsUploadSimpleForm`, {\n\t\t\t\tcontent: [\n\t\t\t\t\tnew Label(`${this.getId()}-customNewsUploadLabel`, {\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"customNewsFeed\")\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t}).addStyleClass(\"sapContrastPlus\");\n\t\t\tconst customNewsUploadVBox = new VBox(`${this.getId()}-customNewsUploadVBox`);\n\t\t\tconst customNewsUploadFileUploader = `${this.getId()}-customNewsUploadFileUploader`;\n\t\t\tconst newsPanel = this._getPanel() as NewsPanel;\n\t\t\tconst customNewsUploadFileUploaderControl = new FileUploader(customNewsUploadFileUploader, {\n\t\t\t\tname: \"newsFeedFileUploader\",\n\t\t\t\ttooltip: this._i18nBundle.getText(\"uploadNewsFeedFile\"),\n\t\t\t\tfileType: newsPanel?.getProperty(\"supportedFileFormats\") as FileFormat[],\n\t\t\t\twidth: \"100%\",\n\t\t\t\tchange: this.handleFileChange.bind(this),\n\t\t\t\tmaximumFileSize: 25,\n\t\t\t\tfileSizeExceed: this.handleFileUploadError.bind(this),\n\t\t\t\tsameFilenameAllowed: true,\n\t\t\t\tafterDialogClose: this.handleFileDialogClose.bind(this),\n\t\t\t\tvalue: String(this._getPanel().getProperty(\"customFileName\")),\n\t\t\t\tenabled: this._getPanel().getProperty(\"showCustom\") as boolean\n\t\t\t});\n\t\t\tthis.controlMap.set(customNewsUploadFileUploader, customNewsUploadFileUploaderControl);\n\t\t\tconst customNewsUploadFileUploaderButtonId = `${this.getId()}-customNewsUploadFileUploaderButton`;\n\t\t\tconst customNewsUploadFileUploaderButton = new Button(customNewsUploadFileUploaderButtonId, {\n\t\t\t\ttext: this._i18nBundle.getText(\"uploadNewsFeedBtn\"),\n\t\t\t\tpress: this.handleNewsFeedFileUpload.bind(this),\n\t\t\t\ttype: \"Emphasized\",\n\t\t\t\tenabled: false\n\t\t\t});\n\t\t\tthis.controlMap.set(customNewsUploadFileUploaderButtonId, customNewsUploadFileUploaderButton);\n\t\t\tcustomNewsUploadVBox.addItem(customNewsUploadFileUploaderControl);\n\t\t\tcustomNewsUploadVBox.addItem(customNewsUploadFileUploaderButton);\n\t\t\tcustomNewsUploadSimpleForm.addContent(customNewsUploadVBox);\n\t\t\tthis.controlMap.set(customNewsUploadSimpleFormId, customNewsUploadSimpleForm);\n\t\t}\n\t\twrapperVBox.addItem(this.controlMap.get(customNewsUploadSimpleFormId) as SimpleForm);\n\t}\n\n\t/**\n\t * Load settings for the panel.\n\t *\n\t * @private\n\t */\n\tprivate loadSettings(): void {\n\t\tconst wrapperVBoxId = `${this.getId()}-wrapperVBox`;\n\t\tconst wrapperVBox = this.controlMap.get(wrapperVBoxId) as VBox;\n\t\twrapperVBox.removeAllItems();\n\t\tthis.addMessageStrip(wrapperVBox);\n\t\tthis.addCustomNewsFeedCheckBox(wrapperVBox);\n\t\tthis.addNewsURLSimpleForm(wrapperVBox);\n\t\tthis.addCustomNewsUploadSimpleForm(wrapperVBox);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}